<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"
    />
    <title>Dashboard Eletrize</title>
    <style>
      /* Raleway Font - embutido */
      @font-face {
        font-family: "Raleway";
        font-style: normal;
        font-weight: 300;
        font-display: swap;
        src: url("fonts/raleway/Raleway-latin-300.woff2") format("woff2");
      }

      @font-face {
        font-family: "Raleway";
        font-style: normal;
        font-weight: 500;
        font-display: swap;
        src: url("fonts/raleway/Raleway-latin-500.woff2") format("woff2");
      }

      @font-face {
        font-family: "Raleway";
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: url("fonts/raleway/Raleway-latin-700.woff2") format("woff2");
      }
    </style>
    <link rel="preload" href="styles.css?v=1.0.4" as="style" />
    <link rel="stylesheet" href="styles.css?v=1.0.4" />
    <script src="translations.js?v=1.0.1"></script>
    <script src="i18n.js?v=3.0.1"></script>
    <link rel="icon" href="images/pwa/app-icon-192.png" type="image/png" />
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#1C1C1C" />
    <link rel="apple-touch-icon" href="images/pwa/app-icon-192.png" />

    <script>
      (function () {
        // (removido)

        /*
          const target = event.target || {};
          const origin =
            (typeof target.src === "string" && target.src) ||
            (typeof event.filename === "string" && event.filename) ||
            "";

          if (!origin || !origin.includes(CLOUDFLARE_BEACON_HOST)) {
            return;
          }

          if (typeof event.preventDefault === "function") {
            event.preventDefault();
          }
          if (typeof event.stopImmediatePropagation === "function") {
            event.stopImmediatePropagation();
          }

          if (!window.__cfBeaconWarningShown) {
            window.__cfBeaconWarningShown = true;
            console.info(
              "Script externo n√£o p√¥de ser carregado (offline ou bloqueado)."
            );
          }
        */

        function removeScenesPreload() {
          document
            .querySelectorAll('link[rel="preload"][href*="scenes.js"]')
            .forEach((link) => link.remove());
        }

        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", removeScenesPreload);
        } else {
          removeScenesPreload();
        }
      })();
    </script>

    <style>
      /* Bot√£o invis√≠vel no card para capturar clique na Home */

      .room-card-link {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        z-index: 10;
        background: transparent;
        border: none;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <!-- Tela de Loading Global -->
    <div id="global-loader" class="global-loader">
      <div class="loader-content">
        <div class="loader-logo">
          <picture class="loader-logo__picture">
            <source
              srcset="images/pwa/app-icon-420.webp"
              type="image/webp"
            />
            <img
              src="images/pwa/app-icon-512-transparent.png"
              alt="Dashboard Eletrize"
              width="240"
              height="240"
              loading="eager"
              decoding="sync"
            />
          </picture>
        </div>
        <div class="loader-spinner"></div>
        <div class="loader-text">Carregando estados dos dispositivos...</div>
        <div class="loader-progress">
          <div class="progress-bar">
            <div id="progress-fill" class="progress-fill"></div>
          </div>
          <div id="progress-text" class="progress-text">0%</div>
        </div>
      </div>
    </div>

    <!-- SPA root -->
    <div id="spa-root"></div>

    <!-- Confirmation Popup -->
    <div class="popup-overlay" id="confirmation-popup">
      <div class="popup-dialog">
        <p class="popup-message" id="popup-message"></p>

        <div class="popup-buttons">
          <button class="popup-btn cancel" id="popup-cancel" data-i18n="menu.cancel">Cancelar</button>

          <button class="popup-btn confirm" id="popup-confirm" data-i18n="menu.confirm">
            Confirmar
          </button>
        </div>
      </div>
    </div>

    <!-- App Info Popup -->

    <div class="app-info-overlay" id="app-info-overlay" aria-hidden="true">
      <div
        class="app-info-dialog"
        role="dialog"
        aria-label="Menu r√°pido"
        aria-modal="true"
      >
        <div class="app-info-body">
          <img
            class="app-info-logo"
            src="images/icons/eletrize.svg"
            alt="Eletrize Automa√ß√£o"
          />

          <div class="app-info-options">
            <button
              id="app-fullscreen-toggle"
              type="button"
              class="app-info-option"
              aria-label="Tela cheia"
              data-i18n-aria="menu.fullscreen"
            >
              <img
                src="images/icons/Fullscreen.svg"
                alt=""
                class="app-info-option__icon"
                aria-hidden="true"
              />
            </button>

            <button
              id="app-cache-clear"
              type="button"
              class="app-info-option"
              aria-label="Limpar cache"
              data-i18n-aria="menu.clearCache"
            >
              <img
                src="images/icons/icon-limpar.svg"
                alt=""
                class="app-info-option__icon"
                aria-hidden="true"
              />
            </button>

            <a
              id="app-instagram-link"
              class="app-info-option"
              href="https://www.instagram.com/eletrizeautomacao?utm_source=ig_web_button_share_sheet&amp;igsh=ZDNlZDc0MzIxNw=="
              target="_blank"
              rel="noopener noreferrer"
              aria-label="Instagram Eletrize"
            >
              <img
                src="images/icons/Instagram.svg"
                alt=""
                class="app-info-option__icon"
                aria-hidden="true"
              />
            </a>

            <a
              id="app-support-link"
              class="app-info-option"
              href="http://api.whatsapp.com/send?1=pt_BR&amp;phone=5516997152993"
              target="_blank"
              rel="noopener noreferrer"
              aria-label="Contato via WhatsApp"
            >
              <img
                src="images/icons/whatsapp.svg"
                alt=""
                class="app-info-option__icon"
                aria-hidden="true"
              />
            </a>
          </div>

          <!-- Seletor de Idioma -->
          <div class="app-info-language">
            <span class="app-info-language__label" data-i18n="menu.language">Idioma</span>
            <div class="app-info-language__options" id="language-selector">
              <button type="button" class="app-info-language__btn" data-locale="pt" aria-label="Portugu√™s">
                <img class="app-info-language__flag-icon" src="images/icons/icon-br-v2.svg" alt="Portugu√™s" loading="lazy" decoding="async">
                <span class="app-info-language__name">PT</span>
              </button>
              <button type="button" class="app-info-language__btn" data-locale="en" aria-label="English">
                <img class="app-info-language__flag-icon" src="images/icons/icon-en-v2.svg" alt="English" loading="lazy" decoding="async">
                <span class="app-info-language__name">EN</span>
              </button>
              <button type="button" class="app-info-language__btn" data-locale="zh" aria-label="‰∏≠Êñá">
                <img class="app-info-language__flag-icon" src="images/icons/icon-cn-v2.svg" alt="‰∏≠Êñá" loading="lazy" decoding="async">
                <span class="app-info-language__name">‰∏≠Êñá</span>
              </button>
            </div>
          </div>

          <span class="app-info-version" id="app-info-version"></span>
        </div>
      </div>
    </div>

    <!-- Navbar fixa SPA -->

    <nav class="navbar" id="spa-navbar">
      <!-- Indicador: corpo (::before) + bolinha (span) -->
      <span class="navbar-indicator-circle"></span>
      
      <div class="nav-item" data-page="home" aria-label="P√°gina inicial">
        <div class="nav-icon-wrapper" aria-hidden="true">
          <svg
            class="nav-icon"
            viewBox="0 0 30 30"
            xmlns="http://www.w3.org/2000/svg"
            focusable="false"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M12.9168 2.42824C14.164 1.85725 15.5992 1.85725 16.8463 2.42824C21.2923 4.46376 24.6047 7.37565 26.1997 8.9464C27.0597 9.79332 27.5193 10.9227 27.5837 12.0875C27.6632 13.5229 27.7632 15.8504 27.7632 18.476C27.7632 20.3288 27.7134 22.0328 27.6562 23.3792C27.5646 25.5368 25.8416 27.2294 23.6901 27.3032C21.6993 27.3715 18.7399 27.44 14.8816 27.44C11.0232 27.44 8.06385 27.3715 6.07305 27.3032C3.92156 27.2294 2.19859 25.5368 2.10696 23.3792C2.04979 22.0328 2 20.3288 2 18.476C2 15.8504 2.09998 13.5229 2.17942 12.0875C2.24389 10.9227 2.70343 9.79332 3.56349 8.9464C5.15852 7.37565 8.47085 4.46376 12.9168 2.42824ZM10.3015 21.4286C9.66906 21.4286 9.15643 21.9412 9.15643 22.5736C9.15643 23.206 9.66906 23.7187 10.3015 23.7187H19.4617C20.0941 23.7187 20.6067 23.206 20.6067 22.5736C20.6067 21.9412 20.0941 21.4286 19.4617 21.4286H10.3015Z"
              fill="currentColor"
            />
          </svg>
        </div>
      </div>

      <div class="nav-item" data-page="scenes" aria-label="Cen√°rios">
        <div class="nav-icon-wrapper" aria-hidden="true">
          <svg
            class="nav-icon"
            viewBox="0 0 30 30"
            xmlns="http://www.w3.org/2000/svg"
            focusable="false"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M18.0088 11.5108L25.0206 9.63204C25.5238 9.49719 25.8225 8.97989 25.6876 8.47663L24.7825 5.09836C24.3779 3.58857 22.8261 2.69259 21.3163 3.09714L19.6496 3.5437L18.0088 11.5108ZM17.101 4.2266L11.8356 5.63743L10.1949 13.6046L15.4602 12.1937L17.101 4.2266ZM4.09836 7.71064L9.28704 6.32033L7.64624 14.2875L7.55849 14.311H25.8208C26.4721 14.311 27 14.8389 27 15.4902V24.934C27 26.6274 25.6274 28 23.934 28H6.00963C4.31632 28 2.94362 26.6274 2.94362 24.934V15.4902C2.94362 15.2521 3.01421 15.0304 3.13561 14.845C3.07656 14.759 3.03088 14.6616 3.00234 14.5551L2.09714 11.1769C1.69259 9.66707 2.58857 8.11518 4.09836 7.71064ZM5.30209 16.6694V24.934C5.30209 25.3247 5.61888 25.6415 6.00963 25.6415H23.934C24.3247 25.6415 24.6415 25.3247 24.6415 24.934V16.6694H5.30209ZM9.17304 20.8158C8.39152 20.8158 7.75796 21.4493 7.75796 22.2308C7.75796 23.0123 8.39152 23.6459 9.17304 23.6459H11.5867C12.3682 23.6459 13.0017 23.0123 13.0017 22.2308C13.0017 21.4493 12.3682 20.8158 11.5867 20.8158H9.17304Z"
              fill="currentColor"
            />
          </svg>
        </div>
      </div>
    </nav>
    <script>
      (function () {
        var originalConsole = window.__DASHBOARD_ORIGINAL_CONSOLE__ || {
          log: console.log ? console.log.bind(console) : function () {},
          info: console.info ? console.info.bind(console) : function () {},
          debug: console.debug ? console.debug.bind(console) : function () {},
        };

        function parseDebugFromQuery() {
          try {
            var params = new URLSearchParams(window.location.search);
            return params.get("debug") === "1";
          } catch (error) {
            return false;
          }
        }

        function readDebugFromStorage() {
          try {
            return window.localStorage.getItem("dashboard_debug") === "1";
          } catch (error) {
            return false;
          }
        }

        function setConsoleState(enabled) {
          if (enabled) {
            if (!window.__DASHBOARD_ORIGINAL_CONSOLE__) {
              window.__DASHBOARD_ORIGINAL_CONSOLE__ = originalConsole;
            }

            Object.keys(originalConsole).forEach(function (method) {
              if (originalConsole[method]) {
                console[method] = originalConsole[method];
              }
            });
            return;
          }

          var noop = function () {};
          ["log", "info", "debug"].forEach(function (method) {
            if (typeof console[method] === "function") {
              console[method] = noop;
            }
          });
        }

        window.setDashboardDebug = function (enabled, persist) {
          if (persist) {
            try {
              window.localStorage.setItem(
                "dashboard_debug",
                enabled ? "1" : "0"
              );
            } catch (error) {}
          }

          window.__DASHBOARD_DEBUG__ = Boolean(enabled);
          setConsoleState(window.__DASHBOARD_DEBUG__);
        };

        window.__DASHBOARD_DEBUG__ =
          parseDebugFromQuery() || readDebugFromStorage();

        setConsoleState(window.__DASHBOARD_DEBUG__);
      })();
    </script>
    <!-- Configura√ß√£o do cliente - CARREGA PRIMEIRO -->
    <script src="config.js?v=1.0.0"></script>
    
    <!-- Aplicar tema do config.js -->
    <script>
      (function applyTheme() {
        if (typeof CLIENT_CONFIG === 'undefined' || !CLIENT_CONFIG.theme) return;
        
        const theme = CLIENT_CONFIG.theme;
        const root = document.documentElement;
        
        // Aplica as cores como vari√°veis CSS
        root.style.setProperty('--theme-background', theme.background || '#E3E3E3');
        root.style.setProperty('--theme-navbar', theme.navbar || '#008739');
        root.style.setProperty('--theme-navbar-dark', theme.navbarDark || '#006629');
        root.style.setProperty('--theme-navbar-border', theme.navbarBorder || theme.navbarDark || '#006629');
        root.style.setProperty('--theme-navbar-indicator', theme.navbarIndicator || '#006629');
        root.style.setProperty('--theme-navbar-indicator-circle', theme.navbarIndicatorCircle || '#F59C00');
        root.style.setProperty('--theme-icon-active', theme.iconActive || '#F59C00');
        root.style.setProperty('--theme-icon-inactive', theme.iconInactive || '#004d1a');
        root.style.setProperty('--theme-icon-active-circle', theme.iconActiveCircle || theme.navbarDark || '#006629');
        root.style.setProperty('--theme-text-primary', theme.textPrimary || '#333333');
        root.style.setProperty('--theme-text-secondary', theme.textSecondary || '#666666');
        root.style.setProperty('--theme-card-background', theme.cardBackground || '#FFFFFF');
        root.style.setProperty('--theme-border', theme.border || '#CCCCCC');
        root.style.setProperty('--theme-header-line', theme.headerLine || '#FFFFFF');
        
        // Aplica imediatamente o fundo verde escuro
        document.body.style.backgroundColor = theme.navbarDark || '#006629';
      })();
    </script>
    
    <script src="script.js?v=1.0.4" defer></script>
    <script>
      // PWA: registra service worker (desativado em localhost para evitar cache no desenvolvimento)

      if ("serviceWorker" in navigator) {
        const isLocalhost = ["localhost", "127.0.0.1", "::1"].includes(
          location.hostname
        );

        if (isLocalhost) {
          // Em ambiente de desenvolvimento, garantir remo√ß√£o do SW e dos caches

          navigator.serviceWorker
            .getRegistrations?.()
            .then((regs) => regs.forEach((r) => r.unregister()))
            .catch(() => {});

          if (window.caches?.keys) {
            caches
              .keys()
              .then((keys) => Promise.all(keys.map((k) => caches.delete(k))))
              .catch(() => {});
          }
        } else {
          window.addEventListener("load", function () {
            navigator.serviceWorker
              .register("service-worker.js")
              .catch(() => {});
          });
        }
      }

      // --- Helper para tradu√ß√£o de nomes de ambiente ---
      function getTranslatedEnvName(envKey, fallback) {
        const rawName = (typeof CLIENT_CONFIG !== 'undefined' && CLIENT_CONFIG.environments?.[envKey]?.name) || fallback || envKey;
        return typeof translateText === 'function' ? translateText(rawName) : rawName;
      }

      // --- SPA Core ---

      const spaRoot = document.getElementById("spa-root");
      const pageCache = new Map();
      const PAGE_TRANSITION_CLASS = "page-transition-enter";

      function runPageEnterAnimation({ skip = false } = {}) {
        if (skip || typeof document === "undefined") return;
        const activePage = document.querySelector(".page.active");
        if (!activePage) return;
        activePage.classList.remove(PAGE_TRANSITION_CLASS);
        // Force reflow to restart animation when navigating r√°pido
        void activePage.offsetWidth;
        activePage.classList.add(PAGE_TRANSITION_CLASS);
        activePage.addEventListener(
          "animationend",
          () => activePage.classList.remove(PAGE_TRANSITION_CLASS),
          { once: true }
        );
      }

      // Fotos dos cards por rota (reaproveitadas como fundo das p√°ginas internas)
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // GERADO DINAMICAMENTE A PARTIR DO config.js
      // 
      // DUAS FORMAS DE USAR:
      // 1. Imagem √∫nica: photoFilename: "Prologo.png" (coloque em images/Images/)
      // 2. Vers√µes otimizadas: photoFilename: "photo-ambiente" (arquivos em images/optimized/)
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      const ROOM_IMAGE_DATA = (() => {
        if (typeof CLIENT_CONFIG === 'undefined' || !CLIENT_CONFIG.environments) {
          return {};
        }
        
        const result = {};
        const RESPONSIVE_WIDTHS = [480, 720, 960, 1440, 1920, 2560];
        
        Object.entries(CLIENT_CONFIG.environments).forEach(([key, env]) => {
          if (!env.hasPhoto || !env.photoFilename) return;
          
          const filename = env.photoFilename;
          const hasExtension = /\.[^.]+$/.test(filename);
          
          if (hasExtension) {
            // MODO 1: Imagem √∫nica (ex: "Prologo.png", "foto.jpg")
            // Usa a imagem diretamente sem vers√µes otimizadas
            const singleImagePath = `images/Images/${filename}`;
            result[key] = {
              mode: 'single',
              base: filename,
              fallback: singleImagePath,
              webpSrcset: singleImagePath,  // Usa a mesma imagem
              defaultWebp: singleImagePath,
              backgroundWebp: singleImagePath,
              singleImage: true
            };
          } else {
            // MODO 2: Vers√µes otimizadas (ex: "photo-ambiente")
            // Procura arquivos como photo-ambiente-480.webp, photo-ambiente-720.webp, etc.
            const sortedWidths = [...RESPONSIVE_WIDTHS].sort((a, b) => a - b);
            const backgroundWidth = sortedWidths[sortedWidths.length - 1];
            const cardWidth = sortedWidths.find(w => w >= 720) || backgroundWidth;
            
            result[key] = {
              mode: 'optimized',
              base: filename,
              fallback: `images/Images/${filename}.jpg`,
              webpSrcset: RESPONSIVE_WIDTHS.map(
                width => `images/optimized/${filename}-${width}.webp ${width}w`
              ).join(", "),
              defaultWebp: `images/optimized/${filename}-${cardWidth}.webp`,
              backgroundWebp: `images/optimized/${filename}-${backgroundWidth}.webp`,
              singleImage: false
            };
          }
        });
        
        return result;
      })();

      // Debug: mostrar mapeamento de imagens carregado
      console.log('üì∑ ROOM_IMAGE_DATA carregado:', ROOM_IMAGE_DATA);

      const CARD_IMAGE_SIZES =
        "(max-width: 600px) 100vw, (max-width: 1200px) 60vw, 720px";

      const WEBP_SUPPORTED = (() => {
        try {
          const canvas = document.createElement("canvas");
          return canvas.toDataURL("image/webp", 0.5).startsWith("data:image/webp");
        } catch (error) {
          return false;
        }
      })();

      function getRoomBackgroundUrl(route) {
        const data = ROOM_IMAGE_DATA[route];
        if (!data) return null;
        // Se √© imagem √∫nica, usa ela diretamente
        if (data.singleImage) return data.fallback;
        // Se s√£o vers√µes otimizadas, escolhe baseado no suporte a webp
        return WEBP_SUPPORTED ? data.backgroundWebp : data.fallback;
      }

      const ROOM_BACKGROUND_CACHE = new Map();
      const ROOM_BACKGROUND_PROMISES = new Map();

      function cacheRoomBackground(route, url, { force = false } = {}) {
        if (!route || !url) return;
        if (!ROOM_BACKGROUND_CACHE.has(route) || force) {
          ROOM_BACKGROUND_CACHE.set(route, url);
        }
      }

      function preloadRoomBackground(route) {
        const data = ROOM_IMAGE_DATA[route];
        if (!data) return Promise.resolve(null);
        const targetUrl = getRoomBackgroundUrl(route);
        if (!targetUrl) return Promise.resolve(null);

        if (ROOM_BACKGROUND_CACHE.get(route) === targetUrl) {
          return Promise.resolve(targetUrl);
        }

        if (ROOM_BACKGROUND_PROMISES.has(route)) {
          return ROOM_BACKGROUND_PROMISES.get(route);
        }

        const promise = new Promise((resolve) => {
          const img = new Image();
          img.decoding = "async";
          img.onload = () => {
            cacheRoomBackground(route, targetUrl, { force: true });
            ROOM_BACKGROUND_PROMISES.delete(route);
            resolve(targetUrl);
          };
          img.onerror = () => {
            ROOM_BACKGROUND_PROMISES.delete(route);
            resolve(targetUrl);
          };
          img.src = targetUrl;
        });

        ROOM_BACKGROUND_PROMISES.set(route, promise);
        return promise;
      }

      function applyBackground(container, route) {
        if (!container) return;

        container.dataset.backgroundRoute = route;

        const cached = ROOM_BACKGROUND_CACHE.get(route);
        if (cached) {
          container.style.backgroundImage = `url('${cached}')`;
          container.classList.remove("bg-loading");
        } else {
          const data = ROOM_IMAGE_DATA[route];
          const fallbackUrl =
            (WEBP_SUPPORTED ? data?.defaultWebp : data?.fallback) ||
            data?.fallback;
          if (fallbackUrl) {
            cacheRoomBackground(route, fallbackUrl);
            container.style.backgroundImage = `url('${fallbackUrl}')`;
          } else {
            container.style.backgroundImage = "";
          }
          container.classList.add("bg-loading");
        }

        preloadRoomBackground(route).then((finalUrl) => {
          if (!finalUrl) {
            container.classList.remove("bg-loading");
            return;
          }
          if (container.dataset.backgroundRoute !== route) {
            return;
          }
          container.style.backgroundImage = `url('${finalUrl}')`;
          container.classList.remove("bg-loading");
        });
      }

      function renderRoomResponsivePhoto(route, alt, options = {}) {
        const data = ROOM_IMAGE_DATA[route];
        if (!data) return "";
        
        const {
          eager = false,
          className = "room-card-photo",
          imageClassName = "",
        } = options;
        const loading = eager ? "eager" : "lazy";
        const decoding = eager ? "sync" : "async";
        const fetchPriority = eager ? 'fetchpriority="high"' : "";
        const imgClassAttribute = imageClassName ? `class="${imageClassName}"` : "";

        // Cache para background
        const preferredCardUrl = data.singleImage ? data.fallback : (WEBP_SUPPORTED ? data.defaultWebp : data.fallback);
        cacheRoomBackground(route, preferredCardUrl);

        // MODO 1: Imagem √∫nica (sem vers√µes otimizadas)
        if (data.singleImage) {
          return `
            <div class="${className}" data-route="${route}">
              <img
                ${imgClassAttribute}
                src="${data.fallback}"
                alt="${alt}"
                loading="${loading}"
                decoding="${decoding}"
                ${fetchPriority}
                style="width:100%;height:100%;object-fit:cover;"
              />
            </div>
          `;
        }

        // MODO 2: Vers√µes otimizadas (com srcset responsivo)
        return `
          <picture class="${className}" data-route="${route}">
            <source
              type="image/webp"
              srcset="${data.webpSrcset}"
              sizes="${CARD_IMAGE_SIZES}"
            />
            <source
              type="image/jpeg"
              srcset="${data.fallback}"
              sizes="${CARD_IMAGE_SIZES}"
            />
            <img
              ${imgClassAttribute}
              src="${data.fallback}"
              alt="${alt}"
              loading="${loading}"
              decoding="${decoding}"
              ${fetchPriority}
              width="720"
              height="540"
            />
          </picture>
        `;
      }

      let scenesScriptPromise = null;
      function ensureScenesScript() {
        if (scenesScriptPromise) return scenesScriptPromise;
        scenesScriptPromise = new Promise((resolve, reject) => {
          const script = document.createElement("script");
          script.src = "scenes.js?v=1.0.4";
          script.async = true;
          script.onload = resolve;
          script.onerror = () =>
            reject(new Error("Falha ao carregar scenes.js"));
          document.head.appendChild(script);
        });
        return scenesScriptPromise;
      }

      function invokeSceneToggle(envKey, elementId, targetState) {
        ensureScenesScript()
          .then(() => {
            if (typeof handleSceneToggle === 'function') {
              handleSceneToggle(envKey, elementId, targetState);
            } else if (typeof handleEnvironmentScene === 'function' && targetState !== false) {
              handleEnvironmentScene(envKey, elementId);
            } else {
              console.warn('[scene] Nenhum handler de cena dispon√≠vel', { envKey, targetState });
            }
          })
          .catch((error) => console.error('Erro ao carregar scenes.js', error));
      }

      function syncPresentationToggleFromScenes(envKey) {
        ensureScenesScript()
          .then(() => {
            if (typeof getSceneToggleState !== 'function') return;
            const isOn = getSceneToggleState(envKey);
            updatePresentationCardState(envKey, isOn);
          })
          .catch((error) => console.error('Erro ao sincronizar cen√°rio', error));
      }

      function updatePresentationCardState(envKey, isOn) {
        const cards = document.querySelectorAll(`.scene-toggle-card[data-env="${envKey}"], .scene-toggle-card-slim[data-env="${envKey}"]`);
        if (!cards.length) return;
        cards.forEach((card) => {
          card.dataset.state = isOn ? 'on' : 'off';
          card.classList.toggle('is-on', isOn);
          const startBtn = card.querySelector('.scene-action-btn--start');
          const stopBtn = card.querySelector('.scene-action-btn--stop');
          if (startBtn) {
            startBtn.setAttribute('aria-pressed', isOn ? 'true' : 'false');
            startBtn.classList.toggle('is-active', isOn);
          }
          if (stopBtn) {
            const offActive = !isOn;
            stopBtn.setAttribute('aria-pressed', offActive ? 'true' : 'false');
            stopBtn.classList.toggle('is-active', offActive);
          }
        });
      }

      window.addEventListener('sceneToggleStateChanged', (evt) => {
        if (!evt || !evt.detail) return;
        const { envKey, isOn } = evt.detail;
        updatePresentationCardState(envKey, isOn);
      });

      // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      // Long press (1s) para ligar/desligar todas as luzes do ambiente
      // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      const lightHoldTimers = {};
      const lightHoldTriggered = {};

      function clearLightHold(envKey) {
        if (lightHoldTimers[envKey]) {
          clearTimeout(lightHoldTimers[envKey]);
          delete lightHoldTimers[envKey];
        }
        delete lightHoldTriggered[envKey];
      }

      function handleLightsPressStart(envKey) {
        clearLightHold(envKey);
        lightHoldTimers[envKey] = setTimeout(() => {
          lightHoldTriggered[envKey] = true;
          showLightsMasterPopup(envKey);
        }, 1000);
      }

      function handleLightsPressEnd(envKey) {
        clearLightHold(envKey);
      }

      function handleLightsCardClick(event, envKey, route) {
        if (lightHoldTriggered[envKey]) {
          event.preventDefault();
          clearLightHold(envKey);
          return;
        }
        spaNavigate(`${envKey}-${route}`);
      }

      function getEnvLightIds(envKey) {
        if (typeof getEnvironmentLightIds === 'function') {
          return getEnvironmentLightIds(envKey) || [];
        }
        if (typeof CLIENT_CONFIG !== 'undefined' && CLIENT_CONFIG.environments?.[envKey]?.lights) {
          return CLIENT_CONFIG.environments[envKey].lights.map((l) => l.id).filter(Boolean);
        }
        return [];
      }

      function anyLightOn(envKey) {
        const ids = getEnvLightIds(envKey);
        if (!ids.length || typeof getStoredState !== 'function') return false;
        return ids.some((id) => getStoredState(id) === 'on');
      }

      function showLightsMasterPopup(envKey) {
        const hasOn = anyLightOn(envKey);
        const msg = hasOn
          ? (typeof translateText === 'function' ? translateText('Desligar todas as luzes do ambiente?') : 'Desligar todas as luzes do ambiente?')
          : (typeof translateText === 'function' ? translateText('Ligar todas as luzes do ambiente?') : 'Ligar todas as luzes do ambiente?');

        const command = hasOn ? 'off' : 'on';
        if (typeof showPopup === 'function') {
          showPopup(msg, () => executeLightsMasterCommand(envKey, command));
        }
      }

      function executeLightsMasterCommand(envKey, command) {
        const ids = getEnvLightIds(envKey);
        if (!ids.length || typeof sendHubitatCommand !== 'function') {
          console.warn('[lights-master] Nenhuma luz encontrada ou sendHubitatCommand indispon√≠vel');
          return;
        }
        ids.forEach((id) => {
          sendHubitatCommand(id, command)
            .then(() => {
              if (typeof setStoredState === 'function') {
                setStoredState(id, command);
              }
            })
            .catch((err) => console.error('[lights-master] Falha ao enviar comando', id, err));
        });
        
        // ATUALIZA√á√ÉO INSTANT√ÇNEA: Atualiza √≠cone imediatamente
        if (typeof updateLightFeatureIcons === 'function') {
          updateLightFeatureIcons(true);
          console.log(`‚úÖ [lights-master] √çcones sincronizados imediatamente para ${envKey}`);
        }
        
        if (typeof syncAllVisibleControls === 'function') {
          setTimeout(() => syncAllVisibleControls(true), 200);
        }
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // GERADOR DE BOT√ïES DE FEATURES (l√™ do config.js)
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // Features s√£o gen√©ricas (feature1, feature2, etc.)
      // Cada feature define: label (nome), icon (√≠cone), route (p√°gina de destino)

      const MEDIA_FEATURE_ROUTES = ["tv", "musica", "telao"];

      function getEnvironmentFeatures(envKey) {
        if (typeof CLIENT_CONFIG === 'undefined' || !CLIENT_CONFIG.environments) {
          return null;
        }

        const env = CLIENT_CONFIG.environments[envKey];
        if (!env || !env.features) {
          return null;
        }

        const features = Object.entries(env.features)
          .filter(([, value]) => typeof value === 'object' && value !== null)
          .map(([key, value]) => ({
            key,
            label: value.label || key,
            icon: value.icon || 'icon-small-light-off.svg',
            route: value.route || key,
            action: value.action
          }));

        return features;
      }

      function getMediaCardSettings(envKey) {
        if (typeof CLIENT_CONFIG === 'undefined' || !CLIENT_CONFIG.environments) {
          return {};
        }

        const env = CLIENT_CONFIG.environments[envKey];
        if (!env || !env.media) {
          return {};
        }

        const label = typeof env.media.label === 'string' ? env.media.label : undefined;
        const icon = typeof env.media.icon === 'string' ? env.media.icon : undefined;

        return { label, icon };
      }

      function getConfiguredMediaButtons(envKey) {
        if (typeof CLIENT_CONFIG === 'undefined' || !CLIENT_CONFIG.environments) {
          return [];
        }

        const env = CLIENT_CONFIG.environments[envKey];
        if (!env || !env.media || !env.media.buttons) {
          return [];
        }

        const buttonsSource = Array.isArray(env.media.buttons)
          ? env.media.buttons
          : (typeof env.media.buttons === 'object' && env.media.buttons !== null)
            ? Object.values(env.media.buttons)
            : [];

        return buttonsSource
          .filter((button) => button && typeof button === 'object')
          .map((button, index) => ({
            key: button.key || `media-btn-${envKey}-${index}`,
            label: button.label || `Op√ß√£o ${index + 1}`,
            icon: button.icon || 'icon-midia.svg',
            route: button.route || 'midia'
          }));
      }

      function getMediaFeatures(envKey, cachedFeatures) {
        const configuredButtons = getConfiguredMediaButtons(envKey);
        if (configuredButtons.length) {
          return configuredButtons;
        }

        const source = Array.isArray(cachedFeatures)
          ? cachedFeatures
          : getEnvironmentFeatures(envKey) || [];

        return source.filter((feature) => MEDIA_FEATURE_ROUTES.includes(feature.route));
      }

      function generateFeatureButtons(envKey) {
        const features = getEnvironmentFeatures(envKey);

        if (features === null) {
          return '<!-- config.js n√£o carregado ou ambiente inexistente -->';
        }

        if (!features.length) {
          return '<!-- nenhuma feature habilitada -->';
        }

        // Normalize cen√°rio feature: rename to "Apresenta√ß√£o", set icon, and keep action
        const updatedFeatures = features.map((feature) => {
          if (feature.action === 'executeScene') {
            return {
              ...feature,
              label: 'Apresenta√ß√£o',
              icon: 'icon-apresentacao.svg'
            };
          }
          return feature;
        });

        // Move cen√°rio (Apresenta√ß√£o) to the last position, preserving others order
        const sceneFeatures = updatedFeatures.filter((f) => f.action === 'executeScene');
        const nonSceneFeatures = updatedFeatures.filter((f) => f.action !== 'executeScene');
        const orderedFeatures = nonSceneFeatures.concat(sceneFeatures);

        const hasManualMidiaButton = orderedFeatures.some((feature) => feature.route === 'midia');
        const mediaTargets = getMediaFeatures(envKey, orderedFeatures);
        const mediaCardSettings = getMediaCardSettings(envKey);

        if (mediaTargets.length && !hasManualMidiaButton) {
          const mediaCard = {
            key: `auto-midia-${envKey}`,
            label: mediaCardSettings.label || 'M√≠dia',
            icon: mediaCardSettings.icon || 'icon-midia.svg',
            route: 'midia'
          };
          const insertionIndex = Math.min(1, orderedFeatures.length);
          orderedFeatures.splice(insertionIndex, 0, mediaCard);
        }

        const isFullWidth = orderedFeatures.length === 1;
        // Contar apenas bot√µes que n√£o s√£o apresenta√ß√£o
        const nonSceneCount = orderedFeatures.filter(f => f.action !== 'executeScene').length;
        const hasOddCount = nonSceneCount > 1 && nonSceneCount % 2 !== 0;

        return orderedFeatures.map((feature, index) => {
          const isScene = feature.action === 'executeScene';
          const isLastNonScene = !isScene && hasOddCount && index === orderedFeatures.length - 1;
          const cardClass = (isFullWidth || isLastNonScene) ? 'control-card control-card--full-width' : 'control-card';
          const isLightsFeature = feature.route === 'luzes';
          const lightIds = isLightsFeature ? (getEnvLightIds(envKey) || []) : [];
          
          if (feature.action === 'executeScene') {
             const btnId = `scene-btn-${envKey}`;
             const label = typeof translateText === 'function' ? translateText(feature.label) : feature.label;
             return `
            <div class="scene-toggle-card-slim" id="${btnId}" data-env="${envKey}" data-state="off">
              <div class="scene-toggle-card-slim__content">
                <img class="scene-toggle-card-slim__icon" src="images/icons/${feature.icon}" alt="${label}">
                <span class="scene-toggle-card-slim__label">${label}</span>
              </div>
              <div class="scene-action-buttons scene-action-buttons--compact">
                <button type="button" class="scene-action-btn scene-action-btn--start scene-action-btn--compact" aria-label="${label} - Iniciar" data-env="${envKey}" onclick="invokeSceneToggle('${envKey}', '${btnId}', true)">
                  <img src="images/icons/icon-play.svg" alt="">
                </button>
                <button type="button" class="scene-action-btn scene-action-btn--stop scene-action-btn--compact" aria-label="${label} - Encerrar" data-env="${envKey}" onclick="invokeSceneToggle('${envKey}', '${btnId}', false)">
                  <img src="images/icons/icon-end.svg" alt="">
                </button>
              </div>
            </div>
          `;
          }

          if (feature.route === 'conforto') {
             const optionsId = `conforto-options-${envKey}`;
             const triggerId = `conforto-trigger-${envKey}`;
             const label = typeof translateText === 'function' ? translateText(feature.label) : feature.label;
             return `
            <div class="conforto-container" data-conforto-env="${envKey}">
              <div class="${cardClass} conforto-card" id="${triggerId}" data-conforto-options="${optionsId}" onclick="toggleConfortoOptions('${optionsId}', '${envKey}')">
                <div class="conforto-card-main">
                  <img class="control-icon" src="images/icons/${feature.icon}" alt="${label}">
                  <div class="control-label">${label}</div>
                </div>
              </div>
              <div id="${optionsId}" class="conforto-options" aria-hidden="true">
                <div class="conforto-drawer">
                  <div class="conforto-btn-row">
                    <button type="button" class="conforto-action-btn conforto-action-btn--on" data-conforto-on-btn="${envKey}" onclick="handleConfortoAction('${envKey}', 'on')" aria-label="Ligar conforto" aria-pressed="false">
                      <span class="conforto-action-btn__label">On</span>
                    </button>
                    <button type="button" class="conforto-action-btn conforto-action-btn--off" data-conforto-off-btn="${envKey}" onclick="handleConfortoAction('${envKey}', 'off')" aria-label="Desligar conforto" aria-pressed="false">
                      <span class="conforto-action-btn__label">Off</span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          `;
          }

          const label = typeof translateText === 'function' ? translateText(feature.label) : feature.label;
          const isPresentation = feature.action === 'executeScene';
          const lightEvents = isLightsFeature
            ? `
                onpointerdown="handleLightsPressStart('${envKey}')"
                onpointerup="handleLightsPressEnd('${envKey}')"
                onpointerleave="handleLightsPressEnd('${envKey}')"
                onclick="handleLightsCardClick(event, '${envKey}', '${feature.route}')"
              `
            : `onclick="spaNavigate('${envKey}-${feature.route}')"`;

          return `
            <div class="${cardClass} ${isLightsFeature ? 'lights-feature' : ''}" ${lightEvents}
              data-env="${envKey}" data-feature="${feature.route}" data-device-ids="${lightIds.join(',')}" data-state="off">
              <img class="control-icon" src="images/icons/${feature.icon}" alt="${label}">
              ${isPresentation ? '' : `<div class="control-label">${label}</div>`}
            </div>
          `;
        }).join('');
      }

      function getMediaControlConfig(envKey) {
        if (typeof CLIENT_CONFIG === 'undefined') {
          return null;
        }

        return CLIENT_CONFIG.environments?.[envKey]?.mediaControl || null;
      }

      function escapeHtml(value) {
        if (value === undefined || value === null) return '';
        return String(value)
          .replace(/&/g, '&amp;')
          .replace(/"/g, '&quot;')
          .replace(/'/g, '&#39;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;');
      }

      function normalizeMediaDeviceId(deviceOrId) {
        const rawValue = typeof deviceOrId === 'object' && deviceOrId !== null
          ? deviceOrId.id
          : deviceOrId;

        if (rawValue === undefined || rawValue === null) {
          return null;
        }

        const normalized = String(rawValue).trim();
        if (!normalized || !/^\d+$/.test(normalized)) {
          return null;
        }

        return normalized;
      }

      // Fila de comandos verdadeiramente n√£o-bloqueante
      const mediaCommandQueue = [];
      let isProcessingMediaCommand = false;
      let mediaCommandTimeout = null;

      function processMediaCommandQueue() {
        if (isProcessingMediaCommand || mediaCommandQueue.length === 0) return;

        isProcessingMediaCommand = true;
        const { deviceIds, command, options } = mediaCommandQueue.shift();

        // Dispara comandos em background sem aguardar
        setTimeout(() => {
          const hasValue = options && Object.prototype.hasOwnProperty.call(options, 'value');
          deviceIds.forEach((deviceId) => {
            if (hasValue) {
              sendHubitatCommand(deviceId, command, options.value).catch(err => {
                console.error(`[media-control] Falha ao enviar ${command} para ${deviceId}:`, err.message);
              });
            } else {
              sendHubitatCommand(deviceId, command).catch(err => {
                console.error(`[media-control] Falha ao enviar ${command} para ${deviceId}:`, err.message);
              });
            }
          });
          
          isProcessingMediaCommand = false;
          
          // Processa pr√≥ximo item da fila ap√≥s pequeno delay
          if (mediaCommandQueue.length > 0) {
            mediaCommandTimeout = setTimeout(processMediaCommandQueue, 50);
          }
        }, 0);
      }

      function dispatchMediaCommands(deviceIds, command, options) {
        if (!Array.isArray(deviceIds) || !deviceIds.length || !command) {
          return;
        }

        if (typeof sendHubitatCommand !== 'function') {
          console.warn('[media-control] sendHubitatCommand indispon√≠vel');
          return;
        }

        // Adiciona √† fila
        mediaCommandQueue.push({ deviceIds, command, options });
        
        // Processa de forma completamente n√£o-bloqueante
        if (!isProcessingMediaCommand) {
          setTimeout(processMediaCommandQueue, 0);
        }
      }

      const playbackPowerState = {};
      const playbackMuteState = {};
      const mediaDeviceStates = {};

      const yamahaVolumeEnvs = new Set(['ambiente3', 'ambiente6']);

      function getPlaybackVolumeLimits(envKey) {
        const isYamaha = yamahaVolumeEnvs.has(envKey);
        return {
          min: 0,
          max: isYamaha ? 161 : 87,
          defaultValue: isYamaha ? 80 : 75
        };
      }

      // Zona de √°udio por ambiente (para setZoneVolume/muteZone)
      function getMediaZone(envKey) {
        const map = {
          ambiente1: 1, // Pr√≥logo
          ambiente4: 3, // Pesquisa
          ambiente10: 4 // Descanso
        };
        return map[envKey] || null;
      }

      function getPlaybackConfigs(envKey) {
        const mediaConfig = getMediaControlConfig(envKey);
        if (!mediaConfig) return [];

        if (Array.isArray(mediaConfig.playbackDevices) && mediaConfig.playbackDevices.length) {
          return mediaConfig.playbackDevices
            .filter(Boolean)
            .map((cfg, idx) => ({
              ...cfg,
              key: cfg.key || `pb${idx + 1}`
            }));
        }

        if (mediaConfig.playback) {
          return [{ ...mediaConfig.playback, key: mediaConfig.playback.key || 'default' }];
        }

        return [];
      }

      function getPlaybackConfig(envKey) {
        const configs = getPlaybackConfigs(envKey);
        return configs[0] || null;
      }

      function getPlaybackConfigByKey(envKey, playbackKey) {
        const key = playbackKey || 'default';
        const configs = getPlaybackConfigs(envKey);
        if (!configs.length) return null;
        const match = configs.find((cfg) => (cfg.key || 'default') === key);
        return match || configs[0];
      }

      function getPlaybackStateKey(envKey, playbackKey) {
        const key = playbackKey || 'default';
        return `${envKey}::${key}`;
      }

      function collectPlaybackPowerDevices(playbackConfig) {
        if (!playbackConfig || !Array.isArray(playbackConfig.powerDevices)) {
          return [];
        }

        return playbackConfig.powerDevices
          .map((device) => normalizeMediaDeviceId(device))
          .filter(Boolean);
      }

      function handlePlaybackPowerCommand(envKey, command, playbackKey) {
        if (!command) return;
        const playbackConfig = getPlaybackConfigByKey(envKey, playbackKey);
        if (!playbackConfig) {
          console.warn('[media-control] Playback config n√£o encontrado');
          return;
        }
        
        // Atualiza UI imediatamente, SEM aguardar resposta
        const isTurningOn = command === 'on';
        setPlaybackPowerState(envKey, playbackKey, isTurningOn);

        // Envia comando em background (n√£o aguarda)
        setTimeout(() => {
          const devices = collectPlaybackPowerDevices(playbackConfig);

          if (!devices.length) {
            console.warn('[media-control] Nenhum dispositivo configurado para ligar/desligar Player');
            return;
          }

          dispatchMediaCommands(devices, command);
        }, 0);
      }

      function handlePlaybackTransportCommand(envKey, command, playbackKey) {
        if (!command) return;
        const playbackConfig = getPlaybackConfigByKey(envKey, playbackKey);
        const deviceId = normalizeMediaDeviceId(playbackConfig?.transportDeviceId);

        if (!deviceId) {
          console.warn('[media-control] Dispositivo de transporte n√£o configurado');
          return;
        }

        // Atualiza UI imediatamente, mesmo com player "desligado" para n√£o bloquear
        updatePlaybackTransportUI(envKey, playbackKey, command);

        // Envia comando em background
        setTimeout(() => {
          dispatchMediaCommands([deviceId], command);
        }, 0);
      }

      function updatePlaybackTransportUI(envKey, playbackKey, activeCommand) {
        const selector = `.media-playback-transport button[data-env="${envKey}"][data-transport]`;
        document.querySelectorAll(selector).forEach((btn) => {
          const btnPlaybackKey = btn.getAttribute('data-playback-key') || 'default';
          if (btnPlaybackKey !== (playbackKey || 'default')) return;
          const isActive = activeCommand && btn.getAttribute('data-transport') === activeCommand;
          btn.classList.toggle('is-active', Boolean(isActive));
        });
      }

      function handlePlaybackVolumeInput(rangeEl) {
        if (!rangeEl) return;
        const max = Number(rangeEl.max || 100);
        const value = Number(rangeEl.value || 0);
        const percent = `${Math.min(100, Math.max(0, (value / max) * 100)).toFixed(0)}%`;
        rangeEl.style.setProperty('--playback-volume', percent);
      }

      // Debounce para volume
      const volumeChangeTimers = {};

      function handlePlaybackVolumeChange(rangeEl) {
        if (!rangeEl) return;
        const envKey = rangeEl.dataset.env;
        const playbackKey = rangeEl.dataset.playbackKey || 'default';
        const playbackConfig = getPlaybackConfigByKey(envKey, playbackKey);
        const deviceId = normalizeMediaDeviceId(rangeEl.dataset.deviceId || playbackConfig?.volumeDeviceId);
        const zone = getMediaZone(envKey);

        const { min: volMin, max: volMax } = getPlaybackVolumeLimits(envKey);
        const isYamaha = yamahaVolumeEnvs.has(envKey);
        const shouldUseZone = Boolean(zone) && !isYamaha;

        if (!deviceId) {
          console.warn('[media-control] Dispositivo de volume n√£o configurado');
          return;
        }

        const stateKey = getPlaybackStateKey(envKey, playbackKey);

        // Limpar timer anterior se existir
        if (volumeChangeTimers[stateKey]) {
          clearTimeout(volumeChangeTimers[stateKey]);
        }

        const rawValue = Number(rangeEl.value || 0);
        const value = Math.max(volMin, Math.min(volMax, rawValue));
        rangeEl.value = value;
        handlePlaybackVolumeInput(rangeEl);
        
        if (envKey && playbackMuteState[stateKey]) {
          setPlaybackMuteState(envKey, false, playbackKey);
        }

        // Debounce: aguarda 300ms sem altera√ß√µes antes de enviar
        volumeChangeTimers[stateKey] = setTimeout(() => {
          if (shouldUseZone) {
            dispatchMediaCommands([deviceId], 'setZoneVolume', { value: [zone, value] });
          } else {
            dispatchMediaCommands([deviceId], 'setVolume', { value });
          }
          volumeChangeTimers[stateKey] = null;
        }, 300);
      }

      function setPlaybackPowerState(envKey, playbackKey, isOn) {
        const stateKey = getPlaybackStateKey(envKey, playbackKey);
        playbackPowerState[stateKey] = Boolean(isOn);
        
        // Atualizar UI de forma instant√¢nea (sem yield)
        const powerButtons = document.querySelectorAll(`.media-panel__action-btn[data-playback-power][data-env="${envKey}"]`);
        powerButtons.forEach((button) => {
          const btnPlaybackKey = button.getAttribute('data-playback-key') || 'default';
          if (btnPlaybackKey !== (playbackKey || 'default')) return;
          const buttonTargetsOn = button.dataset.playbackPower === 'on';
          button.classList.toggle('is-active', buttonTargetsOn === Boolean(isOn));
        });

        const transportButtons = document.querySelectorAll(`.media-playback-transport button[data-env="${envKey}"]`);
        transportButtons.forEach((button) => {
          const btnPlaybackKey = button.getAttribute('data-playback-key') || 'default';
          if (btnPlaybackKey !== (playbackKey || 'default')) return;
          button.disabled = !isOn;
        });
        if (!isOn) {
          updatePlaybackTransportUI(envKey, playbackKey, null);
        }

        // N√£o desabilitar outros controles; apenas marca estado visual
      }

      function setPlaybackMuteState(envKey, muted, playbackKey) {
        const stateKey = getPlaybackStateKey(envKey, playbackKey);
        playbackMuteState[stateKey] = muted;

        if (envKey) {
          const muteBtn = document.querySelector(`.media-playback-mute-btn[data-env="${envKey}"][data-playback-key="${playbackKey || 'default'}"]`)
            || document.querySelector(`.media-playback-mute-btn[data-env="${envKey}"]`);
          if (muteBtn) {
            muteBtn.setAttribute('aria-pressed', muted ? 'true' : 'false');
            muteBtn.classList.toggle('is-muted', Boolean(muted));
            muteBtn.setAttribute('aria-label', muted ? 'Desativar mute' : 'Ativar mute');
          }

          const volumeContainer = document.querySelector(`.media-playback-volume[data-env="${envKey}"][data-playback-key="${playbackKey || 'default'}"]`)
            || document.querySelector(`.media-playback-volume[data-env="${envKey}"]`);
          if (volumeContainer) {
            volumeContainer.setAttribute('data-muted', muted ? 'true' : 'false');
          }

          const slider = document.querySelector(`.media-playback-slider[data-env="${envKey}"][data-playback-key="${playbackKey || 'default'}"]`)
            || document.querySelector(`.media-playback-slider[data-env="${envKey}"]`);
          if (slider && muted) {
            if (!slider.dataset.volumeBeforeMute) {
              slider.dataset.volumeBeforeMute = slider.value;
            }
            slider.value = 0;
            handlePlaybackVolumeInput(slider);
          } else if (slider && !muted && slider.dataset.volumeBeforeMute) {
            slider.value = slider.dataset.volumeBeforeMute;
            handlePlaybackVolumeInput(slider);
            delete slider.dataset.volumeBeforeMute;
          }
        }
      }

      function handlePlaybackMuteToggle(buttonEl) {
        if (!buttonEl) return;
        const envKey = buttonEl.dataset.env;
        const playbackKey = buttonEl.dataset.playbackKey || 'default';
        const zone = getMediaZone(envKey);

        const stateKey = getPlaybackStateKey(envKey, playbackKey);
        const nextMuted = !(envKey && playbackMuteState[stateKey]);
        
        // Atualiza UI imediatamente
        setPlaybackMuteState(envKey, nextMuted, playbackKey);

        // Envia comando em background
        setTimeout(() => {
          const datasetId = buttonEl.dataset.deviceId;
          const fallbackConfig = envKey ? getPlaybackConfigByKey(envKey, playbackKey) : null;
          const deviceId = normalizeMediaDeviceId(datasetId || fallbackConfig?.volumeDeviceId);

          if (!deviceId || !zone) {
            console.warn('[media-control] Dispositivo ou zona de mute n√£o configurado - apenas UI atualizada');
            return;
          }

          const command = nextMuted ? 'muteZone' : 'unmuteZone';
          dispatchMediaCommands([deviceId], command, { value: `${zone}` });
        }, 0);
      }

      function getDevicesForGroup(envKey, groupKey) {
        const mediaConfig = getMediaControlConfig(envKey);
        if (!mediaConfig) {
          return [];
        }

        switch (groupKey) {
          case 'projectors':
            return Array.isArray(mediaConfig.projectors) ? mediaConfig.projectors : [];
          case 'televisions':
            return Array.isArray(mediaConfig.televisions) ? mediaConfig.televisions : [];
          case 'computers':
            return Array.isArray(mediaConfig.computers) ? mediaConfig.computers : [];
          default:
            return [];
        }
      }

      function handleMediaGroupCommand(envKey, groupKey, command) {
        const devices = getDevicesForGroup(envKey, groupKey);
        const deviceIds = devices
          .map((device) => normalizeMediaDeviceId(device))
          .filter(Boolean);

        // Atualizar UI de todos os cards do grupo
        const sectionSelector = `.media-panel__section[data-group="${groupKey}"]`;
        const section = document.querySelector(sectionSelector);
        if (section) {
          const cards = section.querySelectorAll('.media-device-card');
          cards.forEach((card) => {
            const onBtn = card.querySelector('.media-device-card__btn--on');
            const offBtn = card.querySelector('.media-device-card__btn--off');
            
            if (onBtn && offBtn) {
              const isOn = command === 'on';
              onBtn.classList.toggle('is-active', isOn);
              offBtn.classList.toggle('is-active', !isOn);
            }
          });
        }

        if (!deviceIds.length) {
          console.warn(`[media-control] Nenhum dispositivo v√°lido configurado para ${groupKey} em ${envKey} - comando ignorado`);
        } else {
          dispatchMediaCommands(deviceIds, command);
        }
      }

      function handleMediaDeviceCommand(rawDeviceId, command, cardId) {
        const normalized = normalizeMediaDeviceId(rawDeviceId);
        const effectiveCommand = normalized === '69' && command === 'on' ? 'off' : command;
        
        if (cardId) {
          const card = document.getElementById(cardId);
          if (card) {
            const onBtn = card.querySelector('.media-device-card__btn--on');
            const offBtn = card.querySelector('.media-device-card__btn--off');
            
            if (onBtn && offBtn) {
              const isOn = command === 'on';
              onBtn.classList.toggle('is-active', isOn);
              offBtn.classList.toggle('is-active', !isOn);
            }
          }
        }
        
        if (!normalized) {
          console.warn('[media-control] ID de dispositivo inv√°lido para controle individual - comando ignorado');
        } else {
          dispatchMediaCommands([normalized], effectiveCommand);
        }
      }

      function toggleMediaSection(sectionId) {
        if (!sectionId) return;
        const body = document.querySelector(`.media-panel__body[data-section="${sectionId}"]`);
        if (!body) return;
        const toggleBtn = document.querySelector(`.media-panel__section-toggle[data-section="${sectionId}"]`);
        const isOpen = body.classList.toggle('is-open');
        if (toggleBtn) {
          toggleBtn.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
          const arrowImg = toggleBtn.querySelector('img');
          if (arrowImg) {
            arrowImg.src = isOpen ? 'images/icons/arrow-up.svg' : 'images/icons/arrow-down.svg';
            arrowImg.alt = isOpen ? 'Recolher' : 'Expandir';
          }
        }
      }

      function renderMediaDeviceCard(device) {
        const rawName = device?.name || 'Dispositivo';
        const translatedName = typeof translateText === 'function' ? translateText(rawName) : rawName;
        const safeName = escapeHtml(translatedName);
        const rawDescription = device?.description || '';
        const translatedDescription = rawDescription && typeof translateText === 'function' ? translateText(rawDescription) : rawDescription;
        const safeDescription = translatedDescription
          ? `<p class="media-device-card__meta">${escapeHtml(translatedDescription)}</p>`
          : '';
        const deviceId = device?.id || '';
        const safeIdAttr = escapeHtml(deviceId);
        const cardId = `media-card-${Math.random().toString(36).substr(2, 9)}`;

        const nameLabel = typeof translateText === 'function' ? translateText(safeName) : safeName;
        const onLabel = typeof translateText === 'function' ? translateText('On') : 'On';
        const offLabel = typeof translateText === 'function' ? translateText('Off') : 'Off';

        return `
          <article class="media-device-card" data-device-id="${safeIdAttr}" id="${cardId}">
            <div class="media-device-card__info">
              <span class="media-device-card__name">${nameLabel}</span>
              ${safeDescription}
            </div>
            <div class="media-device-card__actions">
              <button type="button" class="media-device-card__btn media-device-card__btn--on" data-device-id="${safeIdAttr}" data-card-id="${cardId}" onclick="handleMediaDeviceCommand(this.dataset.deviceId, 'on', this.dataset.cardId)">${onLabel}</button>
              <button type="button" class="media-device-card__btn media-device-card__btn--off" data-device-id="${safeIdAttr}" data-card-id="${cardId}" onclick="handleMediaDeviceCommand(this.dataset.deviceId, 'off', this.dataset.cardId)">${offLabel}</button>
            </div>
          </article>
        `;
      }

      function renderMediaDeviceSection(envKey, groupKey, options) {
        const {
          title = '',
          icon = 'icon-media.svg',
          subtitle = '',
          devices = [],
        } = options || {};

        const safeEnvKey = escapeHtml(envKey);
        const safeIcon = escapeHtml(icon);
        const deviceCount = Array.isArray(devices) ? devices.filter(Boolean).length : 0;
        const connectedLabel = typeof translateText === 'function'
          ? translateText(deviceCount === 1 ? 'conectado' : 'conectados')
          : (deviceCount === 1 ? 'conectado' : 'conectados');
        const rawSubtitle = subtitle || `${deviceCount} ${connectedLabel}`;
        const sectionSubtitle = typeof translateText === 'function' ? translateText(rawSubtitle) : rawSubtitle;
        const rawTitle = title || '';
        const translatedTitle = typeof translateText === 'function' ? translateText(rawTitle) : rawTitle;
        const sectionId = `${envKey}-${groupKey}-section`;

        const hasDevices = devices.length > 0;
        const emptyLabel = typeof translateText === 'function'
          ? translateText('Nenhum dispositivo configurado para esta se√ß√£o.')
          : 'Nenhum dispositivo configurado para esta se√ß√£o.';
        const cards = hasDevices
          ? devices.map((device) => renderMediaDeviceCard(device)).join('')
          : `<div class="media-panel__empty">${emptyLabel}</div>`;

        return `
          <section class="media-panel__section" data-group="${groupKey}">
            <header class="media-panel__section-header">
              <div class="media-panel__section-headline">
                <div class="media-panel__section-summary">
                  <img src="images/icons/${safeIcon}" alt="${translatedTitle}" class="media-panel__section-icon">
                  <div class="media-panel__section-title">
                    <h2>${translatedTitle}</h2>
                    <p>${sectionSubtitle}</p>
                  </div>
                </div>
                <button type="button" class="media-panel__section-toggle" data-section="${sectionId}" aria-expanded="false" onclick="toggleMediaSection('${sectionId}')">
                  <img src="images/icons/arrow-down.svg" alt="Expandir">
                </button>
              </div>
              <div class="media-panel__actions media-panel__actions--stacked">
                <button type="button" class="media-panel__action-btn media-panel__action-btn--on" onclick="handleMediaGroupCommand('${safeEnvKey}', '${groupKey}', 'on')">${typeof translateText === 'function' ? translateText('Ligar') : 'Ligar'}</button>
                <button type="button" class="media-panel__action-btn" onclick="handleMediaGroupCommand('${safeEnvKey}', '${groupKey}', 'off')">${typeof translateText === 'function' ? translateText('Desligar') : 'Desligar'}</button>
              </div>
            </header>
            <div class="media-panel__body" data-section="${sectionId}">
              <div class="media-panel__grid">
                ${cards}
              </div>
            </div>
          </section>
        `;
      }

      function renderPlaybackControlSection(envKey, playbackConfig) {
        if (!playbackConfig) {
          return '';
        }

        const playbackKey = playbackConfig.key || 'default';
        const stateKey = getPlaybackStateKey(envKey, playbackKey);

        if (playbackPowerState[stateKey] === undefined) {
          playbackPowerState[stateKey] = false;
        }

        const safeEnvKey = escapeHtml(envKey);
        const safePlaybackKey = escapeHtml(playbackKey);
        const sectionId = `${envKey}-playback-${playbackKey}-section`;
        const powerDevices = collectPlaybackPowerDevices(playbackConfig);
        const hasPowerDevices = powerDevices.length > 0;
        const hasTransportDevice = Boolean(normalizeMediaDeviceId(playbackConfig.transportDeviceId));
        const volumeDeviceId = normalizeMediaDeviceId(playbackConfig.volumeDeviceId);
        const isPowerOn = Boolean(playbackPowerState[stateKey]);

        const { min: sliderMin, max: sliderMax, defaultValue: sliderDefault } = getPlaybackVolumeLimits(envKey);
        const sliderPercent = Math.round((sliderDefault / sliderMax) * 100);

        // Mant√©m controles sempre habilitados para n√£o bloquear intera√ß√£o
        const transportDisabledAttr = '';
        const volumeDisabledAttr = '';
        const muteDisabledAttr = '';

        const volumeAvailableAttr = 'true';
        const transportAvailableAttr = 'true';
        const sliderWrapperDisabledClass = '';

        const audioTitle = typeof translateText === 'function'
          ? translateText(playbackConfig.label || 'M√≠dia')
          : (playbackConfig.label || 'M√≠dia');
        const connectedLabel = typeof translateText === 'function'
          ? translateText(isPowerOn ? 'Conectado' : 'Conectado')
          : 'Conectado';
        const playLabel = typeof translateText === 'function' ? translateText('Reproduzir') : 'Reproduzir';
        const pauseLabel = typeof translateText === 'function' ? translateText('Pausar') : 'Pausar';
        const stopLabel = typeof translateText === 'function' ? translateText('Parar') : 'Parar';
        const muteLabel = typeof translateText === 'function' ? translateText('Ativar mute') : 'Ativar mute';
        const onLabel = typeof translateText === 'function' ? translateText('Ligar') : 'Ligar';
        const offLabel = typeof translateText === 'function' ? translateText('Desligar') : 'Desligar';

        return `
          <section class="media-panel__section media-panel__section--playback" data-group="playback-${safePlaybackKey}">
            <header class="media-panel__section-header">
              <div class="media-panel__section-headline">
                <div class="media-panel__section-summary">
                  <img src="images/icons/icon-apresentacao.svg" alt="${audioTitle}" class="media-panel__section-icon">
                  <div class="media-panel__section-title">
                    <h2>${audioTitle}</h2>
                  </div>
                </div>
              </div>
              <div class="media-panel__actions media-panel__actions--stacked">
                <button type="button" class="media-panel__action-btn media-panel__action-btn--on${isPowerOn ? ' is-active' : ''}" data-env="${safeEnvKey}" data-playback-key="${safePlaybackKey}" data-playback-power="on" onclick="handlePlaybackPowerCommand('${safeEnvKey}', 'on', '${safePlaybackKey}')">${onLabel}</button>
                <button type="button" class="media-panel__action-btn${!isPowerOn ? ' is-active' : ''}" data-env="${safeEnvKey}" data-playback-key="${safePlaybackKey}" data-playback-power="off" onclick="handlePlaybackPowerCommand('${safeEnvKey}', 'off', '${safePlaybackKey}')">${offLabel}</button>
              </div>
            </header>
            <div class="media-panel__body is-open" data-section="${sectionId}">
              <div class="media-playback-controls">
                <div class="media-playback-transport">
                  <button type="button" class="media-playback-btn" data-env="${safeEnvKey}" data-playback-key="${safePlaybackKey}" data-transport="play" data-transport-enabled="${transportAvailableAttr}" onclick="handlePlaybackTransportCommand('${safeEnvKey}', 'play', '${safePlaybackKey}')" aria-label="${playLabel}"${transportDisabledAttr}>
                    <img src="images/icons/icon-play.svg" alt="" class="media-playback-btn__icon" aria-hidden="true">
                  </button>
                  <button type="button" class="media-playback-btn" data-env="${safeEnvKey}" data-playback-key="${safePlaybackKey}" data-transport="pause" data-transport-enabled="${transportAvailableAttr}" onclick="handlePlaybackTransportCommand('${safeEnvKey}', 'pause', '${safePlaybackKey}')" aria-label="${pauseLabel}"${transportDisabledAttr}>
                    <img src="images/icons/icon-pause.svg" alt="" class="media-playback-btn__icon" aria-hidden="true">
                  </button>
                  <button type="button" class="media-playback-btn" data-env="${safeEnvKey}" data-playback-key="${safePlaybackKey}" data-transport="stop" data-transport-enabled="${transportAvailableAttr}" onclick="handlePlaybackTransportCommand('${safeEnvKey}', 'stop', '${safePlaybackKey}')" aria-label="${stopLabel}"${transportDisabledAttr}>
                    <img src="images/icons/icon-end.svg" alt="" class="media-playback-btn__icon" aria-hidden="true">
                  </button>
                </div>
                <div class="media-playback-volume" data-env="${safeEnvKey}" data-playback-key="${safePlaybackKey}">
                  <button type="button" class="media-playback-mute-btn" data-env="${safeEnvKey}" data-playback-key="${safePlaybackKey}" data-device-id="${volumeDeviceId || ''}" data-volume-available="${volumeAvailableAttr}" onclick="handlePlaybackMuteToggle(this)" aria-label="${muteLabel}" aria-pressed="false"${muteDisabledAttr}>
                    <img src="images/icons/icon-volume.svg" alt="" class="media-playback-mute-icon media-playback-mute-icon--unmuted" aria-hidden="true">
                    <img src="images/icons/icon-mute.svg" alt="" class="media-playback-mute-icon media-playback-mute-icon--muted" aria-hidden="true">
                  </button>
                  <div class="media-playback-slider-wrapper${sliderWrapperDisabledClass}" data-env="${safeEnvKey}" data-playback-key="${safePlaybackKey}" data-volume-available="${volumeAvailableAttr}">
                    <input type="range" min="${sliderMin}" max="${sliderMax}" value="${sliderDefault}" class="media-playback-slider" data-env="${safeEnvKey}" data-playback-key="${safePlaybackKey}" data-device-id="${volumeDeviceId || ''}" data-volume-available="${volumeAvailableAttr}" oninput="handlePlaybackVolumeInput(this)" onchange="handlePlaybackVolumeChange(this)" style="--playback-volume:${sliderPercent}%"${volumeDisabledAttr}>
                  </div>
                </div>
              </div>
            </div>
          </section>
        `;
      }

      function renderImersaoMediaControlPanel(envKey, controlConfig) {
        const envName = getTranslatedEnvName(envKey, envKey);
        const mediaLabel = typeof translateText === 'function' ? translateText('M√≠dia') : 'M√≠dia';
        const buttons = [
          { cmd: 'standby', label: 'Play Standby', icon: 'icon-LPHT-v2.png' },
          { cmd: 'playCN', label: 'Play CN', icon: 'icon-cn-v2.svg' },
          { cmd: 'playEN', label: 'Play EN', icon: 'icon-en-v2.svg' },
          { cmd: 'playPT', label: 'Play PT', icon: 'icon-br-v2.svg' },
        ];

        const buttonsHtml = buttons.map(btn => `
          <button type="button" class="imersao-playback-btn" data-env="${envKey}" data-cmd="${btn.cmd}" onclick="handleImersaoPlayback('${envKey}', '${btn.cmd}')">
            <img src="images/icons/${btn.icon}" alt="${btn.label}" class="imersao-playback-btn__icon" loading="lazy" decoding="async">
            <span class="imersao-playback-btn__label">${btn.label}</span>
          </button>
        `).join('');

        return `
<div class="top-bar-custom"></div>

<div class="page active page-container midia-page ${envKey}-page">

  <div class="page-header">
    <button class="back-btn" onclick="spaNavigate('${envKey}')">
      <img src="images/icons/back-button.svg" alt="Voltar">
    </button>
    <h1 class="page-title">${envName}</h1>
  </div>

  <div class="midia-wrapper ambiente-grid media-panel-wrapper">
    <div class="media-panel">
      <section class="media-panel__section media-panel__section--imersao" data-group="imersao-playback">
        <header class="media-panel__section-header">
          <div class="media-panel__section-headline">
            <div class="media-panel__section-summary">
              <img src="images/icons/icon-apresentacao.svg" alt="${mediaLabel}" class="media-panel__section-icon">
              <div class="media-panel__section-title">
                <h2>${mediaLabel}</h2>
              </div>
            </div>
          </div>
        </header>
        <div class="media-panel__body is-open">
          <div class="imersao-playback-grid">
            ${buttonsHtml}
          </div>
        </div>
      </section>
    </div>
  </div>

</div>
        `;
      }

      const imersaoPlaybackState = {};

      function getImersaoTransportDevice(envKey) {
        if (envKey === 'ambiente3') {
          return '183';
        }
        const playbackConfigs = getPlaybackConfigs(envKey);
        const primary = playbackConfigs && playbackConfigs.length ? playbackConfigs[0] : null;
        const transport = normalizeMediaDeviceId(primary?.transportDeviceId);
        if (transport) return transport;
        const power = Array.isArray(primary?.powerDevices) && primary.powerDevices.length
          ? normalizeMediaDeviceId(primary.powerDevices[0])
          : null;
        return power || null;
      }

      async function handleImersaoPlayback(envKey, command) {
        if (!envKey || !command) return;
        const deviceId = getImersaoTransportDevice(envKey);
        if (!deviceId) {
          console.warn('[imersao-playback] Nenhum dispositivo configurado para envio de comando');
          return;
        }
        try {
          await sendHubitatCommand(deviceId, command);
          imersaoPlaybackState[envKey] = command;
          updateImersaoPlaybackUI(envKey);
        } catch (err) {
          console.error(`[imersao-playback] Falha ao enviar ${command} para ${deviceId}:`, err);
        }
      }

      function updateImersaoPlaybackUI(envKey) {
        const active = imersaoPlaybackState[envKey];
        const buttons = document.querySelectorAll(`.imersao-playback-btn[data-env="${envKey}"]`);
        buttons.forEach((btn) => {
          const cmd = btn.getAttribute('data-cmd');
          btn.classList.toggle('is-active', Boolean(active && cmd === active && cmd !== 'standby'));
        });
      }

      function renderImersaoPlaybackSection(envKey, playbackConfig) {
        const playbackKey = playbackConfig?.key || 'default';
        const safeEnvKey = escapeHtml(envKey);
        const safePlaybackKey = escapeHtml(playbackKey);
        const mediaLabel = typeof translateText === 'function' ? translateText('M√≠dia') : 'M√≠dia';
        const { min: sliderMin, max: sliderMax, defaultValue: sliderDefault } = getPlaybackVolumeLimits(envKey);
        const sliderPercent = Math.round((sliderDefault / sliderMax) * 100);
        const volumeDeviceId = normalizeMediaDeviceId(playbackConfig?.volumeDeviceId);
        const volumeAvailableAttr = 'true';
        const sliderWrapperDisabledClass = '';
        const volumeDisabledAttr = '';
        const muteDisabledAttr = '';
        const muteLabel = typeof translateText === 'function' ? translateText('Ativar mute') : 'Ativar mute';

        const buttons = [
          { cmd: 'standby', label: 'Play Standby', icon: 'icon-LPHT-v2.png' },
          { cmd: 'playCN', label: 'Play CN', icon: 'icon-cn-v2.svg' },
          { cmd: 'playEN', label: 'Play EN', icon: 'icon-en-v2.svg' },
          { cmd: 'playPT', label: 'Play PT', icon: 'icon-br-v2.svg' },
        ];

        const buttonsHtml = buttons.map(btn => `
          <button type="button" class="imersao-playback-btn" data-env="${safeEnvKey}" data-cmd="${btn.cmd}" onclick="handleImersaoPlayback('${safeEnvKey}', '${btn.cmd}')">
            <img src="images/icons/${btn.icon}" alt="${btn.label}" class="imersao-playback-btn__icon" loading="lazy" decoding="async">
            <span class="imersao-playback-btn__label">${btn.label}</span>
          </button>
        `).join('');

        return `
        <section class="media-panel__section media-panel__section--imersao" data-group="playback-${safePlaybackKey}">
          <header class="media-panel__section-header">
            <div class="media-panel__section-headline">
              <div class="media-panel__section-summary">
                <img src="images/icons/icon-apresentacao.svg?v=2" alt="${mediaLabel}" class="media-panel__section-icon">
                <div class="media-panel__section-title">
                  <h2>${mediaLabel}</h2>
                </div>
              </div>
            </div>
          </header>
          <div class="media-panel__body is-open">
            <div class="imersao-playback-grid">
              ${buttonsHtml}
            </div>
            <div class="media-playback-volume" data-env="${safeEnvKey}" data-playback-key="${safePlaybackKey}">
              <button type="button" class="media-playback-mute-btn" data-env="${safeEnvKey}" data-playback-key="${safePlaybackKey}" data-device-id="${volumeDeviceId || ''}" data-volume-available="${volumeAvailableAttr}" onclick="handlePlaybackMuteToggle(this)" aria-label="${muteLabel}" aria-pressed="false"${muteDisabledAttr}>
                <img src="images/icons/icon-volume.svg" alt="" class="media-playback-mute-icon media-playback-mute-icon--unmuted" aria-hidden="true">
                <img src="images/icons/icon-mute.svg" alt="" class="media-playback-mute-icon media-playback-mute-icon--muted" aria-hidden="true">
              </button>
              <div class="media-playback-slider-wrapper${sliderWrapperDisabledClass}" data-env="${safeEnvKey}" data-playback-key="${safePlaybackKey}" data-volume-available="${volumeAvailableAttr}">
                <input type="range" min="${sliderMin}" max="${sliderMax}" value="${sliderDefault}" class="media-playback-slider" data-env="${safeEnvKey}" data-playback-key="${safePlaybackKey}" data-device-id="${volumeDeviceId || ''}" data-volume-available="${volumeAvailableAttr}" oninput="handlePlaybackVolumeInput(this)" onchange="handlePlaybackVolumeChange(this)" style="--playback-volume:${sliderPercent}%"${volumeDisabledAttr}>
              </div>
            </div>
          </div>
        </section>
        `;
      }

      function renderMediaControlPanel(envKey, controlConfig) {
        if (envKey === 'ambiente3') {
          const envName = getTranslatedEnvName(envKey, envKey);
          const description = controlConfig?.description ? `<p class="media-panel__description">${escapeHtml(controlConfig.description)}</p>` : '';

          const projectorDevices = Array.isArray(controlConfig?.projectors)
            ? controlConfig.projectors.filter(Boolean)
            : [];
          const projectorSection = projectorDevices.length
            ? renderMediaDeviceSection(envKey, 'projectors', {
                title: typeof translateText === 'function' ? translateText('Projetores') : 'Projetores',
                icon: 'icon-projetor.svg',
                subtitle: '',
                devices: projectorDevices
              })
            : '';

          const tvDevices = Array.isArray(controlConfig?.televisions)
            ? controlConfig.televisions.filter(Boolean)
            : [];
          const tvSection = tvDevices.length
            ? renderMediaDeviceSection(envKey, 'televisions', {
                title: typeof translateText === 'function' ? translateText('Televisores') : 'Televisores',
                icon: 'icon-tv.svg',
                subtitle: '',
                devices: tvDevices
              })
            : '';

          const computerDevices = Array.isArray(controlConfig?.computers)
            ? controlConfig.computers.filter(Boolean)
            : [];
          const computerSection = computerDevices.length
            ? renderMediaDeviceSection(envKey, 'computers', {
                title: typeof translateText === 'function' ? translateText('Computadores') : 'Computadores',
                icon: 'icon-pc.svg',
                subtitle: '',
                devices: computerDevices
              })
            : '';

          const playbackConfigs = getPlaybackConfigs(envKey);
          const playbackSection = playbackConfigs.length
            ? playbackConfigs.map((cfg) => renderImersaoPlaybackSection(envKey, cfg)).join('')
            : '';

          return `
<div class="top-bar-custom"></div>

<div class="page active page-container midia-page ${envKey}-page">

  <div class="page-header">
    <button class="back-btn" onclick="spaNavigate('${envKey}')">
      <img src="images/icons/back-button.svg" alt="Voltar">
    </button>
    <h1 class="page-title">${envName}</h1>
  </div>

  <div class="midia-wrapper ambiente-grid media-panel-wrapper">
    <div class="media-panel">
      ${description}
      ${playbackSection}
      ${projectorSection}
      ${tvSection}
        ${computerSection}
    </div>
  </div>

</div>
          `;
        }

        const envName = getTranslatedEnvName(envKey, envKey);
        const mediaLabel = typeof translateText === 'function' ? translateText('M√≠dia') : 'M√≠dia';
        const description = controlConfig?.description ? `<p class="media-panel__description">${escapeHtml(controlConfig.description)}</p>` : '';

        const projectorDevices = Array.isArray(controlConfig?.projectors)
          ? controlConfig.projectors.filter(Boolean)
          : [];
        const projectorSection = projectorDevices.length
          ? renderMediaDeviceSection(envKey, 'projectors', {
              title: typeof translateText === 'function' ? translateText('Projetores') : 'Projetores',
              icon: 'icon-projetor.svg',
              subtitle: '',
              devices: projectorDevices
            })
          : '';

        const tvDevices = Array.isArray(controlConfig?.televisions)
          ? controlConfig.televisions.filter(Boolean)
          : [];
        const tvSection = tvDevices.length
          ? renderMediaDeviceSection(envKey, 'televisions', {
              title: typeof translateText === 'function' ? translateText('Televisores') : 'Televisores',
              icon: 'icon-tv.svg',
              subtitle: '',
              devices: tvDevices
            })
          : '';

        const computerDevices = Array.isArray(controlConfig?.computers)
          ? controlConfig.computers.filter(Boolean)
          : [];
        const computerSection = computerDevices.length
          ? renderMediaDeviceSection(envKey, 'computers', {
              title: typeof translateText === 'function' ? translateText('Computadores') : 'Computadores',
              icon: 'icon-pc.svg',
              subtitle: '',
              devices: computerDevices
            })
          : '';

        const playbackConfigs = getPlaybackConfigs(envKey);
        const playbackSection = playbackConfigs.length
          ? playbackConfigs.map((cfg) => renderPlaybackControlSection(envKey, cfg)).join('')
          : '';

        return `
<div class="top-bar-custom"></div>

<div class="page active page-container midia-page ${envKey}-page">

  <div class="page-header">
    <button class="back-btn" onclick="spaNavigate('${envKey}')">
      <img src="images/icons/back-button.svg" alt="Voltar">
    </button>
    <h1 class="page-title">${envName}</h1>
  </div>

  <div class="midia-wrapper ambiente-grid media-panel-wrapper">
    <div class="media-panel">
      ${description}
      ${playbackSection}
      ${projectorSection}
      ${tvSection}
        ${computerSection}
    </div>
  </div>

</div>
        `;
      }

      function generateMediaSelectionPage(envKey) {
        const mediaControlConfig = getMediaControlConfig(envKey);
        if (mediaControlConfig) {
          return renderMediaControlPanel(envKey, mediaControlConfig);
        }

        const envName = getTranslatedEnvName(envKey, envKey);
        const mediaLabel = typeof translateText === 'function' ? translateText('M√≠dia') : 'M√≠dia';
        const mediaFeatures = getMediaFeatures(envKey);
        const hasMedia = mediaFeatures.length > 0;

        const cards = hasMedia
          ? mediaFeatures.map(feature => {
              const label = typeof translateText === 'function' ? translateText(feature.label) : feature.label;
              return `
              <div class="control-card" onclick="spaNavigate('${envKey}-${feature.route}')">
                <img class="control-icon" src="images/icons/${feature.icon}" alt="${label}">
                <div class="control-label">${label}</div>
              </div>
            `;
            }).join('')
          : '<div class="midia-empty-state">' + (typeof translateText === 'function' ? translateText('Nenhum dispositivo de m√≠dia dispon√≠vel para este ambiente.') : 'Nenhum dispositivo de m√≠dia dispon√≠vel para este ambiente.') + '</div>';

        return `
<div class="top-bar-custom"></div>

<div class="page active page-container midia-page ${envKey}-page">

  <div class="page-header">
    <button class="back-btn" onclick="spaNavigate('${envKey}')">
      <img src="images/icons/back-button.svg" alt="Voltar">
    </button>
    <h1 class="page-title">${envName}</h1>
  </div>

  <div class="midia-wrapper ambiente-grid">
    ${cards}
  </div>

</div>
        `;
      }

      const CURTAIN_SECTIONS = [
        {
          key: "ambiente1",
          name: "Pr√≥logo",
          curtains: [],
        },
        {
          key: "ambiente2",
          name: "Circula√ß√£o",
          curtains: [
            { deviceId: "50", title: "Cortina 1" },
            { deviceId: "51", title: "Cortina 2" },
            { deviceId: "52", title: "Cortina 3" },
            { deviceId: "119", title: "Cortina 4" }
          ],
        },
        {
          key: "ambiente9",
          name: "Cultura",
          curtains: [
            { deviceId: "192", title: "Veneziana 1" },
            { deviceId: "193", title: "Veneziana 2" }
          ],
        },
        {
          key: "ambiente10",
          name: "Descanso",
          curtains: [{ deviceId: "194", title: "Veneziana" }],
        }
      ];

      function renderCurtainControlCard(curtain, environment) {
        const { deviceId, title, description } = curtain;
        return `
        <article class="curtain-tile" data-device-id="${deviceId}" data-environment="${environment}">
            <header class="curtain-tile__header">
                <h3 class="curtain-tile__title">${title}</h3>
                ${
                  description
                    ? `<p class="curtain-tile__subtitle">${description}</p>`
                    : ""
                }
            </header>
            <div class="curtain-tile__actions">
                <button class="curtain-tile__btn" data-device-id="${deviceId}" onclick="curtainAction(this, 'open')" aria-label="Abrir ${title}">
                    <img src="images/icons/arrow-up.svg" alt="Abrir">
                </button>
                <button class="curtain-tile__btn" data-device-id="${deviceId}" onclick="curtainAction(this, 'stop')" aria-label="Parar ${title}">
                    <img src="images/icons/icon-stop.svg" alt="Parar">
                </button>
                <button class="curtain-tile__btn" data-device-id="${deviceId}" onclick="curtainAction(this, 'close')" aria-label="Fechar ${title}">
                    <img src="images/icons/arrow-down.svg" alt="Fechar">
                </button>
            </div>
        </article>`;
      }

      function renderCurtainSection(section) {
        // Traduz o nome da se√ß√£o
        const sectionName = typeof translateText === 'function' ? translateText(section.name) : section.name;
        return `
        <section class="curtain-section" data-section="${section.key}">
            <div class="curtain-section__wrapper">
                <header class="curtain-section__header">
                    <h2 class="curtain-section__title">${sectionName}</h2>
                    <div class="curtain-section__line"></div>
                </header>
                <div class="curtain-section__grid">
                    ${section.curtains
                      .map((curtain) =>
                        renderCurtainControlCard(curtain, sectionName)
                      )
                      .join("")}
                </div>
            </div>
        </section>`;
      }

      const APP_INFO_VERSION = "1.2";

      const APP_INFO_VISIBLE_CLASS = "is-visible";

      const appInfoOverlay = document.getElementById("app-info-overlay");

      const appInfoVersionLabel = document.getElementById("app-info-version");

      const fullscreenToggleBtn = document.getElementById(
        "app-fullscreen-toggle"
      );
      const cacheClearBtn = document.getElementById("app-cache-clear");
      const instagramLink = document.getElementById("app-instagram-link");
      const supportLink = document.getElementById("app-support-link");

      let appInfoReturnFocusElement = null;

      let fullscreenListenersBound = false;

      function updateAppInfoVersion() {
        if (appInfoVersionLabel) {
          appInfoVersionLabel.textContent = "v" + APP_INFO_VERSION;
        }
      }

      function openAppInfoMenu() {
        if (!appInfoOverlay) return;

        appInfoReturnFocusElement =
          document.activeElement instanceof HTMLElement
            ? document.activeElement
            : null;

        appInfoOverlay.classList.add(APP_INFO_VISIBLE_CLASS);

        appInfoOverlay.setAttribute("aria-hidden", "false");

        document.body.classList.add("app-info-open");

        updateFullscreenOptionLabel();

        const dialog = appInfoOverlay.querySelector(".app-info-dialog");

        if (dialog && typeof dialog.focus === "function") {
          dialog.setAttribute("tabindex", "-1");

          try {
            dialog.focus({ preventScroll: true });
          } catch (err) {
            dialog.focus();
          }
        }
      }

      function closeAppInfoMenu() {
        if (!appInfoOverlay) return;

        appInfoOverlay.classList.remove(APP_INFO_VISIBLE_CLASS);

        appInfoOverlay.setAttribute("aria-hidden", "true");

        document.body.classList.remove("app-info-open");

        if (
          appInfoReturnFocusElement &&
          typeof appInfoReturnFocusElement.focus === "function"
        ) {
          appInfoReturnFocusElement.focus();
        }
      }

      function isFullscreenActive() {
        return Boolean(
          document.fullscreenElement ||
            document.webkitFullscreenElement ||
            document.msFullscreenElement
        );
      }

      function updateFullscreenOptionLabel() {
        if (!fullscreenToggleBtn) return;

        const label = fullscreenToggleBtn.querySelector(
          ".app-info-option__label"
        );

        if (!label) return;

        const isActive = isFullscreenActive();

        const labelText = isActive
          ? "Sair do modo tela cheia"
          : "Ativar tela cheia";

        label.textContent = labelText;
        fullscreenToggleBtn.setAttribute("aria-label", labelText);
      }

      function toggleFullscreen() {
        const doc = document;
        const docEl = doc.documentElement;
        const active = isFullscreenActive();

        let action;

        if (!active) {
          const request =
            docEl.requestFullscreen ||
            docEl.webkitRequestFullscreen ||
            docEl.msRequestFullscreen;

          if (!request) {
            console.warn("Fullscreen API indisponivel neste navegador.");
            closeAppInfoMenu();
            updateFullscreenOptionLabel();
            return;
          }

          action = request.call(docEl);
        } else {
          const exit =
            doc.exitFullscreen ||
            doc.webkitExitFullscreen ||
            doc.msExitFullscreen;

          if (!exit) {
            closeAppInfoMenu();
            updateFullscreenOptionLabel();
            return;
          }

          action = exit.call(doc);
        }

        closeAppInfoMenu();

        if (action && typeof action.then === "function") {
          action.catch(() => {}).finally(updateFullscreenOptionLabel);
        } else {
          updateFullscreenOptionLabel();
        }
      }

      function onFullscreenToggleClick(event) {
        event.preventDefault();
        toggleFullscreen();
      }

      function onCacheClearClick(event) {
        event.preventDefault();

        closeAppInfoMenu();

        if (typeof window.brutalCacheClear === "function") {
          window.brutalCacheClear();
        } else {
          console.warn("Funcao brutalCacheClear indisponivel.");
        }
      }

      window.toggleFullscreen = toggleFullscreen;
      window.handleImersaoPlayback = handleImersaoPlayback;
      window.updateImersaoPlaybackUI = updateImersaoPlaybackUI;

      function handleAppLogoTrigger(event) {
        event.preventDefault();

        openAppInfoMenu();
      }

      function setupAppInfoMenu() {
        document.querySelectorAll(".app-logo-trigger").forEach((trigger) => {
          trigger.removeEventListener("click", handleAppLogoTrigger);

          trigger.addEventListener("click", handleAppLogoTrigger);
        });
      }

      function initializeAppInfoMenu() {
        if (!appInfoOverlay) return;

        if (appInfoOverlay.dataset.ready === "true") return;

        appInfoOverlay.dataset.ready = "true";

        updateAppInfoVersion();

        appInfoOverlay.addEventListener("click", (event) => {
          if (event.target === appInfoOverlay) {
            closeAppInfoMenu();
          }
        });

        const closeBtn = appInfoOverlay.querySelector(".app-info-close");

        if (closeBtn) {
          closeBtn.addEventListener("click", closeAppInfoMenu);
        }

        if (fullscreenToggleBtn) {
          fullscreenToggleBtn.removeEventListener(
            "click",
            onFullscreenToggleClick
          );

          fullscreenToggleBtn.addEventListener(
            "click",
            onFullscreenToggleClick
          );

          updateFullscreenOptionLabel();
        }

        if (cacheClearBtn) {
          cacheClearBtn.removeEventListener("click", onCacheClearClick);
          cacheClearBtn.addEventListener("click", onCacheClearClick);
        }
        if (instagramLink) {
          instagramLink.removeEventListener("click", closeAppInfoMenu);
          instagramLink.addEventListener("click", closeAppInfoMenu);
        }

        if (supportLink) {
          supportLink.removeEventListener("click", closeAppInfoMenu);
          supportLink.addEventListener("click", closeAppInfoMenu);
        }

        if (!fullscreenListenersBound) {
          [
            "fullscreenchange",
            "webkitfullscreenchange",
            "mozfullscreenchange",
            "msfullscreenchange",
          ].forEach((evt) => {
            document.addEventListener(evt, updateFullscreenOptionLabel);
          });

          fullscreenListenersBound = true;
        }

        document.addEventListener("keydown", (event) => {
          if (
            event.key === "Escape" &&
            appInfoOverlay.classList.contains(APP_INFO_VISIBLE_CLASS)
          ) {
            closeAppInfoMenu();
          }
        });
      }

      const pages = {
        curtains: () => `

            <div class="top-bar-custom"></div>

      <main class="container curtains-page-container">

        <div class="page active curtains-page">

                    <h1 class="page-title fixed-header" style="display:flex;justify-content:center;align-items:center;">

                        <button class="app-logo-trigger" type="button" aria-label="Abrir informacoes do aplicativo">

                            <img class="logo-round" src="images/icons/eletrize.svg" alt="Dashboard Eletrize" />

                        </button>

                    </h1>

                    <div class="curtain-layout">

                        ${CURTAIN_SECTIONS.map(renderCurtainSection).join("")}

                    </div>

                </div>

            </main>

        `,

        "ambiente1-musica": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente1-page ambiente1-musica-page">

  <div class="page-header">
    <button class="back-btn" onclick="spaNavigate('ambiente1')">
      <img src="images/icons/back-button.svg" alt="Voltar">
    </button>
    <h1 class="page-title">Varanda, M√∫sica</h1>
  </div>

  <div class="ambiente1-musica-wrapper ambiente-grid">
    <div class="control-card control-card--full-width music-player-card" data-metadata-device-id="29">
      <div class="music-player-inner">
        <div class="music-player-content">
          <div class="music-primary">
            <div class="music-album">
              <img class="music-album-img" src="images/optimized/photo-varanda-720.webp" alt="Capa do √°lbum" loading="lazy" decoding="async" width="720" height="540">
            </div>

            <div class="music-info">
              <div class="music-track">
                <div class="music-track-marquee">
                  <div class="music-track-marquee__inner">
                    <span class="music-track-marquee__text" id="music-track">Nome da M√∫sica</span>
                    <span class="music-track-marquee__text music-track-marquee__text--clone" aria-hidden="true"></span>
                  </div>
                </div>
              </div>
              <div class="music-artist" id="music-artist">Nome do Artista</div>
            </div>
          </div>

          <div class="music-secondary">
            <div class="music-info music-info--desktop">
              <div class="music-track">
                <div class="music-track-marquee">
                  <div class="music-track-marquee__inner">
                    <span class="music-track-marquee__text music-track-sync">Nome da M√∫sica</span>
                    <span class="music-track-marquee__text music-track-marquee__text--clone" aria-hidden="true"></span>
                  </div>
                </div>
              </div>
              <div class="music-artist music-artist-sync">Nome do Artista</div>
            </div>

            <div class="music-controls">
              <div class="tv-playback-controls">
                <button class="tv-btn-icon-small" aria-label="Previous" id="music-prev" data-device-id="29">
                  <img src="images/icons/icon-previous-track.svg" alt="Prev">
                </button>
                <button class="tv-btn-icon-small music-play-toggle" aria-label="Tocar/Pausar" id="music-play-toggle" aria-pressed="false" data-device-id="29">
                  <img src="images/icons/icon-play.svg" alt="Play" class="music-play-toggle__icon music-play-toggle__icon--play">
                  <img src="images/icons/icon-pause.svg" alt="Pause" class="music-play-toggle__icon music-play-toggle__icon--pause">
                </button>
                <button class="tv-btn-icon-small" aria-label="Next" id="music-next" data-device-id="29">
                  <img src="images/icons/icon-next-track.svg" alt="Next">
                </button>
              </div>
            </div>

            <div class="music-volume-section">
              <button class="music-volume-mute-btn" id="music-mute" aria-label="Mute" aria-pressed="false" data-device-id="216,217">
                <img src="images/icons/icon-volume.svg" alt="Volume" class="volume-icon-unmuted">
                <img src="images/icons/icon-mute.svg" alt="Mute" class="volume-icon-muted" style="display:none;">
              </button>
              <div class="music-volume-slider-container">
                <input type="range" min="0" max="100" value="50" class="music-volume-slider" id="music-volume-slider" aria-label="Volume" data-device-id="216,217">
              </div>
            </div>

            <div class="music-master-controls">
              <button class="music-master-btn music-master-btn--on music-master-btn--active" id="music-master-on" aria-label="Ligar" aria-pressed="true" data-device-id="216,217">Ligar</button>
              <button class="music-master-btn music-master-btn--off" id="music-master-off" aria-label="Desligar" aria-pressed="false" data-device-id="216,217">Desligar</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>

    `,

        "ambiente2-musica": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente2-page ambiente2-musica-page">

  <div class="page-header">
    <button class="back-btn" onclick="spaNavigate('ambiente2')">
      <img src="images/icons/back-button.svg" alt="Voltar">
    </button>
    <h1 class="page-title">Living, M√∫sica</h1>
  </div>

  <div class="ambiente2-musica-wrapper ambiente-grid">
    <div class="ambiente1-luzes-wrapper ambiente-grid lights-loading">
      <div class="music-player-inner">
    <div class="ambiente2-luzes-wrapper ambiente-grid lights-loading">
          <div class="music-primary">
    <div class="ambiente3-luzes-wrapper ambiente-grid lights-loading">
              <img class="music-album-img" src="images/optimized/photo-living-720.webp" alt="Capa do √°lbum" loading="lazy" decoding="async" width="720" height="540">
    <div class="ambiente4-luzes-wrapper ambiente-grid lights-loading">

    <div class="ambiente5-luzes-wrapper ambiente-grid lights-loading">
              <div class="music-track">
    <div class="ambiente6-luzes-wrapper ambiente-grid lights-loading">
                  <div class="music-track-marquee__inner">
    <div class="ambiente7-luzes-wrapper ambiente-grid lights-loading">
                    <span class="music-track-marquee__text music-track-marquee__text--clone" aria-hidden="true"></span>
    <div class="ambiente8-luzes-wrapper ambiente-grid lights-loading">
                </div>
    <div class="ambiente9-luzes-wrapper ambiente-grid lights-loading">
              <div class="music-artist" id="music-artist">Nome do Artista</div>
            </div>
          </div>

          <div class="music-secondary">
            <div class="music-info music-info--desktop">
              <div class="music-track">
                <div class="music-track-marquee">
                  <div class="music-track-marquee__inner">
                    <span class="music-track-marquee__text music-track-sync">Nome da M√∫sica</span>
                    <span class="music-track-marquee__text music-track-marquee__text--clone" aria-hidden="true"></span>
                  </div>
                </div>
              </div>
              <div class="music-artist music-artist-sync">Nome do Artista</div>
            </div>

            <div class="music-controls">
              <div class="tv-playback-controls">
                <button class="tv-btn-icon-small" aria-label="Previous" id="music-prev" data-device-id="29">
                  <img src="images/icons/icon-previous-track.svg" alt="Faixa anterior">
                </button>
                <button class="tv-btn-icon-small music-play-toggle" aria-label="Tocar/Pausar" id="music-play-toggle" aria-pressed="false" data-device-id="29">
                  <img src="images/icons/icon-play.svg" alt="Tocar" class="music-play-toggle__icon music-play-toggle__icon--play">
                  <img src="images/icons/icon-pause.svg" alt="Pausar" class="music-play-toggle__icon music-play-toggle__icon--pause">
                </button>
                <button class="tv-btn-icon-small" aria-label="Next" id="music-next" data-device-id="29">
                  <img src="images/icons/icon-next-track.svg" alt="Pr√≥xima faixa">
                </button>
              </div>
            </div>

            <div class="music-volume-section">
              <button class="music-volume-mute-btn" id="music-mute" aria-label="Mute" aria-pressed="false" data-device-id="29">
                <img src="images/icons/icon-volume.svg" alt="Volume" class="volume-icon-unmuted">
                <img src="images/icons/icon-mute.svg" alt="Mute" class="volume-icon-muted" style="display:none;">
              </button>
              <div class="music-volume-slider-container">
                <input type="range" min="0" max="100" value="50" class="music-volume-slider" id="music-volume-slider" aria-label="Volume" data-device-id="29">
              </div>
            </div>

            <div class="music-master-controls">
              <button class="music-master-btn music-master-btn--on music-master-btn--active" id="music-master-on" aria-label="Ligar" aria-pressed="true" data-device-id="29">Ligar</button>
              <button class="music-master-btn music-master-btn--off" id="music-master-off" aria-label="Desligar" aria-pressed="false" data-device-id="29">Desligar</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>

    `,

        "ambiente3-musica": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente3-page ambiente3-musica-page">

  <div class="page-header">
    <button class="back-btn" onclick="spaNavigate('ambiente3')">
      <img src="images/icons/back-button.svg" alt="Voltar">
    </button>
    <h1 class="page-title">Piscina, M√∫sica</h1>
  </div>

  <div class="ambiente3-musica-wrapper ambiente-grid">
    <div class="control-card control-card--full-width music-player-card" data-metadata-device-id="29">
      <div class="music-player-inner">
        <div class="music-player-content">
          <div class="music-primary">
            <div class="music-album">
              <img class="music-album-img" src="images/optimized/photo-piscina-720.webp" alt="Capa do √°lbum" loading="lazy" decoding="async" width="720" height="540">
            </div>

            <div class="music-info">
              <div class="music-track">
                <div class="music-track-marquee">
                  <div class="music-track-marquee__inner">
                    <span class="music-track-marquee__text" id="music-track">Nome da M√∫sica</span>
                    <span class="music-track-marquee__text music-track-marquee__text--clone" aria-hidden="true"></span>
                  </div>
                </div>
              </div>
              <div class="music-artist" id="music-artist">Nome do Artista</div>
            </div>
          </div>

          <div class="music-secondary">
            <div class="music-info music-info--desktop">
              <div class="music-track">
                <div class="music-track-marquee">
                  <div class="music-track-marquee__inner">
                    <span class="music-track-marquee__text music-track-sync">Nome da M√∫sica</span>
                    <span class="music-track-marquee__text music-track-marquee__text--clone" aria-hidden="true"></span>
                  </div>
                </div>
              </div>
              <div class="music-artist music-artist-sync">Nome do Artista</div>
            </div>

            <div class="music-controls">
              <div class="tv-playback-controls">
                <button class="tv-btn-icon-small" aria-label="Previous" id="music-prev" data-device-id="29">
                  <img src="images/icons/icon-previous-track.svg" alt="Faixa anterior">
                </button>
                <button class="tv-btn-icon-small music-play-toggle" aria-label="Tocar/Pausar" id="music-play-toggle" aria-pressed="false" data-device-id="29">
                  <img src="images/icons/icon-play.svg" alt="Tocar" class="music-play-toggle__icon music-play-toggle__icon--play">
                  <img src="images/icons/icon-pause.svg" alt="Pausar" class="music-play-toggle__icon music-play-toggle__icon--pause">
                </button>
                <button class="tv-btn-icon-small" aria-label="Next" id="music-next" data-device-id="29">
                  <img src="images/icons/icon-next-track.svg" alt="Pr√≥xima faixa">
                </button>
              </div>
            </div>

            <div class="music-volume-section">
              <button class="music-volume-mute-btn" id="music-mute" aria-label="Mute" aria-pressed="false" data-device-id="15">
                <img src="images/icons/icon-volume.svg" alt="Volume" class="volume-icon-unmuted">
                <img src="images/icons/icon-mute.svg" alt="Mute" class="volume-icon-muted" style="display:none;">
              </button>
              <div class="music-volume-slider-container">
                <input type="range" min="0" max="100" value="50" class="music-volume-slider" id="music-volume-slider" aria-label="Volume" data-device-id="15">
              </div>
            </div>

            <div class="music-master-controls">
              <button class="music-master-btn music-master-btn--on music-master-btn--active" id="music-master-on" aria-label="Ligar" aria-pressed="true" data-device-id="15">Ligar</button>
              <button class="music-master-btn music-master-btn--off" id="music-master-off" aria-label="Desligar" aria-pressed="false" data-device-id="15">Desligar</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>

    `,

        scenes: () => `

          <div class="top-bar-custom"></div>

           <main class="container">

            <div class="page active scene-page" data-page="scenes">

              <h1 class="page-title fixed-header" style="display:flex;justify-content:center;align-items:center;">

                <button class="app-logo-trigger" type="button" aria-label="Abrir informacoes do aplicativo">

                  <img class="logo-round" src="images/icons/icon-longping.png" alt="Dashboard LongPing" />

                </button>

              </h1>

              <div class="scene-page-content">

                <section class="scene-section scene-section--general">
                  <div class="scene-section-header">
                    <h2 class="scene-section-title">
                      <span>${typeof translateText === 'function' ? translateText('Fluxos Principais') : 'Fluxos Principais'}</span>
                      <span class="scene-section-line" aria-hidden="true"></span>
                    </h2>
                  </div>
                  <div class="scene-card-grid scene-card-grid--general">
                    <div class="control-card large scene-control-card" id="cenario-inicializar-btn" onclick="handleCenarioInicializar()">
                      <img class="control-icon" src="images/icons/icon-sun.svg" alt="${typeof translateText === 'function' ? translateText('Inicializar') : 'Inicializar'}">
                      <div class="control-label">${typeof translateText === 'function' ? translateText('Inicializar') : 'Inicializar'}</div>
                    </div>
                    <div class="control-card large scene-control-card" id="cenario-dormir-btn" onclick="handleCenarioDormir()">
                      <img class="control-icon" src="images/icons/Encerrar-expediente.svg" alt="${typeof translateText === 'function' ? translateText('Finaliza√ß√£o') : 'Finaliza√ß√£o'}">
                      <div class="control-label">${typeof translateText === 'function' ? translateText('Finaliza√ß√£o') : 'Finaliza√ß√£o'}</div>
                    </div>
                  </div>
                </section>

                <section class="scene-section scene-section--environments">
                  <div class="scene-section-header">
                    <h2 class="scene-section-title">
                      <span>${typeof translateText === 'function' ? translateText('Ambientes') : 'Ambientes'}</span>
                      <span class="scene-section-line" aria-hidden="true"></span>
                    </h2>
                  </div>
                  <div class="scene-card-grid scene-card-grid--environments" id="environment-scenes-grid">
                    <div class="scene-card-empty">${typeof translateText === 'function' ? translateText('Carregando cen√°rios...') : 'Carregando cen√°rios...'}</div>
                  </div>
                </section>

              </div>

            </div>

          </main>

        `,

        home: () => `

            <div class="top-bar-custom"></div>

            <main class="container">

                <div class="page active" id="home-page">

                    <h1 class="page-title fixed-header" style="display:flex;justify-content:center;align-items:center;">

                        <button class="app-logo-trigger" type="button" aria-label="Abrir informacoes do aplicativo">

                            <img class="logo-round" src="images/icons/icon-longping.png" alt="Dashboard LongPing" />

                        </button>

                    </h1>

                    <div class="rooms-frame">

                        <div class="rooms-list"></div>

                    </div>

                </div>

            </main>

        `,

        "ambiente1-tv": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente1-page ambiente1-tv-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente1')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Controle TV</h1>
    </div>

    <div class="tv-control-wrapper">
        
        <!-- COLUNA 1 -->
        <div class="tv-controls-col tv-col-1">
            <!-- BLOCO 1: ON/OFF -->
            <div class="tv-control-section">
                <header class="tv-section-header">
                    <h3 class="tv-section-title">On / Off</h3>
                    <div class="tv-section-line"></div>
                </header>
                <div class="tv-control-group tv-power-group">
          <button class="tv-btn tv-btn--power-on" onclick="tvMacroOn()" aria-label="Ligar">
            ON
          </button>
          <button class="tv-btn tv-btn--power-off" onclick="tvMacroOff()" aria-label="Desligar">
            OFF
          </button>
                </div>
            </div>

            <!-- BLOCO 4 E 5: VOLUME E CANAIS (lado a lado) -->
            <div class="tv-volume-canais-wrapper">
                
                <!-- BLOCO 4: VOLUME -->
                <div class="tv-control-section">
                    <header class="tv-section-header">
                        <h3 class="tv-section-title">Volume</h3>
                        <span class="tv-volume-value" id="tv-volume-display">50</span>
                        <div class="tv-section-line"></div>
                    </header>
                    <div class="tv-control-group tv-volume-slider-container">
                        <input 
                            type="range" 
                            class="tv-volume-slider" 
                            id="tv-volume-slider"
                            min="0" 
                            max="100" 
                            value="50"
                            data-device-id="15"
                            aria-label="Controle de Volume"
                        >
                    </div>
                </div>

                <!-- BLOCO 5: CANAIS -->
                <div class="tv-control-section">
                    <header class="tv-section-header">
                        <h3 class="tv-section-title">Canais</h3>
                        <div class="tv-section-line"></div>
                    </header>
                    <div class="tv-control-group tv-volume-channels-inline">
                        
                        <!-- Coluna Canais -->
                        <div class="tv-channels-column">
                            <div class="tv-channels-buttons">
                <button class="tv-btn-square" onclick="tvCommand(this, 'channelDown')" data-device-id="111" aria-label="Canal +">
                                    <img src="images/icons/arrow-up.svg" alt="Canal +" class="tv-btn-icon-img">
                                </button>
                <button class="tv-btn-square" onclick="tvCommand(this, 'channelUp')" data-device-id="111" aria-label="Canal -">
                                    <img src="images/icons/arrow-down.svg" alt="Canal -" class="tv-btn-icon-img">
                                </button>
                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>

        <!-- COLUNA 2 -->
        <div class="tv-controls-col tv-col-2">
            <!-- BLOCO 3: COMANDOS (Back, Menu, Home, Mute) -->
            <div class="tv-control-section">
                <header class="tv-section-header">
                    <h3 class="tv-section-title">Comandos</h3>
                    <div class="tv-section-line"></div>
                </header>
                <div class="tv-control-group tv-commands-grid">
                    <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'returnButton')" data-device-id="111" aria-label="Voltar">
                        <img src="images/icons/back-button.svg" alt="Voltar">
                    </button>
                    <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'hdmi2')" data-device-id="111" aria-label="Menu">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="3" y1="12" x2="21" y2="12"></line>
                            <line x1="3" y1="6" x2="21" y2="6"></line>
                            <line x1="3" y1="18" x2="21" y2="18"></line>
                        </svg>
                    </button>
                    <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'mute')" data-device-id="111" aria-label="Mudo">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                            <line x1="23" y1="9" x2="17" y2="15"></line>
                            <line x1="17" y1="9" x2="23" y2="15"></line>
                        </svg>
                    </button>
                    <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'home')" data-device-id="111" aria-label="Home">
                        <img src="images/icons/icon-home.svg" alt="Home">
                    </button>
                </div>
            </div>

            <!-- BLOCO 2: CONTROLE (D-PAD) -->
            <div class="tv-control-section">
                <header class="tv-section-header">
                    <h3 class="tv-section-title">Controle</h3>
                    <div class="tv-section-line"></div>
                </header>
                <div class="tv-control-group tv-directional-row">
                    <div class="tv-directional-section">
                        <div class="tv-directional-pad">
                            <!-- Linha 1: UP -->
                            <button class="tv-directional-btn tv-directional-btn--up" onclick="tvCommand(this, 'cursorUp')" data-device-id="111" aria-label="Cima">
                                <img src="images/icons/arrow-up.svg" alt="Cima" class="tv-btn-icon-img">
                            </button>
                            
                            <!-- Linha 2: LEFT, OK, RIGHT -->
                            <div class="tv-directional-row-line">
                                <button class="tv-directional-btn tv-directional-btn--left" onclick="tvCommand(this, 'cursorLeft')" data-device-id="111" aria-label="Esquerda">
                                    <img src="images/icons/arrow-left.svg" alt="Esquerda" class="tv-btn-icon-img">
                                </button>
                                <button class="tv-directional-btn tv-directional-btn--ok" onclick="tvCommand(this, 'cursorCenter')" data-device-id="111" aria-label="OK">
                                    <div class="tv-ok-circle"></div>
                                </button>
                                <button class="tv-directional-btn tv-directional-btn--right" onclick="tvCommand(this, 'cursorRight')" data-device-id="111" aria-label="Direita">
                                    <img src="images/icons/arrow-right.svg" alt="Direita" class="tv-btn-icon-img">
                                </button>
                            </div>
                            
                            <!-- Linha 3: DOWN -->
                            <button class="tv-directional-btn tv-directional-btn--down" onclick="tvCommand(this, 'cursorDown')" data-device-id="111" aria-label="Baixo">
                                <img src="images/icons/arrow-down.svg" alt="Baixo" class="tv-btn-icon-img">
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- COLUNA 3 -->
        <div class="tv-controls-col tv-col-3">
            <!-- BLOCO 6: N√öMEROS -->
            <div class="tv-control-section">
                <header class="tv-section-header">
                    <h3 class="tv-section-title">N√∫meros</h3>
                    <div class="tv-section-line"></div>
                </header>
                <div class="tv-control-group">
                    <div class="tv-numpad">
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num1')" data-device-id="111" aria-label="1">1</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num2')" data-device-id="111" aria-label="2">2</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num3')" data-device-id="111" aria-label="3">3</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num4')" data-device-id="111" aria-label="4">4</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num5')" data-device-id="111" aria-label="5">5</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num6')" data-device-id="111" aria-label="6">6</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num7')" data-device-id="111" aria-label="7">7</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num8')" data-device-id="111" aria-label="8">8</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num9')" data-device-id="111" aria-label="9">9</button>
                        <button class="tv-numpad-btn tv-numpad-btn--icon" onclick="tvCommand(this, 'returnButton')" data-device-id="111" aria-label="Voltar">
                            <img src="images/icons/back-button.svg" alt="Back">
                        </button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num0')" data-device-id="111" aria-label="0">0</button>
                        <button class="tv-numpad-btn tv-numpad-btn--icon" onclick="fireTVMacro()" aria-label="Fire TV">
                            <img src="images/icons/icon-firetv.svg" alt="Fire TV">
                        </button>
                    </div>
                </div>
            </div>

            <!-- BLOCO 7: LOGO ELETRIZE -->
            <div class="tv-control-section tv-logo-section">
                <img src="images/icons/eletrize.svg" alt="Eletrize" class="tv-eletrize-logo">
            </div>
        </div>

    </div>

</div>

        `,
        ambiente2: () => {
          const envName = getTranslatedEnvName('ambiente2', 'Circula√ß√£o');
          return `
<div class="top-bar-custom"></div>

<div class="page active page-container ambiente2-page">

    <div class="page-header">

        <button class="back-btn" onclick="spaNavigate('home')"><img src="images/icons/back-button.svg" alt="Voltar"></button>

        <h1 class="page-title">${envName}</h1>

    </div>

    

    <div class="ambiente2-controls-wrapper ambiente-grid">
        ${generateFeatureButtons('ambiente2')}
    </div>

</div>
          `;
        },

        "ambiente2-luzes": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente2-page ambiente2-luzes-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente2')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Ilumina√ß√£o</h1>
    </div>

    <div class="ambiente2-luzes-wrapper ambiente-grid">
      <!-- Luzes geradas dinamicamente pelo config.js -->
    </div>

</div>

        `,

        "ambiente2-cortinas": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente2-page ambiente2-cortinas-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente2')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Cortinas</h1>
    </div>

    <div class="ambiente2-cortinas-wrapper ambiente2-cortinas-grid">
        <article class="curtain-tile curtain-tile--transparent" data-device-id="119" data-environment="Circula√ß√£o">
            <header class="curtain-tile__header curtain-tile__header--minimal">
                <h3 class="curtain-tile__title">Cortina Lateral</h3>
                <div class="curtain-tile__line"></div>
            </header>
            <div class="curtain-tile__actions">
                <button class="curtain-tile__btn" data-device-id="119" onclick="curtainAction(this, 'open')" aria-label="Abrir Cortina Lateral">
                    <img src="images/icons/arrow-up.svg" alt="Abrir">
                </button>
                <button class="curtain-tile__btn" data-device-id="119" onclick="curtainAction(this, 'stop')" aria-label="Parar Cortina Lateral">
                    <img src="images/icons/icon-stop.svg" alt="Parar">
                </button>
                <button class="curtain-tile__btn" data-device-id="119" onclick="curtainAction(this, 'close')" aria-label="Fechar Cortina Lateral">
                    <img src="images/icons/arrow-down.svg" alt="Fechar">
                </button>
            </div>
        </article>
    </div>

</div>

        `,

        "ambiente2-conforto": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente2-page ambiente2-conforto-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente2')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
    </div>

    <div class="ac-page-wrapper">
        <main class="ac-container" data-component="ac-control" data-ac-circulacao="true">
            
            <!-- Display de Temperatura -->
            <section class="ac-temperature-section">
        <div class="ac-temperature-fade-content">
          <div class="ac-temperature-display">
            <div class="ac-temp-wrapper">
              <!-- SVG para o arco de progresso -->
              <svg class="ac-temp-arc" viewBox="0 0 200 120" preserveAspectRatio="xMidYMid meet">
                <!-- Arco de fundo -->
                <path class="ac-temp-arc-bg" d="M 20,100 A 80,80 0 0,1 180,100" fill="none" stroke-width="8"/>
                <!-- Arco de progresso -->
                <path class="ac-temp-arc-progress" d="M 20,100 A 80,80 0 0,1 180,100" fill="none" stroke-width="8" data-role="progress-ring"/>
              </svg>
              <!-- Display do valor em lista -->
              <div class="ac-temp-display">
                <div class="ac-temp-list">
                  <div class="ac-temp-prev" data-role="temp-prev">21</div>
                  <div class="ac-temp-current" data-role="temp-current">22</div>
                  <div class="ac-temp-next" data-role="temp-next">23</div>
                </div>
              </div>
              <!-- Knob arrast√°vel -->
              <div class="ac-temp-knob-wrapper" data-role="knob">
                <div class="ac-temp-knob">
                  <div class="ac-temp-knob-dot"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
            </section>

            <!-- Wrapper para os controles (Sele√ß√£o, Aletas, Comandos) -->
            <div class="ac-controls-wrapper">
                <!-- Controles de Sele√ß√£o -->
                <section class="ac-modes" role="group" aria-label="Sele√ß√£o de ar-condicionado">
                    <h2 class="ac-section-title">Sele√ß√£o</h2>
                    <div class="ac-modes-grid ac-modes-grid--triple">
                        <button type="button" class="ac-mode-btn ac-mode-btn--selection" data-mode-button data-mode="circulacao" aria-pressed="false" aria-label="AC I">
                            <span class="ac-mode-btn__label">I</span>
                        </button>
                        <button type="button" class="ac-mode-btn ac-mode-btn--selection" data-mode-button data-mode="circulacao2" aria-pressed="false" aria-label="AC II">
                            <span class="ac-mode-btn__label">II</span>
                        </button>
                        <button type="button" class="ac-mode-btn ac-mode-btn--selection" data-mode-button data-mode="circulacaoBoth" aria-pressed="false" aria-label="Ambos ACs">
                            <span class="ac-mode-btn__label">Ambos</span>
                        </button>
                    </div>
                </section>

                <!-- Controles de Aletas -->
                <section class="ac-aleta-section" role="group" aria-label="Controle das aletas">
                    <h2 class="ac-section-title">Aletas</h2>
                    <div class="ac-aleta-grid ac-aleta-grid--dual">
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="moving" aria-pressed="true" aria-label="Aletas em movimento">
                <img src="images/icons/icon-ac-aleta-moving.svg" alt="">
              </button>
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="parada" aria-pressed="false" aria-label="Aletas paradas">
                <img src="images/icons/icon-ac-aleta-parada.svg" alt="">
              </button>
                    </div>
                </section>

                <!-- Comandos -->
                <section class="ac-commands-section">
                    <h3 class="ac-section-title">Comandos</h3>
                    <div class="ac-commands-grid">
                        <button type="button" class="ac-command-btn ac-command-btn-large ac-command-btn--disabled" data-role="power" aria-pressed="false" aria-label="Ligar/Desligar ar-condicionado" disabled>
                            <img src="images/icons/icon-ac-power.svg" alt="">
                        </button>
                    </div>
                </section>
            </div>

            <span class="sr-only" role="status" aria-live="polite" data-role="temperature-live">Temperatura ajustada para 22 graus.</span>
        </main>
    </div>

</div>

        `,

        ambiente3: () => {
          const envName = getTranslatedEnvName('ambiente3', 'Imers√£o');
          return `
<div class="top-bar-custom"></div>

<div class="page active page-container ambiente3-page">

    <div class="page-header">

        <button class="back-btn" onclick="spaNavigate('home')"><img src="images/icons/back-button.svg" alt="Voltar"></button>

        <h1 class="page-title">${envName}</h1>

    </div>

    

    <div class="ambiente3-controls-wrapper ambiente-grid">
        ${generateFeatureButtons('ambiente3')}
    </div>

</div>
          `;
        },

        "ambiente3-luzes": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente3-page ambiente3-luzes-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente3')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Ilumina√ß√£o</h1>
    </div>

    <div class="ambiente3-luzes-wrapper ambiente-grid">
      <!-- Luzes geradas dinamicamente pelo config.js -->
    </div>

</div>

        `,

        "ambiente3-cortinas": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente3-page ambiente3-cortinas-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente3')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Cortinas</h1>
    </div>

    <div class="ambiente3-cortinas-wrapper">
        <!-- Cortina 1 -->
        <article class="curtain-tile curtain-tile--full-width curtain-tile--transparent" data-device-id="39" data-environment="Ambiente 3">
            <header class="curtain-tile__header curtain-tile__header--minimal">
                <h3 class="curtain-tile__title">Cortina 1</h3>
                <div class="curtain-tile__line"></div>
            </header>
            <div class="curtain-tile__actions">
                <button class="curtain-tile__btn" data-device-id="39" onclick="curtainAction(this, 'open')" aria-label="Abrir Cortina 1">
                    <img src="images/icons/arrow-left.svg" alt="Abrir">
                </button>
                <button class="curtain-tile__btn" data-device-id="39" onclick="curtainAction(this, 'stop')" aria-label="Parar Cortina 1">
                    <img src="images/icons/icon-stop.svg" alt="Parar">
                </button>
                <button class="curtain-tile__btn" data-device-id="39" onclick="curtainAction(this, 'close')" aria-label="Fechar Cortina 1">
                    <img src="images/icons/arrow-right.svg" alt="Fechar">
                </button>
            </div>
        </article>
    </div>

</div>

        `,

        "ambiente3-conforto": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente3-page ambiente3-conforto-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente3')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
    </div>

    <div class="ac-page-wrapper">
        <main class="ac-container" data-component="ac-control">
            
            <!-- Display de Temperatura -->
            <section class="ac-temperature-section">
        <h2 class="ac-section-title">Temperatura</h2>
        <div class="ac-temperature-fade-content">
          <div class="ac-temperature-display">
            <div class="ac-temp-wrapper">
              <!-- SVG para o arco de progresso -->
              <svg class="ac-temp-arc" viewBox="0 0 200 120" preserveAspectRatio="xMidYMid meet">
                <!-- Arco de fundo -->
                <path class="ac-temp-arc-bg" d="M 20,100 A 80,80 0 0,1 180,100" fill="none" stroke-width="8"/>
                <!-- Arco de progresso -->
                <path class="ac-temp-arc-progress" d="M 20,100 A 80,80 0 0,1 180,100" fill="none" stroke-width="8" data-role="progress-ring"/>
              </svg>
              <!-- Display do valor em lista -->
              <div class="ac-temp-display">
                <div class="ac-temp-list">
                  <div class="ac-temp-prev" data-role="temp-prev">21</div>
                  <div class="ac-temp-current" data-role="temp-current">22</div>
                  <div class="ac-temp-next" data-role="temp-next">23</div>
                </div>
              </div>
              <!-- Knob arrast√°vel -->
              <div class="ac-temp-knob-wrapper" data-role="knob">
                <div class="ac-temp-knob">
                  <div class="ac-temp-knob-dot"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
            </section>

            <!-- Wrapper para os controles (Sele√ß√£o, Aletas, Comandos) -->
            <div class="ac-controls-wrapper">
                <!-- Controles de Sele√ß√£o -->
                <section class="ac-modes" role="group" aria-label="Sele√ß√£o de ar-condicionado">
                    <h2 class="ac-section-title">Sele√ß√£o</h2>
                    <div class="ac-modes-grid ac-modes-grid--single">
                        <button type="button" class="ac-mode-btn ac-mode-btn--selection" data-mode-button data-mode="imersao" aria-pressed="true" aria-label="Imers√£o">
                            <span class="ac-mode-btn__label">Imers√£o</span>
                        </button>
                    </div>
                </section>

                <!-- Controles de Aletas -->
                <section class="ac-aleta-section" role="group" aria-label="Controle das aletas">
                    <h2 class="ac-section-title">Aletas</h2>
                    <div class="ac-aleta-grid">
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="moving" aria-pressed="true" aria-label="Aletas em movimento">
                <img src="images/icons/icon-ac-aleta-moving.svg" alt="">
              </button>
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="windfree" aria-pressed="false" aria-label="WindFree">
                <img src="images/icons/icon-windfree.svg" alt="">
              </button>
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="parada" aria-pressed="false" aria-label="Aletas paradas">
                <img src="images/icons/icon-ac-aleta-parada.svg" alt="">
              </button>
                    </div>
                </section>

                <!-- Comandos -->
                <section class="ac-commands-section">
                    <h3 class="ac-section-title">Comandos</h3>
                    <div class="ac-commands-grid">
                        <button type="button" class="ac-command-btn ac-command-btn-large" data-role="power" aria-pressed="true" aria-label="Ligar/Desligar ar-condicionado">
                            <img src="images/icons/icon-ac-power.svg" alt="">
                        </button>
                    </div>
                </section>
            </div>

            <span class="sr-only" role="status" aria-live="polite" data-role="temperature-live">Temperatura ajustada para 22 graus.</span>
        </main>
    </div>

</div>

        `,

        "ambiente4-luzes": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente4-page ambiente4-luzes-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente4')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Ilumina√ß√£o</h1>
    </div>

    <div class="ambiente4-luzes-wrapper ambiente-grid">
      <!-- Luzes geradas dinamicamente pelo config.js -->
    </div>

</div>

        `,

        "ambiente4-cortinas": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente4-page ambiente4-cortinas-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente4')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Cortinas</h1>
    </div>

    <div class="ambiente4-cortinas-wrapper">
        <!-- Cortina 1 -->
        <article class="curtain-tile curtain-tile--full-width curtain-tile--transparent" data-device-id="35" data-environment="Ambiente 4">
            <header class="curtain-tile__header curtain-tile__header--minimal">
                <h3 class="curtain-tile__title">Cortina 1</h3>
                <div class="curtain-tile__line"></div>
            </header>
            <div class="curtain-tile__actions">
                <button class="curtain-tile__btn" data-device-id="35" onclick="curtainAction(this, 'open')" aria-label="Abrir Cortina 1">
                    <img src="images/icons/arrow-up.svg" alt="Abrir">
                </button>
                <button class="curtain-tile__btn" data-device-id="35" onclick="curtainAction(this, 'stop')" aria-label="Parar Cortina 1">
                    <img src="images/icons/icon-stop.svg" alt="Parar">
                </button>
                <button class="curtain-tile__btn" data-device-id="35" onclick="curtainAction(this, 'close')" aria-label="Fechar Cortina 1">
                    <img src="images/icons/arrow-down.svg" alt="Fechar">
                </button>
            </div>
        </article>
    </div>

</div>

        `,

        "ambiente4-conforto": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente4-page ambiente4-conforto-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente4')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
    </div>

    <div class="ac-page-wrapper">
        <main class="ac-container" data-component="ac-control">
            
            <!-- Display de Temperatura -->
            <section class="ac-temperature-section">
        <h2 class="ac-section-title">Temperatura</h2>
        <div class="ac-temperature-fade-content">
          <div class="ac-temperature-display">
            <div class="ac-temp-wrapper">
              <!-- SVG para o arco de progresso -->
              <svg class="ac-temp-arc" viewBox="0 0 200 120" preserveAspectRatio="xMidYMid meet">
                <!-- Arco de fundo -->
                <path class="ac-temp-arc-bg" d="M 20,100 A 80,80 0 0,1 180,100" fill="none" stroke-width="8"/>
                <!-- Arco de progresso -->
                <path class="ac-temp-arc-progress" d="M 20,100 A 80,80 0 0,1 180,100" fill="none" stroke-width="8" data-role="progress-ring"/>
              </svg>
              <!-- Display do valor em lista -->
              <div class="ac-temp-display">
                <div class="ac-temp-list">
                  <div class="ac-temp-prev" data-role="temp-prev">21</div>
                  <div class="ac-temp-current" data-role="temp-current">22</div>
                  <div class="ac-temp-next" data-role="temp-next">23</div>
                </div>
              </div>
              <!-- Knob arrast√°vel -->
              <div class="ac-temp-knob-wrapper" data-role="knob">
                <div class="ac-temp-knob">
                  <div class="ac-temp-knob-dot"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
            </section>

            <!-- Wrapper para os controles (Modo, Aletas, Comandos) -->
            <div class="ac-controls-wrapper">
                <!-- Controles de Modo -->
                <section class="ac-modes" role="group" aria-label="Modos de opera√ß√£o">
                    <h2 class="ac-section-title">Modo</h2>
                    <div class="ac-modes-grid">
                        <button type="button" class="ac-mode-btn" data-mode-button data-mode="cool" aria-pressed="true" aria-label="Modo resfriar">
                            <img src="images/icons/icon-ac-cool.svg" alt="">
                        </button>
                        <button type="button" class="ac-mode-btn" data-mode-button data-mode="heat" aria-pressed="false" aria-label="Modo aquecer">
                            <img src="images/icons/icon-ac-heat.svg" alt="">
                        </button>
                    </div>
                </section>

                <!-- Controles de Aletas -->
                <section class="ac-aleta-section" role="group" aria-label="Controle das aletas">
                    <h2 class="ac-section-title">Aletas</h2>
                    <div class="ac-aleta-grid">
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="moving" aria-pressed="true" aria-label="Aletas em movimento">
                <img src="images/icons/icon-ac-aleta-moving.svg" alt="">
              </button>
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="windfree" aria-pressed="false" aria-label="WindFree">
                <img src="images/icons/icon-windfree.svg" alt="">
              </button>
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="parada" aria-pressed="false" aria-label="Aletas paradas">
                <img src="images/icons/icon-ac-aleta-parada.svg" alt="">
              </button>
                    </div>
                </section>

                <!-- Comandos -->
                <section class="ac-commands-section">
                    <h3 class="ac-section-title">Comandos</h3>
                    <div class="ac-commands-grid">
                        <button type="button" class="ac-command-btn ac-command-btn-large" data-role="power" aria-pressed="true" aria-label="Ligar/Desligar ar-condicionado">
                            <img src="images/icons/icon-ac-power.svg" alt="">
                        </button>
                    </div>
                </section>
            </div>

            <span class="sr-only" role="status" aria-live="polite" data-role="temperature-live">Temperatura ajustada para 22 graus.</span>
        </main>
    </div>

</div>

        `,

        "ambiente5-luzes": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente5-page ambiente5-luzes-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente5')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Ilumina√ß√£o</h1>
    </div>

    <div class="ambiente5-luzes-wrapper ambiente-grid">
      <!-- Luzes geradas dinamicamente pelo config.js -->
    </div>

</div>

        `,

        "ambiente5-cortinas": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente5-page ambiente5-cortinas-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente5')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Cortinas</h1>
    </div>

    <div class="ambiente5-cortinas-wrapper">
        <!-- Cortina 1 -->
        <article class="curtain-tile curtain-tile--full-width curtain-tile--transparent" data-device-id="38" data-environment="Ambiente 5">
            <header class="curtain-tile__header curtain-tile__header--minimal">
                <h3 class="curtain-tile__title">Cortina 1</h3>
                <div class="curtain-tile__line"></div>
            </header>
            <div class="curtain-tile__actions">
                <button class="curtain-tile__btn" data-device-id="38" onclick="curtainAction(this, 'open')" aria-label="Abrir Cortina 1">
                    <img src="images/icons/arrow-up.svg" alt="Abrir">
                </button>
                <button class="curtain-tile__btn" data-device-id="38" onclick="curtainAction(this, 'stop')" aria-label="Parar Cortina 1">
                    <img src="images/icons/icon-stop.svg" alt="Parar">
                </button>
                <button class="curtain-tile__btn" data-device-id="38" onclick="curtainAction(this, 'close')" aria-label="Fechar Cortina 1">
                    <img src="images/icons/arrow-down.svg" alt="Fechar">
                </button>
            </div>
        </article>
    </div>

</div>

        `,

        "ambiente5-conforto": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente5-page ambiente5-conforto-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente5')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
    </div>

    <div class="ac-page-wrapper">
        <main class="ac-container" data-component="ac-control">
            
            <!-- Display de Temperatura -->
            <section class="ac-temperature-section">
        <h2 class="ac-section-title">Temperatura</h2>
        <div class="ac-temperature-fade-content">
          <div class="ac-temperature-display">
            <div class="ac-temp-wrapper">
              <!-- SVG para o arco de progresso -->
              <svg class="ac-temp-arc" viewBox="0 0 200 120" preserveAspectRatio="xMidYMid meet">
                <!-- Arco de fundo -->
                <path class="ac-temp-arc-bg" d="M 20,100 A 80,80 0 0,1 180,100" fill="none" stroke-width="8"/>
                <!-- Arco de progresso -->
                <path class="ac-temp-arc-progress" d="M 20,100 A 80,80 0 0,1 180,100" fill="none" stroke-width="8" data-role="progress-ring"/>
              </svg>
              <!-- Display do valor em lista -->
              <div class="ac-temp-display">
                <div class="ac-temp-list">
                  <div class="ac-temp-prev" data-role="temp-prev">21</div>
                  <div class="ac-temp-current" data-role="temp-current">22</div>
                  <div class="ac-temp-next" data-role="temp-next">23</div>
                </div>
              </div>
              <!-- Knob arrast√°vel -->
              <div class="ac-temp-knob-wrapper" data-role="knob">
                <div class="ac-temp-knob">
                  <div class="ac-temp-knob-dot"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
            </section>

            <!-- Wrapper para os controles (Modo, Aletas, Comandos) -->
            <div class="ac-controls-wrapper">
                <!-- Controles de Modo -->
                <section class="ac-modes" role="group" aria-label="Modos de opera√ß√£o">
                    <h2 class="ac-section-title">Modo</h2>
                    <div class="ac-modes-grid">
                        <button type="button" class="ac-mode-btn" data-mode-button data-mode="cool" aria-pressed="true" aria-label="Modo resfriar">
                            <img src="images/icons/icon-ac-cool.svg" alt="">
                        </button>
                        <button type="button" class="ac-mode-btn" data-mode-button data-mode="heat" aria-pressed="false" aria-label="Modo aquecer">
                            <img src="images/icons/icon-ac-heat.svg" alt="">
                        </button>
                    </div>
                </section>

                <!-- Controles de Aletas -->
                <section class="ac-aleta-section" role="group" aria-label="Controle das aletas">
                    <h2 class="ac-section-title">Aletas</h2>
                    <div class="ac-aleta-grid">
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="moving" aria-pressed="true" aria-label="Aletas em movimento">
                <img src="images/icons/icon-ac-aleta-moving.svg" alt="">
              </button>
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="windfree" aria-pressed="false" aria-label="WindFree">
                <img src="images/icons/icon-windfree.svg" alt="">
              </button>
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="parada" aria-pressed="false" aria-label="Aletas paradas">
                <img src="images/icons/icon-ac-aleta-parada.svg" alt="">
              </button>
                    </div>
                </section>

                <!-- Comandos -->
                <section class="ac-commands-section">
                    <h3 class="ac-section-title">Comandos</h3>
                    <div class="ac-commands-grid">
                        <button type="button" class="ac-command-btn ac-command-btn-large" data-role="power" aria-pressed="true" aria-label="Ligar/Desligar ar-condicionado">
                            <img src="images/icons/icon-ac-power.svg" alt="">
                        </button>
                    </div>
                </section>
            </div>

            <span class="sr-only" role="status" aria-live="polite" data-role="temperature-live">Temperatura ajustada para 22 graus.</span>
        </main>
    </div>

</div>

        `,

        "ambiente6-luzes": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente6-page ambiente6-luzes-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente6')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Ilumina√ß√£o</h1>
    </div>

    <div class="ambiente6-luzes-wrapper ambiente-grid">
      <!-- Luzes geradas dinamicamente pelo config.js -->
    </div>

</div>

        `,

        "ambiente6-cortinas": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente6-page ambiente6-cortinas-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente6')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Cortinas</h1>
    </div>

    <div class="ambiente6-cortinas-wrapper">
        <!-- Cortina 1 -->
        <article class="curtain-tile curtain-tile--full-width curtain-tile--transparent" data-device-id="49" data-environment="Ambiente 6">
            <header class="curtain-tile__header curtain-tile__header--minimal">
                <h3 class="curtain-tile__title">Cortina 1</h3>
                <div class="curtain-tile__line"></div>
            </header>
            <div class="curtain-tile__actions">
                <button class="curtain-tile__btn" data-device-id="49" onclick="curtainAction(this, 'open')" aria-label="Abrir Cortina 1">
                    <img src="images/icons/arrow-up.svg" alt="Abrir">
                </button>
                <button class="curtain-tile__btn" data-device-id="49" onclick="curtainAction(this, 'stop')" aria-label="Parar Cortina 1">
                    <img src="images/icons/icon-stop.svg" alt="Parar">
                </button>
                <button class="curtain-tile__btn" data-device-id="49" onclick="curtainAction(this, 'close')" aria-label="Fechar Cortina 1">
                    <img src="images/icons/arrow-down.svg" alt="Fechar">
                </button>
            </div>
        </article>
    </div>

</div>

        `,

        "ambiente6-conforto": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente6-page ambiente6-conforto-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente6')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
    </div>

    <div class="ac-page-wrapper">
        <main class="ac-container" data-component="ac-control">
            
            <!-- Display de Temperatura -->
            <section class="ac-temperature-section">
        <h2 class="ac-section-title">Temperatura</h2>
        <div class="ac-temperature-fade-content">
          <div class="ac-temperature-display">
            <div class="ac-temp-wrapper">
              <!-- SVG para o arco de progresso -->
              <svg class="ac-temp-arc" viewBox="0 0 200 120" preserveAspectRatio="xMidYMid meet">
                <!-- Arco de fundo -->
                <path class="ac-temp-arc-bg" d="M 20,100 A 80,80 0 0,1 180,100" fill="none" stroke-width="8"/>
                <!-- Arco de progresso -->
                <path class="ac-temp-arc-progress" d="M 20,100 A 80,80 0 0,1 180,100" fill="none" stroke-width="8" data-role="progress-ring"/>
              </svg>
              <!-- Display do valor em lista -->
              <div class="ac-temp-display">
                <div class="ac-temp-list">
                  <div class="ac-temp-prev" data-role="temp-prev">21</div>
                  <div class="ac-temp-current" data-role="temp-current">22</div>
                  <div class="ac-temp-next" data-role="temp-next">23</div>
                </div>
              </div>
              <!-- Knob arrast√°vel -->
              <div class="ac-temp-knob-wrapper" data-role="knob">
                <div class="ac-temp-knob">
                  <div class="ac-temp-knob-dot"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
            </section>

            <!-- Wrapper para os controles (Modo, Aletas, Comandos) -->
            <div class="ac-controls-wrapper">
                <!-- Controles de Modo -->
                <section class="ac-modes" role="group" aria-label="Modos de opera√ß√£o">
                    <h2 class="ac-section-title">Modo</h2>
                    <div class="ac-modes-grid">
                        <button type="button" class="ac-mode-btn" data-mode-button data-mode="cool" aria-pressed="true" aria-label="Modo resfriar">
                            <img src="images/icons/icon-ac-cool.svg" alt="">
                        </button>
                        <button type="button" class="ac-mode-btn" data-mode-button data-mode="heat" aria-pressed="false" aria-label="Modo aquecer">
                            <img src="images/icons/icon-ac-heat.svg" alt="">
                        </button>
                    </div>
                </section>

                <!-- Controles de Aletas -->
                <section class="ac-aleta-section" role="group" aria-label="Controle das aletas">
                    <h2 class="ac-section-title">Aletas</h2>
                    <div class="ac-aleta-grid">
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="moving" aria-pressed="true" aria-label="Aletas em movimento">
                <img src="images/icons/icon-ac-aleta-moving.svg" alt="">
              </button>
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="windfree" aria-pressed="false" aria-label="WindFree">
                <img src="images/icons/icon-windfree.svg" alt="">
              </button>
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="parada" aria-pressed="false" aria-label="Aletas paradas">
                <img src="images/icons/icon-ac-aleta-parada.svg" alt="">
              </button>
                    </div>
                </section>

                <!-- Comandos -->
                <section class="ac-commands-section">
                    <h3 class="ac-section-title">Comandos</h3>
                    <div class="ac-commands-grid">
                        <button type="button" class="ac-command-btn ac-command-btn-large" data-role="power" aria-pressed="true" aria-label="Ligar/Desligar ar-condicionado">
                            <img src="images/icons/icon-ac-power.svg" alt="">
                        </button>
                    </div>
                </section>
            </div>

            <span class="sr-only" role="status" aria-live="polite" data-role="temperature-live">Temperatura ajustada para 22 graus.</span>
        </main>
    </div>

</div>

        `,

        ambiente5: () => {
          const envName = getTranslatedEnvName('ambiente5', 'Brasil');
          return `
<div class="top-bar-custom"></div>

<div class="page active page-container ambiente5-page">

    <div class="page-header">

        <button class="back-btn" onclick="spaNavigate('home')"><img src="images/icons/back-button.svg" alt="Voltar"></button>

        <h1 class="page-title">${envName}</h1>

    </div>

    

    <div class="ambiente5-controls-wrapper ambiente-grid">
        ${generateFeatureButtons('ambiente5')}
    </div>

</div>
          `;
        },

        ambiente1: () => {
          const envName = getTranslatedEnvName('ambiente1', 'Pr√≥logo');
          return `
<div class="top-bar-custom"></div>

<div class="page active page-container ambiente1-page">

    <div class="page-header">

        <button class="back-btn" onclick="spaNavigate('home')"><img src="images/icons/back-button.svg" alt="Voltar"></button>

        <h1 class="page-title">${envName}</h1>

    </div>

    

    <div class="ambiente1-controls-wrapper ambiente-grid">
        ${generateFeatureButtons('ambiente1')}
    </div>

</div>
          `;
        },

        "ambiente1-luzes": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente1-page ambiente1-luzes-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente1')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Ilumina√ß√£o</h1>
    </div>

    <div class="ambiente1-luzes-wrapper ambiente-grid">
      <!-- Luzes geradas dinamicamente pelo config.js -->
    </div>

</div>

        `,

        "ambiente1-cortinas": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente1-page ambiente1-cortinas-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente1')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Cortinas</h1>
    </div>

    <div class="ambiente1-cortinas-wrapper ambiente1-cortinas-grid">
        <article class="curtain-tile curtain-tile--transparent" data-device-id="109" data-environment="Pr√≥logo">
            <header class="curtain-tile__header curtain-tile__header--minimal">
                <h3 class="curtain-tile__title">Todas</h3>
                <div class="curtain-tile__line"></div>
            </header>
            <div class="curtain-tile__actions">
                <button class="curtain-tile__btn" data-device-id="109" onclick="curtainAction(this, 'open')" aria-label="Abrir cortinas">
                    <img src="images/icons/arrow-up.svg" alt="Abrir">
                </button>
                <button class="curtain-tile__btn" data-device-id="109" onclick="curtainAction(this, 'stop')" aria-label="Parar cortinas">
                    <img src="images/icons/icon-stop.svg" alt="Parar">
                </button>
                <button class="curtain-tile__btn" data-device-id="109" onclick="curtainAction(this, 'close')" aria-label="Fechar cortinas">
                    <img src="images/icons/arrow-down.svg" alt="Fechar">
                </button>
            </div>
        </article>

        <article class="curtain-tile curtain-tile--transparent" data-device-id="115" data-environment="Pr√≥logo">
            <header class="curtain-tile__header curtain-tile__header--minimal">
                <h3 class="curtain-tile__title">Esquerda</h3>
                <div class="curtain-tile__line"></div>
            </header>
            <div class="curtain-tile__actions">
                <button class="curtain-tile__btn" data-device-id="115" onclick="curtainAction(this, 'open')" aria-label="Abrir cortina esquerda">
                    <img src="images/icons/arrow-up.svg" alt="Abrir">
                </button>
                <button class="curtain-tile__btn" data-device-id="115" onclick="curtainAction(this, 'stop')" aria-label="Parar cortina esquerda">
                    <img src="images/icons/icon-stop.svg" alt="Parar">
                </button>
                <button class="curtain-tile__btn" data-device-id="115" onclick="curtainAction(this, 'close')" aria-label="Fechar cortina esquerda">
                    <img src="images/icons/arrow-down.svg" alt="Fechar">
                </button>
            </div>
        </article>

        <article class="curtain-tile curtain-tile--transparent" data-device-id="116" data-environment="Pr√≥logo">
            <header class="curtain-tile__header curtain-tile__header--minimal">
                <h3 class="curtain-tile__title">Direita</h3>
                <div class="curtain-tile__line"></div>
            </header>
            <div class="curtain-tile__actions">
                <button class="curtain-tile__btn" data-device-id="116" onclick="curtainAction(this, 'open')" aria-label="Abrir cortina direita">
                    <img src="images/icons/arrow-up.svg" alt="Abrir">
                </button>
                <button class="curtain-tile__btn" data-device-id="116" onclick="curtainAction(this, 'stop')" aria-label="Parar cortina direita">
                    <img src="images/icons/icon-stop.svg" alt="Parar">
                </button>
                <button class="curtain-tile__btn" data-device-id="116" onclick="curtainAction(this, 'close')" aria-label="Fechar cortina direita">
                    <img src="images/icons/arrow-down.svg" alt="Fechar">
                </button>
            </div>
        </article>
    </div>

</div>

        `,

        "ambiente1-conforto": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente1-page ambiente1-conforto-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente1')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
    </div>

    <div class="ac-page-wrapper">
        <main class="ac-container" data-component="ac-control">
            
            <!-- Display de Temperatura -->
            <section class="ac-temperature-section">
        <div class="ac-temperature-fade-content">
          <div class="ac-temperature-display">
            <div class="ac-temp-wrapper">
              <!-- SVG para o arco de progresso -->
              <svg class="ac-temp-arc" viewBox="0 0 200 120" preserveAspectRatio="xMidYMid meet">
                <!-- Arco de fundo -->
                <path class="ac-temp-arc-bg" d="M 20,100 A 80,80 0 0,1 180,100" fill="none" stroke-width="8"/>
                <!-- Arco de progresso -->
                <path class="ac-temp-arc-progress" d="M 20,100 A 80,80 0 0,1 180,100" fill="none" stroke-width="8" data-role="progress-ring"/>
              </svg>
              <!-- Display do valor em lista -->
              <div class="ac-temp-display">
                <div class="ac-temp-list">
                  <div class="ac-temp-prev" data-role="temp-prev">21</div>
                  <div class="ac-temp-current" data-role="temp-current">22</div>
                  <div class="ac-temp-next" data-role="temp-next">23</div>
                </div>
              </div>
              <!-- Knob arrast√°vel -->
              <div class="ac-temp-knob-wrapper" data-role="knob">
                <div class="ac-temp-knob">
                  <div class="ac-temp-knob-dot"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
            </section>

            <!-- Wrapper para os controles (Sele√ß√£o, Aletas, Comandos) -->
            <div class="ac-controls-wrapper">
                <!-- Controles de Sele√ß√£o -->
                <section class="ac-modes" role="group" aria-label="Sele√ß√£o de ar-condicionado">
                    <h2 class="ac-section-title">Sele√ß√£o</h2>
                    <div class="ac-modes-grid ac-modes-grid--single">
                        <button type="button" class="ac-mode-btn ac-mode-btn--selection" data-mode-button data-mode="prologo" aria-pressed="true" aria-label="Pr√≥logo">
                            <span class="ac-mode-btn__label">Pr√≥logo</span>
                        </button>
                    </div>
                </section>

                <!-- Controles de Aletas -->
                <section class="ac-aleta-section" role="group" aria-label="Controle das aletas">
                    <h2 class="ac-section-title">Aletas</h2>
                    <div class="ac-aleta-grid">
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="moving" aria-pressed="true" aria-label="Aletas em movimento">
                <img src="images/icons/icon-ac-aleta-moving.svg" alt="">
              </button>
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="windfree" aria-pressed="false" aria-label="WindFree">
                <img src="images/icons/icon-windfree.svg" alt="">
              </button>
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="parada" aria-pressed="false" aria-label="Aletas paradas">
                <img src="images/icons/icon-ac-aleta-parada.svg" alt="">
              </button>
                    </div>
                </section>

                <!-- Comandos -->
                <section class="ac-commands-section">
                    <h3 class="ac-section-title">Comandos</h3>
                    <div class="ac-commands-grid">
                        <button type="button" class="ac-command-btn ac-command-btn-large" data-role="power" aria-pressed="true" aria-label="Ligar/Desligar ar-condicionado">
                            <img src="images/icons/icon-ac-power.svg" alt="">
                        </button>
                    </div>
                </section>
            </div>

            <span class="sr-only" role="status" aria-live="polite" data-role="temperature-live">Temperatura ajustada para 22 graus.</span>
        </main>
    </div>

</div>


        `,

        "ambiente3-piscina-luzes": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente3-page ambiente3-piscina-luzes-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente3-piscina')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Ilumina√ß√£o</h1>
    </div>

    <div class="ambiente3-piscina-luzes-wrapper ambiente-grid">
        <!-- Luz Piscina -->
        <div class="control-card" data-state="off" data-device-id="270" onclick="toggleRoomControl(this)">
            <img class="control-icon" src="images/icons/icon-small-light-off.svg" alt="Luz Piscina">
            <div class="control-label">Luz Piscina</div>
        </div>
    </div>

</div>

        `,

        "ambiente3-piscina": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente3-page ambiente3-piscina-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente3')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Piscina</h1>
    </div>

    <div class="ambiente3-piscina-wrapper">
        <div class="piscina-control-grid">
            <!-- Cascata -->
            <article class="curtain-tile curtain-tile--transparent piscina-switch-tile" data-device-id="152" data-environment="Imers√£o">
                <header class="curtain-tile__header curtain-tile__header--minimal">
                    <h3 class="curtain-tile__title">Cascata</h3>
                    <div class="curtain-tile__line"></div>
                </header>
                <div class="curtain-tile__actions curtain-tile__actions--dual">
                    <button class="curtain-tile__btn curtain-tile__btn--text" data-device-id="152" onclick="togglePoolControl(this, 'on')" aria-label="Ligar Cascata">
                        Ligar
                    </button>
                    <button class="curtain-tile__btn curtain-tile__btn--text" data-device-id="152" onclick="togglePoolControl(this, 'off')" aria-label="Desligar Cascata">
                        Desligar
                    </button>
                </div>
            </article>

            <!-- Hidromassagem -->
            <article class="curtain-tile curtain-tile--transparent piscina-switch-tile" data-device-id="153" data-environment="Imers√£o">
                <header class="curtain-tile__header curtain-tile__header--minimal">
                    <h3 class="curtain-tile__title">Hidromassagem</h3>
                    <div class="curtain-tile__line"></div>
                </header>
                <div class="curtain-tile__actions curtain-tile__actions--dual">
                    <button class="curtain-tile__btn curtain-tile__btn--text" data-device-id="153" onclick="togglePoolControl(this, 'on')" aria-label="Ligar Hidromassagem">
                        Ligar
                    </button>
                    <button class="curtain-tile__btn curtain-tile__btn--text" data-device-id="153" onclick="togglePoolControl(this, 'off')" aria-label="Desligar Hidromassagem">
                        Desligar
                    </button>
                </div>
            </article>

            <!-- Deck -->
            <article class="curtain-tile curtain-tile--transparent piscina-switch-tile" data-device-id="161" data-environment="Imers√£o">
                <header class="curtain-tile__header curtain-tile__header--minimal">
                    <h3 class="curtain-tile__title">Deck</h3>
                    <div class="curtain-tile__line"></div>
                </header>
                <div class="curtain-tile__actions curtain-tile__actions--dual">
                    <button class="curtain-tile__btn curtain-tile__btn--text" data-device-id="161" onclick="togglePoolControl(this, 'close')" aria-label="Cobrir Deck">
                        Cobrir
                    </button>
                    <button class="curtain-tile__btn curtain-tile__btn--text" data-device-id="161" onclick="togglePoolControl(this, 'open')" aria-label="Descobrir Deck">
                        Descobrir
                    </button>
                </div>
            </article>
        </div>

        <div class="piscina-secondary-row">
            <!-- Toldo -->
            <article class="curtain-tile curtain-tile--transparent piscina-toldo-tile" data-device-id="162" data-environment="Imers√£o">
                <header class="curtain-tile__header curtain-tile__header--minimal">
                    <h3 class="curtain-tile__title">Toldo</h3>
                    <div class="curtain-tile__line"></div>
                </header>
                <div class="curtain-tile__actions">
                    <button class="curtain-tile__btn" data-device-id="162" onclick="togglePoolControl(this, 'open')" aria-label="Abrir Toldo">
                        <img src="images/icons/arrow-up.svg" alt="Abrir">
                    </button>
                    <button class="curtain-tile__btn" data-device-id="162" onclick="togglePoolControl(this, 'stop')" aria-label="Parar Toldo">
                        <img src="images/icons/icon-stop.svg" alt="Parar">
                    </button>
                    <button class="curtain-tile__btn" data-device-id="162" onclick="togglePoolControl(this, 'close')" aria-label="Fechar Toldo">
                        <img src="images/icons/arrow-down.svg" alt="Fechar">
                    </button>
                </div>
            </article>

            <!-- Luzes -->
            <div class="control-card piscina-light-toggle" data-state="off" data-device-id="270" onclick="toggleRoomControl(this)">
                <img class="control-icon" src="images/icons/icon-small-light-off.svg" alt="Luz da Piscina">
                <div class="control-label">Luz da Piscina</div>
            </div>
        </div>
    </div>

</div>

        `,

        "ambiente3-telao": () => `

    <div class="top-bar-custom"></div>

    <div class="page active page-container ambiente1-page ambiente1-htv-page">

      <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente3')">
          <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Controle TV</h1>
      </div>

      <div class="tv-control-wrapper">
        
        <!-- COLUNA 1 -->
        <div class="tv-controls-col tv-col-1">
          <!-- BLOCO 1: ON/OFF -->
          <div class="tv-control-section">
            <header class="tv-section-header">
              <h3 class="tv-section-title">On / Off</h3>
              <div class="tv-section-line"></div>
            </header>
            <div class="tv-control-group tv-power-group">
              <button class="tv-btn tv-btn--power-on" onclick="telaoMacroOn()" aria-label="Ligar">
                ON
              </button>
              <button class="tv-btn tv-btn--power-off" onclick="htvMacroOff()" aria-label="Desligar">
                OFF
              </button>
            </div>
          </div>

          <!-- BLOCO 4 E 5: VOLUME E CANAIS (lado a lado) -->
          <div class="tv-volume-canais-wrapper">
                
            <!-- BLOCO 4: VOLUME -->
            <div class="tv-control-section">
              <header class="tv-section-header">
                <h3 class="tv-section-title">Volume</h3>
                <span class="tv-volume-value" id="tv-volume-display">50</span>
                <div class="tv-section-line"></div>
              </header>
              <div class="tv-control-group tv-volume-slider-container">
                <input 
                  type="range" 
                  class="tv-volume-slider" 
                  id="tv-volume-slider"
                  min="0" 
                  max="100" 
                  value="50"
                  data-device-id="15"
                  aria-label="Controle de Volume"
                >
              </div>
            </div>

            <!-- BLOCO 5: CANAIS -->
            <div class="tv-control-section">
              <header class="tv-section-header">
                <h3 class="tv-section-title">Canais</h3>
                <div class="tv-section-line"></div>
              </header>
              <div class="tv-control-group tv-volume-channels-inline">
                        
                <!-- Coluna Canais -->
                <div class="tv-channels-column">
                  <div class="tv-channels-buttons">
            <button class="tv-btn-square" onclick="tvCommand(this, 'channelDown')" data-device-id="114" aria-label="Canal +">
                      <img src="images/icons/arrow-up.svg" alt="Canal +" class="tv-btn-icon-img">
                    </button>
            <button class="tv-btn-square" onclick="tvCommand(this, 'channelUp')" data-device-id="114" aria-label="Canal -">
                      <img src="images/icons/arrow-down.svg" alt="Canal -" class="tv-btn-icon-img">
                    </button>
                  </div>
                </div>

              </div>
            </div>

          </div>
        </div>

        <!-- COLUNA 2 -->
        <div class="tv-controls-col tv-col-2">
          <!-- BLOCO 3: COMANDOS (Back, Menu, Home, Mute) -->
          <div class="tv-control-section">
            <header class="tv-section-header">
              <h3 class="tv-section-title">Comandos</h3>
              <div class="tv-section-line"></div>
            </header>
            <div class="tv-control-group tv-commands-grid">
              <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'returnButton')" data-device-id="114" aria-label="Voltar">
                <img src="images/icons/back-button.svg" alt="Voltar">
              </button>
              <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'menu')" data-device-id="114" aria-label="Menu">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <line x1="3" y1="12" x2="21" y2="12"></line>
                  <line x1="3" y1="6" x2="21" y2="6"></line>
                  <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
              </button>
              <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'volMute')" data-device-id="114" aria-label="Mudo">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                  <line x1="23" y1="9" x2="17" y2="15"></line>
                  <line x1="17" y1="9" x2="23" y2="15"></line>
                </svg>
              </button>
              <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'home')" data-device-id="114" aria-label="Home">
                <img src="images/icons/icon-home.svg" alt="Home">
              </button>
            </div>
          </div>

          <!-- BLOCO 2: CONTROLE (D-PAD) -->
          <div class="tv-control-section">
            <header class="tv-section-header">
              <h3 class="tv-section-title">Controle</h3>
              <div class="tv-section-line"></div>
            </header>
            <div class="tv-control-group tv-directional-row">
              <div class="tv-directional-section">
                <div class="tv-directional-pad">
                  <!-- Linha 1: UP -->
                  <button class="tv-directional-btn tv-directional-btn--up" onclick="tvCommand(this, 'cursorUp')" data-device-id="114" aria-label="Cima">
                    <img src="images/icons/arrow-up.svg" alt="Cima" class="tv-btn-icon-img">
                  </button>
                            
                  <!-- Linha 2: LEFT, OK, RIGHT -->
                  <div class="tv-directional-row-line">
                    <button class="tv-directional-btn tv-directional-btn--left" onclick="tvCommand(this, 'cursorLeft')" data-device-id="114" aria-label="Esquerda">
                      <img src="images/icons/arrow-left.svg" alt="Esquerda" class="tv-btn-icon-img">
                    </button>
                    <button class="tv-directional-btn tv-directional-btn--ok" onclick="tvCommand(this, 'cursorCenter')" data-device-id="114" aria-label="OK">
                      <div class="tv-ok-circle"></div>
                    </button>
                    <button class="tv-directional-btn tv-directional-btn--right" onclick="tvCommand(this, 'cursorRight')" data-device-id="114" aria-label="Direita">
                      <img src="images/icons/arrow-right.svg" alt="Direita" class="tv-btn-icon-img">
                    </button>
                  </div>
                            
                  <!-- Linha 3: DOWN -->
                  <button class="tv-directional-btn tv-directional-btn--down" onclick="tvCommand(this, 'cursorDown')" data-device-id="114" aria-label="Baixo">
                    <img src="images/icons/arrow-down.svg" alt="Baixo" class="tv-btn-icon-img">
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- COLUNA 3 -->
        <div class="tv-controls-col tv-col-3">
          <!-- BLOCO 6: N√öMEROS -->
          <div class="tv-control-section">
            <header class="tv-section-header">
              <h3 class="tv-section-title">N√∫meros</h3>
              <div class="tv-section-line"></div>
            </header>
            <div class="tv-control-group">
              <div class="tv-numpad">
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num1')" data-device-id="114" aria-label="1">1</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num2')" data-device-id="114" aria-label="2">2</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num3')" data-device-id="114" aria-label="3">3</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num4')" data-device-id="114" aria-label="4">4</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num5')" data-device-id="114" aria-label="5">5</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num6')" data-device-id="114" aria-label="6">6</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num7')" data-device-id="114" aria-label="7">7</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num8')" data-device-id="114" aria-label="8">8</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num9')" data-device-id="114" aria-label="9">9</button>
                <button class="tv-numpad-btn tv-numpad-btn--icon" onclick="tvCommand(this, 'returnButton')" data-device-id="114" aria-label="Voltar">
                  <img src="images/icons/back-button.svg" alt="Back">
                </button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num0')" data-device-id="114" aria-label="0">0</button>
                <button class="tv-numpad-btn tv-numpad-btn--icon" onclick="fireTVMacro()" aria-label="Fire TV">
                  <img src="images/icons/icon-firetv.svg" alt="Fire TV">
                </button>
              </div>
            </div>
          </div>

          <!-- BLOCO 7: LOGO ELETRIZE -->
          <div class="tv-control-section tv-logo-section">
            <img src="images/icons/eletrize.svg" alt="Eletrize" class="tv-eletrize-logo">
          </div>
        </div>

      </div>

    </div>

        `,

        ambiente4: () => {
          const envName = getTranslatedEnvName('ambiente4', 'Pesquisa');
          return `
<div class="top-bar-custom"></div>

<div class="page active page-container ambiente4-page">

    <div class="page-header">

        <button class="back-btn" onclick="spaNavigate('home')"><img src="images/icons/back-button.svg" alt="Voltar"></button>

        <h1 class="page-title">${envName}</h1>

    </div>

    

    <div class="ambiente4-controls-wrapper ambiente-grid">
        ${generateFeatureButtons('ambiente4')}
    </div>

</div>
          `;
        },

        ambiente6: () => {
          const envName = getTranslatedEnvName('ambiente6', 'Maquete');
          return `
<div class="top-bar-custom"></div>

<div class="page active page-container ambiente6-page">

    <div class="page-header">

        <button class="back-btn" onclick="spaNavigate('home')"><img src="images/icons/back-button.svg" alt="Voltar"></button>

        <h1 class="page-title">${envName}</h1>

    </div>

    

    <div class="ambiente6-controls-wrapper ambiente-grid">
        ${generateFeatureButtons('ambiente6')}
    </div>

</div>
          `;
        },

        ambiente7: () => {
          const envName = getTranslatedEnvName('ambiente7', 'Holograma');
          return `
<div class="top-bar-custom"></div>

<div class="page active page-container ambiente7-page">

    <div class="page-header">

        <button class="back-btn" onclick="spaNavigate('home')"><img src="images/icons/back-button.svg" alt="Voltar"></button>

        <h1 class="page-title">${envName}</h1>

    </div>

    

    <div class="ambiente7-controls-wrapper ambiente-grid">
        ${generateFeatureButtons('ambiente7')}
    </div>

</div>
          `;
        },

        "ambiente7-luzes": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente7-page ambiente7-luzes-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente7')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Ilumina√ß√£o</h1>
    </div>

    <div class="ambiente7-luzes-wrapper ambiente-grid">
      <!-- Luzes geradas dinamicamente pelo config.js -->
    </div>

</div>

        `,

        "ambiente7-cortinas": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente7-page ambiente7-cortinas-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente7')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Cortinas</h1>
    </div>

    <div class="ambiente7-cortinas-wrapper">
        <!-- Veneziana -->
        <article class="curtain-tile curtain-tile--full-width curtain-tile--transparent" data-device-id="192" data-environment="Su√≠te I">
            <header class="curtain-tile__header curtain-tile__header--minimal">
                <h3 class="curtain-tile__title">Veneziana</h3>
                <div class="curtain-tile__line"></div>
            </header>
            <div class="curtain-tile__actions">
                <button class="curtain-tile__btn" data-device-id="192" onclick="curtainAction(this, 'push1')" aria-label="Abrir Veneziana">
                    <img src="images/icons/arrow-up.svg" alt="Abrir">
                </button>
                <button class="curtain-tile__btn" data-device-id="192" onclick="curtainAction(this, 'push2')" aria-label="Parar Veneziana">
                    <img src="images/icons/icon-stop.svg" alt="Parar">
                </button>
                <button class="curtain-tile__btn" data-device-id="192" onclick="curtainAction(this, 'push3')" aria-label="Fechar Veneziana">
                    <img src="images/icons/arrow-down.svg" alt="Fechar">
                </button>
            </div>
        </article>
    </div>

</div>

        `,

        "ambiente7-conforto": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente7-page ambiente7-conforto-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente7')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
    </div>

    <div class="ac-page-wrapper">
        <main class="ac-container" data-component="ac-control">
            
            <!-- Display de Temperatura -->
            <section class="ac-temperature-section">
        <div class="ac-temperature-fade-content">
          <div class="ac-temperature-display">
            <div class="ac-temp-wrapper">
              <!-- SVG para o arco de progresso -->
              <svg class="ac-temp-arc" viewBox="0 0 200 120" preserveAspectRatio="xMidYMid meet">
                <!-- Arco de fundo -->
                <path class="ac-temp-arc-bg" d="M 20,100 A 80,80 0 0,1 180,100" fill="none" stroke-width="8"/>
                <!-- Arco de progresso -->
                <path class="ac-temp-arc-progress" d="M 20,100 A 80,80 0 0,1 180,100" fill="none" stroke-width="8" data-role="progress-ring"/>
              </svg>
              <!-- Display do valor em lista -->
              <div class="ac-temp-display">
                <div class="ac-temp-list">
                  <div class="ac-temp-prev" data-role="temp-prev">21</div>
                  <div class="ac-temp-current" data-role="temp-current">22</div>
                  <div class="ac-temp-next" data-role="temp-next">23</div>
                </div>
              </div>
              <!-- Knob arrast√°vel -->
              <div class="ac-temp-knob-wrapper" data-role="knob">
                <div class="ac-temp-knob">
                  <div class="ac-temp-knob-dot"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
            </section>

            <!-- Wrapper para os controles (Sele√ß√£o, Aletas, Comandos) -->
            <div class="ac-controls-wrapper">
                <!-- Controles de Sele√ß√£o -->
                <section class="ac-modes" role="group" aria-label="Sele√ß√£o de ar-condicionado">
                    <h2 class="ac-section-title">Sele√ß√£o</h2>
                    <div class="ac-modes-grid ac-modes-grid--single">
                        <button type="button" class="ac-mode-btn ac-mode-btn--selection" data-mode-button data-mode="suite1" aria-pressed="true" aria-label="Su√≠te I">
                            <span class="ac-mode-btn__label">Su√≠te I</span>
                        </button>
                    </div>
                </section>

                <!-- Controles de Aletas -->
                <section class="ac-aleta-section" role="group" aria-label="Controle das aletas">
                    <h2 class="ac-section-title">Aletas</h2>
                    <div class="ac-aleta-grid ac-aleta-grid--dual">
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="moving" aria-pressed="true" aria-label="Aletas em movimento">
                <img src="images/icons/icon-ac-aleta-moving.svg" alt="">
              </button>
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="parada" aria-pressed="false" aria-label="Aletas paradas">
                <img src="images/icons/icon-ac-aleta-parada.svg" alt="">
              </button>
                    </div>
                </section>

                <!-- Comandos -->
                <section class="ac-commands-section">
                    <h3 class="ac-section-title">Comandos</h3>
                    <div class="ac-commands-grid">
                        <button type="button" class="ac-command-btn ac-command-btn-large" data-role="power" aria-pressed="true" aria-label="Ligar/Desligar ar-condicionado">
                            <img src="images/icons/icon-ac-power.svg" alt="">
                        </button>
                    </div>
                </section>
            </div>

            <span class="sr-only" role="status" aria-live="polite" data-role="temperature-live">Temperatura ajustada para 22 graus.</span>
        </main>
    </div>

</div>

        `,

        "ambiente7-tv": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente7-page ambiente7-tv-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente7')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Controle TV</h1>
    </div>

    <div class="tv-control-wrapper">
        
        <!-- COLUNA 1 -->
        <div class="tv-controls-col tv-col-1">
            <!-- BLOCO 1: ON/OFF -->
            <div class="tv-control-section">
                <header class="tv-section-header">
                    <h3 class="tv-section-title">On / Off</h3>
                    <div class="tv-section-line"></div>
                </header>
                <div class="tv-control-group tv-power-group">
          <button class="tv-btn tv-btn--power-on" onclick="suite1TvOn()" aria-label="Ligar">
            ON
          </button>
          <button class="tv-btn tv-btn--power-off" onclick="suite1TvOff()" aria-label="Desligar">
            OFF
          </button>
                </div>
            </div>

            <!-- BLOCO 4 E 5: VOLUME E CANAIS (lado a lado) -->
            <div class="tv-volume-canais-wrapper">
                
                <!-- BLOCO 4: VOLUME -->
                <div class="tv-control-section">
                    <header class="tv-section-header">
                        <h3 class="tv-section-title">Volume</h3>
                        <span class="tv-volume-value" id="tv-volume-display">50</span>
                        <div class="tv-section-line"></div>
                    </header>
                    <div class="tv-control-group tv-volume-slider-container">
                        <input 
                            type="range" 
                            class="tv-volume-slider" 
                            id="tv-volume-slider"
                            min="0" 
                            max="100" 
                            value="50"
                            data-device-id="184"
                            aria-label="Controle de Volume"
                        >
                    </div>
                </div>

                <!-- BLOCO 5: CANAIS -->
                <div class="tv-control-section">
                    <header class="tv-section-header">
                        <h3 class="tv-section-title">Canais</h3>
                        <div class="tv-section-line"></div>
                    </header>
                    <div class="tv-control-group tv-volume-channels-inline">
                        
                        <!-- Coluna Canais -->
                        <div class="tv-channels-column">
                            <div class="tv-channels-buttons">
                <button class="tv-btn-square" onclick="tvCommand(this, 'channelDown')" data-device-id="184" aria-label="Canal +">
                                    <img src="images/icons/arrow-up.svg" alt="Canal +" class="tv-btn-icon-img">
                                </button>
                <button class="tv-btn-square" onclick="tvCommand(this, 'channelUp')" data-device-id="184" aria-label="Canal -">
                                    <img src="images/icons/arrow-down.svg" alt="Canal -" class="tv-btn-icon-img">
                                </button>
                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>

        <!-- COLUNA 2 -->
        <div class="tv-controls-col tv-col-2">
            <!-- BLOCO 3: COMANDOS (Back, Menu, Home, Mute) -->
            <div class="tv-control-section">
                <header class="tv-section-header">
                    <h3 class="tv-section-title">Comandos</h3>
                    <div class="tv-section-line"></div>
                </header>
                <div class="tv-control-group tv-commands-grid">
                    <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'returnButton')" data-device-id="184" aria-label="Voltar">
                        <img src="images/icons/back-button.svg" alt="Voltar">
                    </button>
                    <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'hdmi2')" data-device-id="184" aria-label="Menu">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="3" y1="12" x2="21" y2="12"></line>
                            <line x1="3" y1="6" x2="21" y2="6"></line>
                            <line x1="3" y1="18" x2="21" y2="18"></line>
                        </svg>
                    </button>
                    <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'mute')" data-device-id="184" aria-label="Mudo">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                            <line x1="23" y1="9" x2="17" y2="15"></line>
                            <line x1="17" y1="9" x2="23" y2="15"></line>
                        </svg>
                    </button>
                    <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'home')" data-device-id="184" aria-label="Home">
                        <img src="images/icons/icon-home.svg" alt="Home">
                    </button>
                </div>
            </div>

            <!-- BLOCO 2: CONTROLE (D-PAD) -->
            <div class="tv-control-section">
                <header class="tv-section-header">
                    <h3 class="tv-section-title">Controle</h3>
                    <div class="tv-section-line"></div>
                </header>
                <div class="tv-control-group tv-directional-row">
                    <div class="tv-directional-section">
                        <div class="tv-directional-pad">
                            <!-- Linha 1: UP -->
                            <button class="tv-directional-btn tv-directional-btn--up" onclick="tvCommand(this, 'cursorUp')" data-device-id="184" aria-label="Cima">
                                <img src="images/icons/arrow-up.svg" alt="Cima" class="tv-btn-icon-img">
                            </button>
                            
                            <!-- Linha 2: LEFT, OK, RIGHT -->
                            <div class="tv-directional-row-line">
                                <button class="tv-directional-btn tv-directional-btn--left" onclick="tvCommand(this, 'cursorLeft')" data-device-id="184" aria-label="Esquerda">
                                    <img src="images/icons/arrow-left.svg" alt="Esquerda" class="tv-btn-icon-img">
                                </button>
                                <button class="tv-directional-btn tv-directional-btn--ok" onclick="tvCommand(this, 'cursorCenter')" data-device-id="184" aria-label="OK">
                                    <div class="tv-ok-circle"></div>
                                </button>
                                <button class="tv-directional-btn tv-directional-btn--right" onclick="tvCommand(this, 'cursorRight')" data-device-id="184" aria-label="Direita">
                                    <img src="images/icons/arrow-right.svg" alt="Direita" class="tv-btn-icon-img">
                                </button>
                            </div>
                            
                            <!-- Linha 3: DOWN -->
                            <button class="tv-directional-btn tv-directional-btn--down" onclick="tvCommand(this, 'cursorDown')" data-device-id="184" aria-label="Baixo">
                                <img src="images/icons/arrow-down.svg" alt="Baixo" class="tv-btn-icon-img">
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- COLUNA 3 -->
        <div class="tv-controls-col tv-col-3">
            <!-- BLOCO 6: N√öMEROS -->
            <div class="tv-control-section">
                <header class="tv-section-header">
                    <h3 class="tv-section-title">N√∫meros</h3>
                    <div class="tv-section-line"></div>
                </header>
                <div class="tv-control-group">
                    <div class="tv-numpad">
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num1')" data-device-id="184" aria-label="1">1</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num2')" data-device-id="184" aria-label="2">2</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num3')" data-device-id="184" aria-label="3">3</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num4')" data-device-id="184" aria-label="4">4</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num5')" data-device-id="184" aria-label="5">5</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num6')" data-device-id="184" aria-label="6">6</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num7')" data-device-id="184" aria-label="7">7</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num8')" data-device-id="184" aria-label="8">8</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num9')" data-device-id="184" aria-label="9">9</button>
                        <button class="tv-numpad-btn tv-numpad-btn--icon" onclick="tvCommand(this, 'returnButton')" data-device-id="184" aria-label="Voltar">
                            <img src="images/icons/back-button.svg" alt="Back">
                        </button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num0')" data-device-id="184" aria-label="0">0</button>
                        <button class="tv-numpad-btn tv-numpad-btn--icon" onclick="fireTVMacro()" aria-label="Fire TV">
                            <img src="images/icons/icon-firetv.svg" alt="Fire TV">
                        </button>
                    </div>
                </div>
            </div>

            <!-- BLOCO 7: LOGO ELETRIZE -->
            <div class="tv-control-section tv-logo-section">
                <img src="images/icons/eletrize.svg" alt="Eletrize" class="tv-eletrize-logo">
            </div>
        </div>

    </div>

</div>

        `,
        ambiente8: () => {
          const envName = getTranslatedEnvName('ambiente8', 'Processos');
          return `
<div class="top-bar-custom"></div>

<div class="page active page-container ambiente8-page">

    <div class="page-header">

        <button class="back-btn" onclick="spaNavigate('home')"><img src="images/icons/back-button.svg" alt="Voltar"></button>

        <h1 class="page-title">${envName}</h1>

    </div>

    

    <div class="ambiente8-controls-wrapper ambiente-grid">
        ${generateFeatureButtons('ambiente8')}
    </div>

</div>
          `;
        },

        "ambiente8-luzes": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente8-page ambiente8-luzes-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente8')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Ilumina√ß√£o</h1>
    </div>

    <div class="ambiente8-luzes-wrapper ambiente-grid">
      <!-- Luzes geradas dinamicamente pelo config.js -->
    </div>

</div>

        `,

        "ambiente8-cortinas": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente8-page ambiente8-cortinas-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente8')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Cortinas</h1>
    </div>

    <div class="ambiente8-cortinas-wrapper">
        <!-- Veneziana -->
        <article class="curtain-tile curtain-tile--full-width curtain-tile--transparent" data-device-id="193" data-environment="Su√≠te II">
            <header class="curtain-tile__header curtain-tile__header--minimal">
                <h3 class="curtain-tile__title">Veneziana</h3>
                <div class="curtain-tile__line"></div>
            </header>
            <div class="curtain-tile__actions">
                <button class="curtain-tile__btn" data-device-id="193" onclick="curtainAction(this, 'push1')" aria-label="Abrir Veneziana">
                    <img src="images/icons/arrow-up.svg" alt="Abrir">
                </button>
                <button class="curtain-tile__btn" data-device-id="193" onclick="curtainAction(this, 'push2')" aria-label="Parar Veneziana">
                    <img src="images/icons/icon-stop.svg" alt="Parar">
                </button>
                <button class="curtain-tile__btn" data-device-id="193" onclick="curtainAction(this, 'push3')" aria-label="Fechar Veneziana">
                    <img src="images/icons/arrow-down.svg" alt="Fechar">
                </button>
            </div>
        </article>
    </div>

</div>

        `,

        "ambiente8-conforto": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente8-page ambiente8-conforto-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente8')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
    </div>

    <div class="ac-page-wrapper">
        <main class="ac-container" data-component="ac-control">
            
            <!-- Display de Temperatura -->
            <section class="ac-temperature-section">
        <div class="ac-temperature-fade-content">
          <div class="ac-temperature-display">
            <div class="ac-temp-wrapper">
              <!-- SVG para o arco de progresso -->
              <svg class="ac-temp-arc" viewBox="0 0 200 120" preserveAspectRatio="xMidYMid meet">
                <!-- Arco de fundo -->
                <path class="ac-temp-arc-bg" d="M 20,100 A 80,80 0 0,1 180,100" fill="none" stroke-width="8"/>
                <!-- Arco de progresso -->
                <path class="ac-temp-arc-progress" d="M 20,100 A 80,80 0 0,1 180,100" fill="none" stroke-width="8" data-role="progress-ring"/>
              </svg>
              <!-- Display do valor em lista -->
              <div class="ac-temp-display">
                <div class="ac-temp-list">
                  <div class="ac-temp-prev" data-role="temp-prev">21</div>
                  <div class="ac-temp-current" data-role="temp-current">22</div>
                  <div class="ac-temp-next" data-role="temp-next">23</div>
                </div>
              </div>
              <!-- Knob arrast√°vel -->
              <div class="ac-temp-knob-wrapper" data-role="knob">
                <div class="ac-temp-knob">
                  <div class="ac-temp-knob-dot"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
            </section>

            <!-- Wrapper para os controles (Sele√ß√£o, Aletas, Comandos) -->
            <div class="ac-controls-wrapper">
                <!-- Controles de Sele√ß√£o -->
                <section class="ac-modes" role="group" aria-label="Sele√ß√£o de ar-condicionado">
                    <h2 class="ac-section-title">Sele√ß√£o</h2>
                    <div class="ac-modes-grid ac-modes-grid--single">
                        <button type="button" class="ac-mode-btn ac-mode-btn--selection" data-mode-button data-mode="suite2" aria-pressed="true" aria-label="Su√≠te II">
                            <span class="ac-mode-btn__label">Su√≠te II</span>
                        </button>
                    </div>
                </section>

                <!-- Controles de Aletas -->
                <section class="ac-aleta-section" role="group" aria-label="Controle das aletas">
                    <h2 class="ac-section-title">Aletas</h2>
                    <div class="ac-aleta-grid ac-aleta-grid--dual">
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="moving" aria-pressed="true" aria-label="Aletas em movimento">
                <img src="images/icons/icon-ac-aleta-moving.svg" alt="">
              </button>
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="parada" aria-pressed="false" aria-label="Aletas paradas">
                <img src="images/icons/icon-ac-aleta-parada.svg" alt="">
              </button>
                    </div>
                </section>

                <!-- Comandos -->
                <section class="ac-commands-section">
                    <h3 class="ac-section-title">Comandos</h3>
                    <div class="ac-commands-grid">
                        <button type="button" class="ac-command-btn ac-command-btn-large" data-role="power" aria-pressed="true" aria-label="Ligar/Desligar ar-condicionado">
                            <img src="images/icons/icon-ac-power.svg" alt="">
                        </button>
                    </div>
                </section>
            </div>

            <span class="sr-only" role="status" aria-live="polite" data-role="temperature-live">Temperatura ajustada para 22 graus.</span>
        </main>
    </div>

</div>

        `,

        "ambiente8-tv": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente8-page ambiente8-tv-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente8')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Controle TV</h1>
    </div>

    <div class="tv-control-wrapper">
        
        <!-- COLUNA 1 -->
        <div class="tv-controls-col tv-col-1">
            <!-- BLOCO 1: ON/OFF -->
            <div class="tv-control-section">
                <header class="tv-section-header">
                    <h3 class="tv-section-title">On / Off</h3>
                    <div class="tv-section-line"></div>
                </header>
                <div class="tv-control-group tv-power-group">
          <button class="tv-btn tv-btn--power-on" onclick="suite2TvOn()" aria-label="Ligar">
            ON
          </button>
          <button class="tv-btn tv-btn--power-off" onclick="suite2TvOff()" aria-label="Desligar">
            OFF
          </button>
                </div>
            </div>

            <!-- BLOCO 4 E 5: VOLUME E CANAIS (lado a lado) -->
            <div class="tv-volume-canais-wrapper">
                
                <!-- BLOCO 4: VOLUME -->
                <div class="tv-control-section">
                    <header class="tv-section-header">
                        <h3 class="tv-section-title">Volume</h3>
                        <span class="tv-volume-value" id="tv-volume-display">50</span>
                        <div class="tv-section-line"></div>
                    </header>
                    <div class="tv-control-group tv-volume-slider-container">
                        <input 
                            type="range" 
                            class="tv-volume-slider" 
                            id="tv-volume-slider"
                            min="0" 
                            max="100" 
                            value="50"
                            data-device-id="185"
                            aria-label="Controle de Volume"
                        >
                    </div>
                </div>

                <!-- BLOCO 5: CANAIS -->
                <div class="tv-control-section">
                    <header class="tv-section-header">
                        <h3 class="tv-section-title">Canais</h3>
                        <div class="tv-section-line"></div>
                    </header>
                    <div class="tv-control-group tv-volume-channels-inline">
                        
                        <!-- Coluna Canais -->
                        <div class="tv-channels-column">
                            <div class="tv-channels-buttons">
                <button class="tv-btn-square" onclick="tvCommand(this, 'channelDown')" data-device-id="185" aria-label="Canal +">
                                    <img src="images/icons/arrow-up.svg" alt="Canal +" class="tv-btn-icon-img">
                                </button>
                <button class="tv-btn-square" onclick="tvCommand(this, 'channelUp')" data-device-id="185" aria-label="Canal -">
                                    <img src="images/icons/arrow-down.svg" alt="Canal -" class="tv-btn-icon-img">
                                </button>
                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>

        <!-- COLUNA 2 -->
        <div class="tv-controls-col tv-col-2">
            <!-- BLOCO 3: COMANDOS (Back, Menu, Home, Mute) -->
            <div class="tv-control-section">
                <header class="tv-section-header">
                    <h3 class="tv-section-title">Comandos</h3>
                    <div class="tv-section-line"></div>
                </header>
                <div class="tv-control-group tv-commands-grid">
                    <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'returnButton')" data-device-id="185" aria-label="Voltar">
                        <img src="images/icons/back-button.svg" alt="Voltar">
                    </button>
                    <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'hdmi2')" data-device-id="185" aria-label="Menu">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="3" y1="12" x2="21" y2="12"></line>
                            <line x1="3" y1="6" x2="21" y2="6"></line>
                            <line x1="3" y1="18" x2="21" y2="18"></line>
                        </svg>
                    </button>
                    <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'mute')" data-device-id="185" aria-label="Mudo">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                            <line x1="23" y1="9" x2="17" y2="15"></line>
                            <line x1="17" y1="9" x2="23" y2="15"></line>
                        </svg>
                    </button>
                    <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'home')" data-device-id="185" aria-label="Home">
                        <img src="images/icons/icon-home.svg" alt="Home">
                    </button>
                </div>
            </div>

            <!-- BLOCO 2: CONTROLE (D-PAD) -->
            <div class="tv-control-section">
                <header class="tv-section-header">
                    <h3 class="tv-section-title">Controle</h3>
                    <div class="tv-section-line"></div>
                </header>
                <div class="tv-control-group tv-directional-row">
                    <div class="tv-directional-section">
                        <div class="tv-directional-pad">
                            <!-- Linha 1: UP -->
                            <button class="tv-directional-btn tv-directional-btn--up" onclick="tvCommand(this, 'cursorUp')" data-device-id="185" aria-label="Cima">
                                <img src="images/icons/arrow-up.svg" alt="Cima" class="tv-btn-icon-img">
                            </button>
                            
                            <!-- Linha 2: LEFT, OK, RIGHT -->
                            <div class="tv-directional-row-line">
                                <button class="tv-directional-btn tv-directional-btn--left" onclick="tvCommand(this, 'cursorLeft')" data-device-id="185" aria-label="Esquerda">
                                    <img src="images/icons/arrow-left.svg" alt="Esquerda" class="tv-btn-icon-img">
                                </button>
                                <button class="tv-directional-btn tv-directional-btn--ok" onclick="tvCommand(this, 'cursorCenter')" data-device-id="185" aria-label="OK">
                                    <div class="tv-ok-circle"></div>
                                </button>
                                <button class="tv-directional-btn tv-directional-btn--right" onclick="tvCommand(this, 'cursorRight')" data-device-id="185" aria-label="Direita">
                                    <img src="images/icons/arrow-right.svg" alt="Direita" class="tv-btn-icon-img">
                                </button>
                            </div>
                            
                            <!-- Linha 3: DOWN -->
                            <button class="tv-directional-btn tv-directional-btn--down" onclick="tvCommand(this, 'cursorDown')" data-device-id="185" aria-label="Baixo">
                                <img src="images/icons/arrow-down.svg" alt="Baixo" class="tv-btn-icon-img">
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- COLUNA 3 -->
        <div class="tv-controls-col tv-col-3">
            <!-- BLOCO 6: N√öMEROS -->
            <div class="tv-control-section">
                <header class="tv-section-header">
                    <h3 class="tv-section-title">N√∫meros</h3>
                    <div class="tv-section-line"></div>
                </header>
                <div class="tv-control-group">
                    <div class="tv-numpad">
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num1')" data-device-id="185" aria-label="1">1</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num2')" data-device-id="185" aria-label="2">2</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num3')" data-device-id="185" aria-label="3">3</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num4')" data-device-id="185" aria-label="4">4</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num5')" data-device-id="185" aria-label="5">5</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num6')" data-device-id="185" aria-label="6">6</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num7')" data-device-id="185" aria-label="7">7</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num8')" data-device-id="185" aria-label="8">8</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num9')" data-device-id="185" aria-label="9">9</button>
                        <button class="tv-numpad-btn tv-numpad-btn--icon" onclick="tvCommand(this, 'returnButton')" data-device-id="185" aria-label="Voltar">
                            <img src="images/icons/back-button.svg" alt="Back">
                        </button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num0')" data-device-id="185" aria-label="0">0</button>
                        <button class="tv-numpad-btn tv-numpad-btn--icon" onclick="fireTVMacro()" aria-label="Fire TV">
                            <img src="images/icons/icon-firetv.svg" alt="Fire TV">
                        </button>
                    </div>
                </div>
            </div>

            <!-- BLOCO 7: LOGO ELETRIZE -->
            <div class="tv-control-section tv-logo-section">
                <img src="images/icons/eletrize.svg" alt="Eletrize" class="tv-eletrize-logo">
            </div>
        </div>

    </div>

</div>

        `,

        "ambiente8-htv": () => `

    <div class="top-bar-custom"></div>

    <div class="page active page-container ambiente8-page ambiente8-htv-page">

      <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente8')">
          <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Controle TV</h1>
      </div>

      <div class="tv-control-wrapper">
        
        <!-- COLUNA 1 -->
        <div class="tv-controls-col tv-col-1">
          <!-- BLOCO 1: ON/OFF -->
          <div class="tv-control-section">
            <header class="tv-section-header">
              <h3 class="tv-section-title">On / Off</h3>
              <div class="tv-section-line"></div>
            </header>
            <div class="tv-control-group tv-power-group">
              <button class="tv-btn tv-btn--power-on" onclick="suite2HtvOn()" aria-label="Ligar">
                ON
              </button>
              <button class="tv-btn tv-btn--power-off" onclick="suite2HtvOff()" aria-label="Desligar">
                OFF
              </button>
            </div>
          </div>

          <!-- BLOCO 4 E 5: VOLUME E CANAIS (lado a lado) -->
          <div class="tv-volume-canais-wrapper">
                
            <!-- BLOCO 4: VOLUME -->
            <div class="tv-control-section">
              <header class="tv-section-header">
                <h3 class="tv-section-title">Volume</h3>
                <span class="tv-volume-value" id="tv-volume-display">50</span>
                <div class="tv-section-line"></div>
              </header>
              <div class="tv-control-group tv-volume-slider-container">
                <input 
                  type="range" 
                  class="tv-volume-slider" 
                  id="tv-volume-slider"
                  min="0" 
                  max="100" 
                  value="50"
                  data-device-id="191"
                  aria-label="Controle de Volume"
                >
              </div>
            </div>

            <!-- BLOCO 5: CANAIS -->
            <div class="tv-control-section">
              <header class="tv-section-header">
                <h3 class="tv-section-title">Canais</h3>
                <div class="tv-section-line"></div>
              </header>
              <div class="tv-control-group tv-volume-channels-inline">
                        
                <!-- Coluna Canais -->
                <div class="tv-channels-column">
                  <div class="tv-channels-buttons">
            <button class="tv-btn-square" onclick="tvCommand(this, 'channelDown')" data-device-id="191" aria-label="Canal +">
                      <img src="images/icons/arrow-up.svg" alt="Canal +" class="tv-btn-icon-img">
                    </button>
            <button class="tv-btn-square" onclick="tvCommand(this, 'channelUp')" data-device-id="191" aria-label="Canal -">
                      <img src="images/icons/arrow-down.svg" alt="Canal -" class="tv-btn-icon-img">
                    </button>
                  </div>
                </div>

              </div>
            </div>

          </div>
        </div>

        <!-- COLUNA 2 -->
        <div class="tv-controls-col tv-col-2">
          <!-- BLOCO 3: COMANDOS (Back, Menu, Home, Mute) -->
          <div class="tv-control-section">
            <header class="tv-section-header">
              <h3 class="tv-section-title">Comandos</h3>
              <div class="tv-section-line"></div>
            </header>
            <div class="tv-control-group tv-commands-grid">
              <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'returnButton')" data-device-id="191" aria-label="Voltar">
                <img src="images/icons/back-button.svg" alt="Voltar">
              </button>
              <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'menu')" data-device-id="191" aria-label="Menu">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <line x1="3" y1="12" x2="21" y2="12"></line>
                  <line x1="3" y1="6" x2="21" y2="6"></line>
                  <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
              </button>
              <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'volMute')" data-device-id="191" aria-label="Mudo">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                  <line x1="23" y1="9" x2="17" y2="15"></line>
                  <line x1="17" y1="9" x2="23" y2="15"></line>
                </svg>
              </button>
              <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'home')" data-device-id="191" aria-label="Home">
                <img src="images/icons/icon-home.svg" alt="Home">
              </button>
            </div>
          </div>

          <!-- BLOCO 2: CONTROLE (D-PAD) -->
          <div class="tv-control-section">
            <header class="tv-section-header">
              <h3 class="tv-section-title">Controle</h3>
              <div class="tv-section-line"></div>
            </header>
            <div class="tv-control-group tv-directional-row">
              <div class="tv-directional-section">
                <div class="tv-directional-pad">
                  <!-- Linha 1: UP -->
                  <button class="tv-directional-btn tv-directional-btn--up" onclick="tvCommand(this, 'cursorUp')" data-device-id="191" aria-label="Cima">
                    <img src="images/icons/arrow-up.svg" alt="Cima" class="tv-btn-icon-img">
                  </button>
                            
                  <!-- Linha 2: LEFT, OK, RIGHT -->
                  <div class="tv-directional-row-line">
                    <button class="tv-directional-btn tv-directional-btn--left" onclick="tvCommand(this, 'cursorLeft')" data-device-id="191" aria-label="Esquerda">
                      <img src="images/icons/arrow-left.svg" alt="Esquerda" class="tv-btn-icon-img">
                    </button>
                    <button class="tv-directional-btn tv-directional-btn--ok" onclick="tvCommand(this, 'cursorCenter')" data-device-id="191" aria-label="OK">
                      <div class="tv-ok-circle"></div>
                    </button>
                    <button class="tv-directional-btn tv-directional-btn--right" onclick="tvCommand(this, 'cursorRight')" data-device-id="191" aria-label="Direita">
                      <img src="images/icons/arrow-right.svg" alt="Direita" class="tv-btn-icon-img">
                    </button>
                  </div>
                            
                  <!-- Linha 3: DOWN -->
                  <button class="tv-directional-btn tv-directional-btn--down" onclick="tvCommand(this, 'cursorDown')" data-device-id="191" aria-label="Baixo">
                    <img src="images/icons/arrow-down.svg" alt="Baixo" class="tv-btn-icon-img">
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- COLUNA 3 -->
        <div class="tv-controls-col tv-col-3">
          <!-- BLOCO 6: N√öMEROS -->
          <div class="tv-control-section">
            <header class="tv-section-header">
              <h3 class="tv-section-title">N√∫meros</h3>
              <div class="tv-section-line"></div>
            </header>
            <div class="tv-control-group">
              <div class="tv-numpad">
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num1')" data-device-id="191" aria-label="1">1</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num2')" data-device-id="191" aria-label="2">2</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num3')" data-device-id="191" aria-label="3">3</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num4')" data-device-id="191" aria-label="4">4</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num5')" data-device-id="191" aria-label="5">5</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num6')" data-device-id="191" aria-label="6">6</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num7')" data-device-id="191" aria-label="7">7</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num8')" data-device-id="191" aria-label="8">8</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num9')" data-device-id="191" aria-label="9">9</button>
                <button class="tv-numpad-btn tv-numpad-btn--icon" onclick="tvCommand(this, 'returnButton')" data-device-id="191" aria-label="Voltar">
                  <img src="images/icons/back-button.svg" alt="Back">
                </button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num0')" data-device-id="191" aria-label="0">0</button>
                <button class="tv-numpad-btn tv-numpad-btn--icon" onclick="tvCommand(this, 'mouse')" aria-label="Mouse">
                  <img src="images/icons/icon-mouse.svg" alt="Mouse">
                </button>
              </div>
            </div>
          </div>

          <!-- BLOCO 7: LOGO ELETRIZE -->
          <div class="tv-control-section tv-logo-section">
            <img src="images/icons/eletrize.svg" alt="Eletrize" class="tv-eletrize-logo">
          </div>
        </div>

      </div>

    </div>

        `,

        ambiente9: () => {
          const envName = getTranslatedEnvName('ambiente9', 'Cultura');
          return `
<div class="top-bar-custom"></div>

<div class="page active page-container ambiente9-page">

    <div class="page-header">

        <button class="back-btn" onclick="spaNavigate('home')"><img src="images/icons/back-button.svg" alt="Voltar"></button>

        <h1 class="page-title">${envName}</h1>

    </div>

    

    <div class="ambiente9-controls-wrapper ambiente-grid">
        ${generateFeatureButtons('ambiente9')}
    </div>

</div>
          `;
        },

        "ambiente9-luzes": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente9-page ambiente9-luzes-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente9')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Ilumina√ß√£o</h1>
    </div>

    <div class="ambiente9-luzes-wrapper ambiente-grid">
      <!-- Luzes geradas dinamicamente pelo config.js -->
    </div>

</div>

        `,

        "ambiente9-cortinas": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente9-page ambiente9-cortinas-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente9')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Cortinas</h1>
    </div>

    <div class="ambiente9-cortinas-wrapper">
        <!-- Veneziana -->
        <article class="curtain-tile curtain-tile--full-width curtain-tile--transparent" data-device-id="176" data-environment="Su√≠te Master">
            <header class="curtain-tile__header curtain-tile__header--minimal">
                <h3 class="curtain-tile__title">Veneziana</h3>
                <div class="curtain-tile__line"></div>
            </header>
            <div class="curtain-tile__actions">
                <button class="curtain-tile__btn" data-device-id="176" onclick="curtainAction(this, 'push1')" aria-label="Abrir Veneziana">
                    <img src="images/icons/arrow-up.svg" alt="Abrir">
                </button>
                <button class="curtain-tile__btn" data-device-id="176" onclick="curtainAction(this, 'push2')" aria-label="Parar Veneziana">
                    <img src="images/icons/icon-stop.svg" alt="Parar">
                </button>
                <button class="curtain-tile__btn" data-device-id="176" onclick="curtainAction(this, 'push3')" aria-label="Fechar Veneziana">
                    <img src="images/icons/arrow-down.svg" alt="Fechar">
                </button>
            </div>
        </article>
    </div>

</div>

        `,

        "ambiente9-conforto": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente9-page ambiente9-conforto-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente9')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
    </div>

    <div class="ac-page-wrapper">
        <main class="ac-container" data-component="ac-control">
            
            <!-- Display de Temperatura -->
            <section class="ac-temperature-section">
        <div class="ac-temperature-fade-content">
          <div class="ac-temperature-display">
            <div class="ac-temp-wrapper">
              <!-- SVG para o arco de progresso -->
              <svg class="ac-temp-arc" viewBox="0 0 200 120" preserveAspectRatio="xMidYMid meet">
                <!-- Arco de fundo -->
                <path class="ac-temp-arc-bg" d="M 20,100 A 80,80 0 0,1 180,100" fill="none" stroke-width="8"/>
                <!-- Arco de progresso -->
                <path class="ac-temp-arc-progress" d="M 20,100 A 80,80 0 0,1 180,100" fill="none" stroke-width="8" data-role="progress-ring"/>
              </svg>
              <!-- Display do valor em lista -->
              <div class="ac-temp-display">
                <div class="ac-temp-list">
                  <div class="ac-temp-prev" data-role="temp-prev">21</div>
                  <div class="ac-temp-current" data-role="temp-current">22</div>
                  <div class="ac-temp-next" data-role="temp-next">23</div>
                </div>
              </div>
              <!-- Knob arrast√°vel -->
              <div class="ac-temp-knob-wrapper" data-role="knob">
                <div class="ac-temp-knob">
                  <div class="ac-temp-knob-dot"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
            </section>

            <!-- Wrapper para os controles (Sele√ß√£o, Aletas, Comandos) -->
            <div class="ac-controls-wrapper">
                <!-- Controles de Sele√ß√£o -->
                <section class="ac-modes" role="group" aria-label="Sele√ß√£o de ar-condicionado">
                    <h2 class="ac-section-title">Sele√ß√£o</h2>
                    <div class="ac-modes-grid ac-modes-grid--single">
                        <button type="button" class="ac-mode-btn ac-mode-btn--selection" data-mode-button data-mode="suiteMaster" aria-pressed="true" aria-label="Su√≠te Master">
                            <span class="ac-mode-btn__label">Su√≠te Master</span>
                        </button>
                    </div>
                </section>

                <!-- Controles de Aletas -->
                <section class="ac-aleta-section" role="group" aria-label="Controle das aletas">
                    <h2 class="ac-section-title">Aletas</h2>
                    <div class="ac-aleta-grid">
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="moving" aria-pressed="true" aria-label="Aletas em movimento">
                <img src="images/icons/icon-ac-aleta-moving.svg" alt="">
              </button>
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="windfree" aria-pressed="false" aria-label="WindFree">
                <img src="images/icons/icon-windfree.svg" alt="">
              </button>
              <button type="button" class="ac-aleta-btn" data-aleta-button data-aleta="parada" aria-pressed="false" aria-label="Aletas paradas">
                <img src="images/icons/icon-ac-aleta-parada.svg" alt="">
              </button>
                    </div>
                </section>

                <!-- Comandos -->
                <section class="ac-commands-section">
                    <h3 class="ac-section-title">Comandos</h3>
                    <div class="ac-commands-grid">
                        <button type="button" class="ac-command-btn ac-command-btn-large" data-role="power" aria-pressed="true" aria-label="Ligar/Desligar ar-condicionado">
                            <img src="images/icons/icon-ac-power.svg" alt="">
                        </button>
                    </div>
                </section>
            </div>

            <span class="sr-only" role="status" aria-live="polite" data-role="temperature-live">Temperatura ajustada para 22 graus.</span>
        </main>
    </div>

</div>

        `,

        "ambiente9-tv": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente9-page ambiente9-tv-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente9')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Controle TV</h1>
    </div>

    <div class="tv-control-wrapper">
        
        <!-- COLUNA 1 -->
        <div class="tv-controls-col tv-col-1">
            <!-- BLOCO 1: ON/OFF -->
            <div class="tv-control-section">
                <header class="tv-section-header">
                    <h3 class="tv-section-title">On / Off</h3>
                    <div class="tv-section-line"></div>
                </header>
                <div class="tv-control-group tv-power-group">
          <button class="tv-btn tv-btn--power-on" onclick="suiteMasterTvOn()" aria-label="Ligar">
            ON
          </button>
          <button class="tv-btn tv-btn--power-off" onclick="suiteMasterTvOff()" aria-label="Desligar">
            OFF
          </button>
                </div>
            </div>

            <!-- BLOCO 4 E 5: VOLUME E CANAIS (lado a lado) -->
            <div class="tv-volume-canais-wrapper">
                
                <!-- BLOCO 4: VOLUME -->
                <div class="tv-control-section">
                    <header class="tv-section-header">
                        <h3 class="tv-section-title">Volume</h3>
                        <span class="tv-volume-value" id="tv-volume-display">50</span>
                        <div class="tv-section-line"></div>
                    </header>
                    <div class="tv-control-group tv-volume-slider-container">
                        <input 
                            type="range" 
                            class="tv-volume-slider" 
                            id="tv-volume-slider"
                            min="0" 
                            max="100" 
                            value="50"
                            data-device-id="183"
                            aria-label="Controle de Volume"
                        >
                    </div>
                </div>

                <!-- BLOCO 5: CANAIS -->
                <div class="tv-control-section">
                    <header class="tv-section-header">
                        <h3 class="tv-section-title">Canais</h3>
                        <div class="tv-section-line"></div>
                    </header>
                    <div class="tv-control-group tv-volume-channels-inline">
                        
                        <!-- Coluna Canais -->
                        <div class="tv-channels-column">
                            <div class="tv-channels-buttons">
                <button class="tv-btn-square" onclick="tvCommand(this, 'channelDown')" data-device-id="183" aria-label="Canal +">
                                    <img src="images/icons/arrow-up.svg" alt="Canal +" class="tv-btn-icon-img">
                                </button>
                <button class="tv-btn-square" onclick="tvCommand(this, 'channelUp')" data-device-id="183" aria-label="Canal -">
                                    <img src="images/icons/arrow-down.svg" alt="Canal -" class="tv-btn-icon-img">
                                </button>
                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>

        <!-- COLUNA 2 -->
        <div class="tv-controls-col tv-col-2">
            <!-- BLOCO 3: COMANDOS (Back, Menu, Home, Mute) -->
            <div class="tv-control-section">
                <header class="tv-section-header">
                    <h3 class="tv-section-title">Comandos</h3>
                    <div class="tv-section-line"></div>
                </header>
                <div class="tv-control-group tv-commands-grid">
                    <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'returnButton')" data-device-id="183" aria-label="Voltar">
                        <img src="images/icons/back-button.svg" alt="Voltar">
                    </button>
                    <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'hdmi2')" data-device-id="183" aria-label="Menu">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="3" y1="12" x2="21" y2="12"></line>
                            <line x1="3" y1="6" x2="21" y2="6"></line>
                            <line x1="3" y1="18" x2="21" y2="18"></line>
                        </svg>
                    </button>
                    <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'mute')" data-device-id="183" aria-label="Mudo">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                            <line x1="23" y1="9" x2="17" y2="15"></line>
                            <line x1="17" y1="9" x2="23" y2="15"></line>
                        </svg>
                    </button>
                    <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'home')" data-device-id="183" aria-label="Home">
                        <img src="images/icons/icon-home.svg" alt="Home">
                    </button>
                </div>
            </div>

            <!-- BLOCO 2: CONTROLE (D-PAD) -->
            <div class="tv-control-section">
                <header class="tv-section-header">
                    <h3 class="tv-section-title">Controle</h3>
                    <div class="tv-section-line"></div>
                </header>
                <div class="tv-control-group tv-directional-row">
                    <div class="tv-directional-section">
                        <div class="tv-directional-pad">
                            <!-- Linha 1: UP -->
                            <button class="tv-directional-btn tv-directional-btn--up" onclick="tvCommand(this, 'cursorUp')" data-device-id="183" aria-label="Cima">
                                <img src="images/icons/arrow-up.svg" alt="Cima" class="tv-btn-icon-img">
                            </button>
                            
                            <!-- Linha 2: LEFT, OK, RIGHT -->
                            <div class="tv-directional-row-line">
                                <button class="tv-directional-btn tv-directional-btn--left" onclick="tvCommand(this, 'cursorLeft')" data-device-id="183" aria-label="Esquerda">
                                    <img src="images/icons/arrow-left.svg" alt="Esquerda" class="tv-btn-icon-img">
                                </button>
                                <button class="tv-directional-btn tv-directional-btn--ok" onclick="tvCommand(this, 'cursorCenter')" data-device-id="183" aria-label="OK">
                                    <div class="tv-ok-circle"></div>
                                </button>
                                <button class="tv-directional-btn tv-directional-btn--right" onclick="tvCommand(this, 'cursorRight')" data-device-id="183" aria-label="Direita">
                                    <img src="images/icons/arrow-right.svg" alt="Direita" class="tv-btn-icon-img">
                                </button>
                            </div>
                            
                            <!-- Linha 3: DOWN -->
                            <button class="tv-directional-btn tv-directional-btn--down" onclick="tvCommand(this, 'cursorDown')" data-device-id="183" aria-label="Baixo">
                                <img src="images/icons/arrow-down.svg" alt="Baixo" class="tv-btn-icon-img">
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- COLUNA 3 -->
        <div class="tv-controls-col tv-col-3">
            <!-- BLOCO 6: N√öMEROS -->
            <div class="tv-control-section">
                <header class="tv-section-header">
                    <h3 class="tv-section-title">N√∫meros</h3>
                    <div class="tv-section-line"></div>
                </header>
                <div class="tv-control-group">
                    <div class="tv-numpad">
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num1')" data-device-id="183" aria-label="1">1</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num2')" data-device-id="183" aria-label="2">2</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num3')" data-device-id="183" aria-label="3">3</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num4')" data-device-id="183" aria-label="4">4</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num5')" data-device-id="183" aria-label="5">5</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num6')" data-device-id="183" aria-label="6">6</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num7')" data-device-id="183" aria-label="7">7</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num8')" data-device-id="183" aria-label="8">8</button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num9')" data-device-id="183" aria-label="9">9</button>
                        <button class="tv-numpad-btn tv-numpad-btn--icon" onclick="tvCommand(this, 'returnButton')" data-device-id="183" aria-label="Voltar">
                            <img src="images/icons/back-button.svg" alt="Back">
                        </button>
                        <button class="tv-numpad-btn" onclick="tvCommand(this, 'num0')" data-device-id="183" aria-label="0">0</button>
                        <button class="tv-numpad-btn tv-numpad-btn--icon" onclick="fireTVMacro()" aria-label="Fire TV">
                            <img src="images/icons/icon-firetv.svg" alt="Fire TV">
                        </button>
                    </div>
                </div>
            </div>

            <!-- BLOCO 7: LOGO ELETRIZE -->
            <div class="tv-control-section tv-logo-section">
                <img src="images/icons/eletrize.svg" alt="Eletrize" class="tv-eletrize-logo">
            </div>
        </div>

    </div>

</div>

        `,

        "ambiente9-htv": () => `

    <div class="top-bar-custom"></div>

    <div class="page active page-container ambiente9-page ambiente9-htv-page">

      <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente9')">
          <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Controle TV</h1>
      </div>

      <div class="tv-control-wrapper">
        
        <!-- COLUNA 1 -->
        <div class="tv-controls-col tv-col-1">
          <!-- BLOCO 1: ON/OFF -->
          <div class="tv-control-section">
            <header class="tv-section-header">
              <h3 class="tv-section-title">On / Off</h3>
              <div class="tv-section-line"></div>
            </header>
            <div class="tv-control-group tv-power-group">
              <button class="tv-btn tv-btn--power-on" onclick="suiteMasterHtvOn()" aria-label="Ligar">
                ON
              </button>
              <button class="tv-btn tv-btn--power-off" onclick="suiteMasterHtvOff()" aria-label="Desligar">
                OFF
              </button>
            </div>
          </div>

          <!-- BLOCO 4 E 5: VOLUME E CANAIS (lado a lado) -->
          <div class="tv-volume-canais-wrapper">
                
            <!-- BLOCO 4: VOLUME -->
            <div class="tv-control-section">
              <header class="tv-section-header">
                <h3 class="tv-section-title">Volume</h3>
                <span class="tv-volume-value" id="tv-volume-display">50</span>
                <div class="tv-section-line"></div>
              </header>
              <div class="tv-control-group tv-volume-slider-container">
                <input 
                  type="range" 
                  class="tv-volume-slider" 
                  id="tv-volume-slider"
                  min="0" 
                  max="100" 
                  value="50"
                  data-device-id="189"
                  aria-label="Controle de Volume"
                >
              </div>
            </div>

            <!-- BLOCO 5: CANAIS -->
            <div class="tv-control-section">
              <header class="tv-section-header">
                <h3 class="tv-section-title">Canais</h3>
                <div class="tv-section-line"></div>
              </header>
              <div class="tv-control-group tv-volume-channels-inline">
                        
                <!-- Coluna Canais -->
                <div class="tv-channels-column">
                  <div class="tv-channels-buttons">
            <button class="tv-btn-square" onclick="tvCommand(this, 'channelDown')" data-device-id="189" aria-label="Canal +">
                      <img src="images/icons/arrow-up.svg" alt="Canal +" class="tv-btn-icon-img">
                    </button>
            <button class="tv-btn-square" onclick="tvCommand(this, 'channelUp')" data-device-id="189" aria-label="Canal -">
                      <img src="images/icons/arrow-down.svg" alt="Canal -" class="tv-btn-icon-img">
                    </button>
                  </div>
                </div>

              </div>
            </div>

          </div>
        </div>

        <!-- COLUNA 2 -->
        <div class="tv-controls-col tv-col-2">
          <!-- BLOCO 3: COMANDOS (Back, Menu, Home, Mute) -->
          <div class="tv-control-section">
            <header class="tv-section-header">
              <h3 class="tv-section-title">Comandos</h3>
              <div class="tv-section-line"></div>
            </header>
            <div class="tv-control-group tv-commands-grid">
              <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'returnButton')" data-device-id="189" aria-label="Voltar">
                <img src="images/icons/back-button.svg" alt="Voltar">
              </button>
              <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'menu')" data-device-id="189" aria-label="Menu">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <line x1="3" y1="12" x2="21" y2="12"></line>
                  <line x1="3" y1="6" x2="21" y2="6"></line>
                  <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
              </button>
              <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'volMute')" data-device-id="189" aria-label="Mudo">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                  <line x1="23" y1="9" x2="17" y2="15"></line>
                  <line x1="17" y1="9" x2="23" y2="15"></line>
                </svg>
              </button>
              <button class="tv-btn tv-btn--icon-only" onclick="tvCommand(this, 'home')" data-device-id="189" aria-label="Home">
                <img src="images/icons/icon-home.svg" alt="Home">
              </button>
            </div>
          </div>

          <!-- BLOCO 2: CONTROLE (D-PAD) -->
          <div class="tv-control-section">
            <header class="tv-section-header">
              <h3 class="tv-section-title">Controle</h3>
              <div class="tv-section-line"></div>
            </header>
            <div class="tv-control-group tv-directional-row">
              <div class="tv-directional-section">
                <div class="tv-directional-pad">
                  <!-- Linha 1: UP -->
                  <button class="tv-directional-btn tv-directional-btn--up" onclick="tvCommand(this, 'cursorUp')" data-device-id="189" aria-label="Cima">
                    <img src="images/icons/arrow-up.svg" alt="Cima" class="tv-btn-icon-img">
                  </button>
                            
                  <!-- Linha 2: LEFT, OK, RIGHT -->
                  <div class="tv-directional-row-line">
                    <button class="tv-directional-btn tv-directional-btn--left" onclick="tvCommand(this, 'cursorLeft')" data-device-id="189" aria-label="Esquerda">
                      <img src="images/icons/arrow-left.svg" alt="Esquerda" class="tv-btn-icon-img">
                    </button>
                    <button class="tv-directional-btn tv-directional-btn--ok" onclick="tvCommand(this, 'cursorCenter')" data-device-id="189" aria-label="OK">
                      <div class="tv-ok-circle"></div>
                    </button>
                    <button class="tv-directional-btn tv-directional-btn--right" onclick="tvCommand(this, 'cursorRight')" data-device-id="189" aria-label="Direita">
                      <img src="images/icons/arrow-right.svg" alt="Direita" class="tv-btn-icon-img">
                    </button>
                  </div>
                            
                  <!-- Linha 3: DOWN -->
                  <button class="tv-directional-btn tv-directional-btn--down" onclick="tvCommand(this, 'cursorDown')" data-device-id="189" aria-label="Baixo">
                    <img src="images/icons/arrow-down.svg" alt="Baixo" class="tv-btn-icon-img">
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- COLUNA 3 -->
        <div class="tv-controls-col tv-col-3">
          <!-- BLOCO 6: N√öMEROS -->
          <div class="tv-control-section">
            <header class="tv-section-header">
              <h3 class="tv-section-title">N√∫meros</h3>
              <div class="tv-section-line"></div>
            </header>
            <div class="tv-control-group">
              <div class="tv-numpad">
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num1')" data-device-id="189" aria-label="1">1</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num2')" data-device-id="189" aria-label="2">2</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num3')" data-device-id="189" aria-label="3">3</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num4')" data-device-id="189" aria-label="4">4</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num5')" data-device-id="189" aria-label="5">5</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num6')" data-device-id="189" aria-label="6">6</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num7')" data-device-id="189" aria-label="7">7</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num8')" data-device-id="189" aria-label="8">8</button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num9')" data-device-id="189" aria-label="9">9</button>
                <button class="tv-numpad-btn tv-numpad-btn--icon" onclick="tvCommand(this, 'returnButton')" data-device-id="189" aria-label="Voltar">
                  <img src="images/icons/back-button.svg" alt="Back">
                </button>
                <button class="tv-numpad-btn" onclick="tvCommand(this, 'num0')" data-device-id="189" aria-label="0">0</button>
                <button class="tv-numpad-btn tv-numpad-btn--icon" onclick="tvCommand(this, 'mouse')" aria-label="Mouse">
                  <img src="images/icons/icon-mouse.svg" alt="Mouse">
                </button>
              </div>
            </div>
          </div>

          <!-- BLOCO 7: LOGO ELETRIZE -->
          <div class="tv-control-section tv-logo-section">
            <img src="images/icons/eletrize.svg" alt="Eletrize" class="tv-eletrize-logo">
          </div>
        </div>

      </div>

    </div>

        `,

        ambiente10: () => {
          const envName = getTranslatedEnvName('ambiente10', 'Descanso');
          return `
<div class="top-bar-custom"></div>

<div class="page active page-container ambiente10-page">

    <div class="page-header">

        <button class="back-btn" onclick="spaNavigate('home')"><img src="images/icons/back-button.svg" alt="Voltar"></button>

        <h1 class="page-title">${envName}</h1>

    </div>

    

    <div class="ambiente10-controls-wrapper ambiente-grid">
        ${generateFeatureButtons('ambiente10')}
    </div>

</div>
          `;
        },

        "ambiente10-luzes": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente10-page ambiente10-luzes-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente10')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Ilumina√ß√£o</h1>
    </div>

    <div class="ambiente10-luzes-wrapper ambiente-grid">
      <!-- Luzes geradas dinamicamente pelo config.js -->
    </div>

</div>

        `,

        ambiente11: () => {
          const envName = getTranslatedEnvName('ambiente11', 'Banheiros');
          return `
<div class="top-bar-custom"></div>

<div class="page active page-container ambiente11-page">

    <div class="page-header">

        <button class="back-btn" onclick="spaNavigate('home')"><img src="images/icons/back-button.svg" alt="Voltar"></button>

        <h1 class="page-title">${envName}</h1>

    </div>

    

    <div class="ambiente11-controls-wrapper ambiente-grid">
        ${generateFeatureButtons('ambiente11')}
    </div>

</div>
          `;
        },

        "ambiente11-luzes": () => `

<div class="top-bar-custom"></div>

<div class="page active page-container ambiente11-page ambiente11-luzes-page">

    <div class="page-header">
        <button class="back-btn" onclick="spaNavigate('ambiente11')">
            <img src="images/icons/back-button.svg" alt="Voltar">
        </button>
        <h1 class="page-title">Ilumina√ß√£o</h1>
    </div>

    <div class="ambiente11-luzes-wrapper ambiente-grid">
      <!-- Luzes geradas dinamicamente pelo config.js -->
    </div>

</div>

        `,
      };

      function spaNavigate(page) {
        window.location.hash = page;
      }

      // ENVIRONMENT_LABELS - usa config.js se dispon√≠vel, sen√£o fallback
      const ENVIRONMENT_LABELS = (typeof getEnvironmentLabels === 'function') 
        ? getEnvironmentLabels() 
        : {
            ambiente1: "Pr\u00f3logo",
            ambiente2: "Circula\u00e7\u00e3o",
            ambiente3: "Imers\u00e3o",
            ambiente4: "Pesquisa",
            ambiente5: "Brasil",
            ambiente6: "Maquete",
            ambiente7: "Holograma",
            ambiente8: "Processos",
            ambiente9: "Cultura",
            ambiente10: "Descanso",
            ambiente11: "Banheiros",
          };

      const PAGE_SUFFIX_LABELS = {
        "": "Painel",
        luzes: "Ilumina\u00e7\u00e3o",
        cortinas: "Cortinas",
        conforto: "Conforto",
        musica: "M\u00fasica",
        tv: "Controle TV",
        piscina: "Piscina",
        midia: "M\u00eddia",
        "piscina-luzes": "Ilumina\u00e7\u00e3o",
      };

      (function registerMediaRoutes() {
        if (typeof CLIENT_CONFIG === 'undefined' || !CLIENT_CONFIG.environments) return;
        Object.keys(CLIENT_CONFIG.environments).forEach((envKey) => {
          pages[`${envKey}-midia`] = () => generateMediaSelectionPage(envKey);
        });
      })();

      function formatEnvironmentPageTitle(route) {
        if (!route || !route.startsWith("ambiente")) return null;
        const parts = route.split("-");
        const envKey = parts[0];
        const envLabel = ENVIRONMENT_LABELS[envKey];
        if (!envLabel) return null;
        // Apenas o nome do ambiente, j√° sujeito a tradu√ß√£o
        return typeof translateText === 'function' ? translateText(envLabel) : envLabel;
      }

      function renderSpa() {
        let page = window.location.hash.replace("#", "") || "home";

        if (!pages[page]) page = "home";

        const previousPage = spaRoot.dataset.currentPage;
        if (previousPage) {
          const fragment = document.createDocumentFragment();
          while (spaRoot.firstChild) {
            fragment.appendChild(spaRoot.firstChild);
          }
          pageCache.set(previousPage, fragment);
        } else {
          while (spaRoot.firstChild) {
            spaRoot.removeChild(spaRoot.firstChild);
          }
        }

        let fragmentToRender;
        let reused = false;

        if (pageCache.has(page)) {
          fragmentToRender = pageCache.get(page);
          pageCache.delete(page);
          reused = true;
        } else {
          const template = document.createElement("template");
          template.innerHTML = pages[page]();
          fragmentToRender = template.content;
        }

        while (spaRoot.firstChild) {
          spaRoot.removeChild(spaRoot.firstChild);
        }
        spaRoot.appendChild(fragmentToRender);
        spaRoot.dataset.currentPage = page;

        const skipSceneFade =
          previousPage &&
          ((previousPage === "home" && page === "scenes") ||
            (previousPage === "scenes" && page === "home"));

        runPageEnterAnimation({ skip: skipSceneFade });

        const formattedTitle = formatEnvironmentPageTitle(page);
        if (formattedTitle) {
          const activePage = document.querySelector(".page.active");
          if (activePage) {
            let titleEl = activePage.querySelector(".page-title");
            if (!titleEl) {
              const headerEl = activePage.querySelector(".page-header");
              if (headerEl) {
                titleEl = document.createElement("h1");
                titleEl.className = "page-title";
                headerEl.appendChild(titleEl);
              }
            }
            if (titleEl) {
              titleEl.textContent = formattedTitle;
            }
          }
        }

        setupAppInfoMenu();

        // Inicializar slider de volume se estiver na p√°gina de TV
        if (page === "ambiente1-tv") {
          setTimeout(() => {
            if (typeof initVolumeSlider === "function") {
              initVolumeSlider();
            }
          }, 100);
        }

        // Constr√≥i a lista de c√¥modos na Home (usando config.js quando dispon√≠vel)

        if (page === "home") {
          const list = document.querySelector(".rooms-list");

          if (list && !reused) {
            // Usar config.js se dispon√≠vel, sen√£o fallback para dados hardcoded
            let rooms, roomDevices;
            
            if (typeof getVisibleEnvironments === 'function' && typeof CLIENT_CONFIG !== 'undefined') {
              // Usando configura√ß√£o din√¢mica
              const visibleEnvs = getVisibleEnvironments();
              rooms = visibleEnvs.map(env => ({ name: env.name, route: env.key }));
              roomDevices = {};
              visibleEnvs.forEach(env => {
                roomDevices[env.key] = env.lights ? env.lights.map(l => l.id) : [];
              });
            } else {
              // Fallback para dados hardcoded
              rooms = [
                { name: "Pr√≥logo", route: "ambiente1" },
                { name: "Circula√ß√£o", route: "ambiente2" },
                { name: "Imers√£o", route: "ambiente3" },
                { name: "Pesquisa", route: "ambiente4" },
                { name: "Brasil", route: "ambiente5" },
                { name: "Maquete", route: "ambiente6" },
                { name: "Holograma", route: "ambiente7" },
                { name: "Processos", route: "ambiente8" },
                { name: "Cultura", route: "ambiente9" },
                { name: "Descanso", route: "ambiente10" },
                { name: "Banheiros", route: "ambiente11" },
              ];
              roomDevices = {
                ambiente1: ["52", "58", "67"],
                ambiente2: ["52", "62", "55", "54"],
                ambiente3: [],
                ambiente4: ["60"],
                ambiente5: ["64", "61"],
                ambiente6: ["40", "44"],
                ambiente7: [],
                ambiente8: ["40", "44"],
                ambiente9: ["45", "43", "57", "63", "59"],
                ambiente10: ["42", "41", "65", "66"],
                ambiente11: ["49", "47", "48", "46", "50"],
              };
            }

            const visible = rooms;
            const firstVisibleRoute = visible[0]?.route || null;

            list.innerHTML = visible
              .map((r) => {
                // Verifica se tem foto: primeiro olha no config.js, depois no ROOM_IMAGE_DATA
                let hasPhoto = false;
                if (typeof CLIENT_CONFIG !== 'undefined' && CLIENT_CONFIG.environments && CLIENT_CONFIG.environments[r.route]) {
                  hasPhoto = CLIENT_CONFIG.environments[r.route].hasPhoto === true;
                } else {
                  hasPhoto = Boolean(ROOM_IMAGE_DATA[r.route]);
                }
                const ids = roomDevices[r.route] || [];
                // Traduz o nome do ambiente
                const translatedName = typeof translateText === 'function' ? translateText(r.name) : r.name;
                return `

                    <div class="room-card ${hasPhoto ? "has-photo" : ""}">

                        ${
                          hasPhoto
                            ? renderRoomResponsivePhoto(r.route, translatedName, {
                                eager: r.route === firstVisibleRoute,
                              })
                            : ""
                        }

                        <span>${translatedName}</span>
                        <button class="room-card-link" onclick="spaNavigate('${
                          r.route
                        }')"></button>

                    </div>`;
              })
              .join("");

            list.dataset.rendered = "true";
          }

          if (typeof initHomeMasters === "function") initHomeMasters();
        }

        // Define o fundo da p√°gina interna com a mesma foto do card

        (function setPageBackground(route) {
          // Extrai o ambiente base (ex: "ambiente1" de "ambiente1-luzes")
          const baseAmbiente = route.match(/^(ambiente\d+)/)?.[1] || route;
          const container =
            document.querySelector(".page.active .page-container") ||
            document.querySelector(".page.active.page-container");

          if (container) {
            applyBackground(container, baseAmbiente);
          }

          preloadRoomBackground(baseAmbiente);
        })(page);

        // Atualiza navbar (ativo + indicador)

        const nav = document.getElementById("spa-navbar");

        const items = nav.querySelectorAll(".nav-item");

        const navPages = Array.from(items).map((i) =>
          i.getAttribute("data-page")
        );

        const navPage = navPages.includes(page) ? page : "home";

        let activeIndex = navPages.indexOf(navPage);

        if (activeIndex < 0) activeIndex = navPages.indexOf("home");

        items.forEach((item, idx) =>
          item.classList.toggle("active", idx === activeIndex)
        );

        const activeItem = items[activeIndex];

        if (activeItem) {
          // Usar setTimeout para garantir que o layout seja calculado ap√≥s mudan√ßas de DOM

          setTimeout(() => {
            const navRect = nav.getBoundingClientRect();

            const itemRect = activeItem.getBoundingClientRect();

            const center = itemRect.left + itemRect.width / 2 - navRect.left;

            nav.style.setProperty("--indicator-left", `${center}px`);
          }, 10);
        }

        // Inicializa bot√µes dos c√¥modos nas p√°ginas internas

        if (
          [
            "ambiente1",
            "ambiente2",
            "ambiente3",
            "ambiente4",
            "ambiente5",
            "ambiente6",
            "ambiente7",
            "ambiente8",
            "ambiente9",
          ].includes(page)
        ) {
          if (typeof initRoomPage === "function") initRoomPage();
        }

        // Atualiza o bot√£o master na p√°gina de cen√°rios

        if (page === "scenes") {
          ensureScenesScript()
            .then(() => {
              if (typeof initScenesPage === "function") {
                initScenesPage();
              }
            })
            .catch((error) =>
              console.error("Erro ao carregar scenes.js", error)
            );
        }

        // Inicializa controlador de ar condicionado em todas as p√°ginas de conforto
        const confortoPages = [
          "ambiente1-conforto",
          "ambiente2-conforto",
          "ambiente3-conforto",
          "ambiente4-conforto",
          "ambiente5-conforto",
          "ambiente6-conforto",
          "ambiente7-conforto",
          "ambiente8-conforto",
          "ambiente9-conforto",
        ];

        if (confortoPages.includes(page)) {
          setTimeout(() => {
            if (typeof initAirConditionerControl === "function") {
              initAirConditionerControl();
            }
          }, 100);
        }

        // Inicializa player de m√∫sica em p√°ginas de m√∫sica (qualquer ambiente)
        if (page.endsWith('-musica')) {
          setTimeout(() => {
            if (typeof initMusicPlayerUI === "function") {
              initMusicPlayerUI();
            }
          }, 100);
        }

        // Aplica nomes das luzes do config.js
        const luzesPages = [
          "ambiente1-luzes", "ambiente2-luzes", "ambiente3-luzes",
          "ambiente4-luzes", "ambiente5-luzes", "ambiente6-luzes",
          "ambiente7-luzes", "ambiente8-luzes", "ambiente9-luzes",
          "ambiente10-luzes", "ambiente11-luzes"
        ];
        if (luzesPages.includes(page)) {
          setTimeout(() => {
            applyConfigLightNames(page);
          }, 50);
        }
      }

      // Fun√ß√£o para aplicar luzes do config.js (regenera completamente)
      function applyConfigLightNames(page) {
        if (typeof CLIENT_CONFIG === 'undefined') return;

        const envKey = page.split('-')[0];
        const wrapper = document.querySelector(`.${envKey}-luzes-wrapper`);
        if (!wrapper) return;

        const envConfig = CLIENT_CONFIG.environments && CLIENT_CONFIG.environments[envKey];
        const applyReadyState = () => {
          const commit = () => {
            wrapper.classList.add('lights-ready');
            wrapper.classList.remove('lights-loading');
          };
          if (typeof requestAnimationFrame === 'function') {
            requestAnimationFrame(commit);
          } else {
            setTimeout(commit, 0);
          }
        };

        wrapper.classList.remove('lights-ready');
        wrapper.classList.add('lights-loading');

        if (!envConfig || !envConfig.lights || envConfig.lights.length === 0) {
          wrapper.innerHTML = '<div style="text-align:center;color:#fff;padding:40px;">Nenhuma luz configurada</div>';
          applyReadyState();
          return;
        }

        wrapper.innerHTML = '';

        envConfig.lights.forEach((light, index) => {
          const isLast = index === envConfig.lights.length - 1;
          const isOdd = envConfig.lights.length % 2 !== 0;
          const isFullWidth = isLast && isOdd;

          const card = document.createElement('div');
          card.className = 'control-card' + (isFullWidth ? ' control-card--full-width' : '');
          card.setAttribute('data-state', 'off');
          card.setAttribute('data-device-id', light.id);
          card.setAttribute('onclick', 'toggleRoomControl(this)');

          // Traduz o nome da luz
          const lightName = typeof translateText === 'function' ? translateText(light.name) : light.name;
          card.innerHTML = `
            <img class="control-icon" src="images/icons/icon-small-light-off.svg" alt="${lightName}">
            <div class="control-label">${lightName}</div>
          `;

          wrapper.appendChild(card);
        });

        if (typeof syncLightStates === 'function') {
          syncLightStates();
        }

        applyReadyState();

        console.log(`‚úÖ Luzes regeneradas para ${envKey}:`, envConfig.lights.length, 'luzes');
        try {
          setTimeout(() => {
            document.documentElement.classList.add('js-ready');
            console.log('js-ready reaplicado ap√≥s applyConfigLightNames');
          }, 20);
        } catch (e) {
          console.warn('N√£o foi poss√≠vel aplicar js-ready em applyConfigLightNames:', e);
        }
      }

      // Home: Master On/Off por ambiente (fun√ß√µes movidas para script.js)

      window.onHomeMasterClick = function (ev, btn) {
        ev.stopPropagation();

        ev.preventDefault();

        // Verificar se j√° tem comando pendente

        if (btn.dataset.pending === "true") {
          console.log("üö´ Comando master j√° em andamento");

          return;
        }

        const ids = (btn.dataset.deviceIds || "").split(",").filter(Boolean);

        if (!ids.length) return;

        const shouldTurnOn = !anyOn(ids);

        const cmd = shouldTurnOn ? "on" : "off";

        console.log(`üè† Master ${cmd} para ${ids.length} dispositivos:`, ids);

        // Marcar bot√£o como pendente

        btn.dataset.pending = "true";

        // Atualizar visual imediatamente (for√ßar update)

        const img = btn.querySelector("img");

        if (img) {
          img.src = shouldTurnOn
            ? "images/icons/icon-small-light-on.svg"
            : "images/icons/icon-small-light-off.svg";

          btn.dataset.state = cmd;
        }

        // Proteger todos os dispositivos individuais para evitar conflitos

        ids.forEach((deviceId) => {
          if (typeof protectDevice === "function") {
            protectDevice(deviceId, 10000); // 10s de prote√ß√£o para master commands
          }
        });

        // Atualizar estados salvos imediatamente

        ids.forEach((id) => {
          setStoredState(id, cmd);
        });

        // Atualizar UI imediatamente

        if (typeof updateStatesAfterMasterCommand === "function") {
          updateStatesAfterMasterCommand(ids, cmd);
        }

        // Enviar comandos para todos os dispositivos

        const promises = ids.map((id) => sendHubitatCommand(id, cmd));

        Promise.allSettled(promises)
          .then((results) => {
            const successes = results.filter(
              (r) => r.status === "fulfilled"
            ).length;

            const failures = results.filter(
              (r) => r.status === "rejected"
            ).length;

            console.log(
              `‚úÖ Master ${cmd}: ${successes} sucessos, ${failures} falhas`
            );

            // Segunda sincroniza√ß√£o ap√≥s comandos completos

            setTimeout(() => {
              if (typeof updateStatesAfterMasterCommand === "function") {
                updateStatesAfterMasterCommand(ids, cmd);
              }
            }, 300);

            // Remover prote√ß√£o ap√≥s delay

            setTimeout(() => {
              btn.dataset.pending = "false";

              console.log(`üîì Master button liberado`);
            }, 3000);
          })
          .catch((error) => {
            console.error("‚ùå Erro no comando master:", error);

            btn.dataset.pending = "false";
          });
      };

      // Fun√ß√£o para recalcular posi√ß√£o do page selector

      function updatePageSelectorPosition() {
        const nav = document.getElementById("spa-navbar");

        const activeItem = nav?.querySelector(".nav-item.active");

        if (activeItem && nav) {
          const navRect = nav.getBoundingClientRect();

          const itemRect = activeItem.getBoundingClientRect();

          const center = itemRect.left + itemRect.width / 2 - navRect.left;

          nav.style.setProperty("--indicator-left", `${center}px`);

          console.log("üìç Page selector reposicionado:", center + "px");
        }
      }

      window.addEventListener("hashchange", renderSpa);

      window.addEventListener("DOMContentLoaded", () => {
        initializeAppInfoMenu();

        renderSpa();

        // Navbar SPA - listeners ap√≥s DOM pronto

        document.querySelectorAll(".nav-item").forEach((item) => {
          item.addEventListener("click", function (e) {
            const page = item.getAttribute("data-page");

            if (page) {
              e.preventDefault();

              spaNavigate(page);
            }
          });
        });
      });

      // Listeners para recalcular page selector ao rotacionar/redimensionar

      window.addEventListener("resize", () => {
        // Debounce para evitar m√∫ltiplas chamadas

        clearTimeout(window.resizeTimeout);

        window.resizeTimeout = setTimeout(updatePageSelectorPosition, 100);
      });

      window.addEventListener("orientationchange", () => {
        // Aguardar um pouco ap√≥s mudan√ßa de orienta√ß√£o para garantir layout correto

        setTimeout(updatePageSelectorPosition, 300);
      });
    </script>
  </body>
</html>
